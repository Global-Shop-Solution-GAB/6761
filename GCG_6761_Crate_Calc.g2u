Program.Sub.ScreenSU.Start
Gui.FormRegCrate..Create(DashForm)
Gui.FormRegCrate..Caption("REGULAR CRATES  |  CUSTOMER: INVOTEC")
Gui.FormRegCrate..Size(1024,720)
Gui.FormRegCrate..MinX(0)
Gui.FormRegCrate..MinY(0)
Gui.FormRegCrate..Position(0,0)
Gui.FormRegCrate..AlwaysOnTop(False)
Gui.FormRegCrate..FontName("Tahoma")
Gui.FormRegCrate..FontSize(8.25)
Gui.FormRegCrate..ControlBox(True)
Gui.FormRegCrate..MaxButton(True)
Gui.FormRegCrate..MinButton(True)
Gui.FormRegCrate..MousePointer(0)
Gui.FormRegCrate..Moveable(True)
Gui.FormRegCrate..Sizeable(True)
Gui.FormRegCrate..ShowInTaskBar(True)
Gui.FormRegCrate..TitleBar(True)
Gui.FormRegCrate..BarSaveButton(True,False)
Gui.FormRegCrate..Event(UnLoad,FormRegCrate_UnLoad)
Gui.FormRegCrate..Event(SaveButtonClick,FormRegCrate_SaveButtonClick)
Gui.FormRegCrate.frame1.Create(Frame)
Gui.FormRegCrate.frame1.Enabled(True)
Gui.FormRegCrate.frame1.Visible(True)
Gui.FormRegCrate.frame1.Zorder(0)
Gui.FormRegCrate.frame1.Size(1023,529)
Gui.FormRegCrate.frame1.Position(0,125)
Gui.FormRegCrate.frame1.Caption("Router Sequences")
Gui.FormRegCrate.frame1.FontName("Tahoma")
Gui.FormRegCrate.frame1.FontSize(8.25)
Gui.FormRegCrate.frame1.BorderStyle(1)
Gui.FormRegCrate.frame1.Anchor(15)
Gui.FormRegCrate.GsGridRouter.Create(GsGridControl)
Gui.FormRegCrate.GsGridRouter.Enabled(True)
Gui.FormRegCrate.GsGridRouter.Visible(True)
Gui.FormRegCrate.GsGridRouter.Zorder(0)
Gui.FormRegCrate.GsGridRouter.Size(1023,503)
Gui.FormRegCrate.GsGridRouter.Position(0,26)
Gui.FormRegCrate.GsGridRouter.Parent("frame1")
Gui.FormRegCrate.GsGridRouter.Dock(5)
Gui.FormRegCrate.GsGridRouter.Anchor(15)
Gui.FormRegCrate.frame2.Create(Frame)
Gui.FormRegCrate.frame2.Enabled(True)
Gui.FormRegCrate.frame2.Visible(True)
Gui.FormRegCrate.frame2.Zorder(0)
Gui.FormRegCrate.frame2.Size(1023,121)
Gui.FormRegCrate.frame2.Position(0,0)
Gui.FormRegCrate.frame2.Caption("Data Entry")
Gui.FormRegCrate.frame2.FontName("Tahoma")
Gui.FormRegCrate.frame2.FontSize(8.25)
Gui.FormRegCrate.frame2.BorderStyle(1)
Gui.FormRegCrate.frame2.Anchor(13)
Gui.FormRegCrate.txtBaseQty.Create(TextBox,"",True,64,20,0,797,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtBaseQty.NumericOnly(1)
Gui.FormRegCrate.txtBaseQty.Parent("frame2")
Gui.FormRegCrate.lblSide2.Create(Label,"Side 2 Orientation",True,86,13,0,601,86,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblSide2.BorderStyle(0)
Gui.FormRegCrate.lblSide2.Parent("frame2")
Gui.FormRegCrate.ddlSide2.Create(DropDownList)
Gui.FormRegCrate.ddlSide2.Enabled(True)
Gui.FormRegCrate.ddlSide2.Visible(True)
Gui.FormRegCrate.ddlSide2.Zorder(0)
Gui.FormRegCrate.ddlSide2.Size(133,20)
Gui.FormRegCrate.ddlSide2.Position(601,99)
Gui.FormRegCrate.ddlSide2.FontName("Tahoma")
Gui.FormRegCrate.ddlSide2.FontSize(8.25)
Gui.FormRegCrate.ddlSide2.Parent("frame2")
Gui.FormRegCrate.cmdCalc.Create(Button)
Gui.FormRegCrate.cmdCalc.Enabled(True)
Gui.FormRegCrate.cmdCalc.Visible(True)
Gui.FormRegCrate.cmdCalc.Zorder(0)
Gui.FormRegCrate.cmdCalc.Size(39,33)
Gui.FormRegCrate.cmdCalc.Position(979,37)
Gui.FormRegCrate.cmdCalc.Caption("")
Gui.FormRegCrate.cmdCalc.FontName("Tahoma")
Gui.FormRegCrate.cmdCalc.FontSize(8.25)
Gui.FormRegCrate.cmdCalc.SvgPicture("icon_go_color")
Gui.FormRegCrate.cmdCalc.ToolTip("Calculate Materials")
Gui.FormRegCrate.cmdCalc.ImageAlign(8)
Gui.FormRegCrate.cmdCalc.Parent("frame2")
Gui.FormRegCrate.cmdCalc.Event(Click,cmdCalc_Click)
Gui.FormRegCrate.txtRtrTime.Create(TextBox,"",True,51,20,0,95,44,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtRtrTime.NumericOnly(2)
Gui.FormRegCrate.txtRtrTime.Parent("frame2")
Gui.FormRegCrate.cmdTemplate.Create(Button)
Gui.FormRegCrate.cmdTemplate.Enabled(True)
Gui.FormRegCrate.cmdTemplate.Visible(True)
Gui.FormRegCrate.cmdTemplate.Zorder(0)
Gui.FormRegCrate.cmdTemplate.Size(35,23)
Gui.FormRegCrate.cmdTemplate.Position(150,63)
Gui.FormRegCrate.cmdTemplate.Caption("")
Gui.FormRegCrate.cmdTemplate.FontName("Tahoma")
Gui.FormRegCrate.cmdTemplate.FontSize(8.25)
Gui.FormRegCrate.cmdTemplate.SvgPicture("icon_browser_color")
Gui.FormRegCrate.cmdTemplate.ImageAlign(8)
Gui.FormRegCrate.cmdTemplate.Parent("frame2")
Gui.FormRegCrate.cmdTemplate.Event(Click,cmdTemplate_Click)
Gui.FormRegCrate.txtBaseRQty.Create(TextBox,"",True,64,20,0,887,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtBaseRQty.NumericOnly(1)
Gui.FormRegCrate.txtBaseRQty.Parent("frame2")
Gui.FormRegCrate.lblExtraDesc.Create(Label,"Extra Description",True,82,13,0,16,86,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblExtraDesc.BorderStyle(0)
Gui.FormRegCrate.lblExtraDesc.Parent("frame2")
Gui.FormRegCrate.lbl6.Create(Label,"X",True,6,13,0,530,58,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lbl6.BorderStyle(0)
Gui.FormRegCrate.lbl6.Parent("frame2")
Gui.FormRegCrate.txtExtraDesc.Create(TextBox,"",True,423,20,0,14,100,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtExtraDesc.Parent("frame2")
Gui.FormRegCrate.txtExtraDesc.Event(GotFocus,txtExtraDesc_GotFocus)
Gui.FormRegCrate.txtExtraDesc.Mask(">")
Gui.FormRegCrate.lbl7.Create(Label,"X",True,6,13,0,622,58,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lbl7.BorderStyle(0)
Gui.FormRegCrate.lbl7.Parent("frame2")
Gui.FormRegCrate.lblBaseR.Create(Label,"Base Runner Qty",True,82,13,0,887,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblBaseR.BorderStyle(0)
Gui.FormRegCrate.lblBaseR.Parent("frame2")
Gui.FormRegCrate.lblSide1.Create(Label,"Side 1 Orientation",True,86,13,0,450,86,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblSide1.BorderStyle(0)
Gui.FormRegCrate.lblSide1.Parent("frame2")
Gui.FormRegCrate.lblRtrTime.Create(Label,"Time in Mins per Crate",True,106,13,0,80,28,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblRtrTime.BorderStyle(0)
Gui.FormRegCrate.lblRtrTime.Parent("frame2")
Gui.FormRegCrate.lblTemplate.Create(Label,"Template",True,44,13,0,14,50,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblTemplate.BorderStyle(0)
Gui.FormRegCrate.lblTemplate.Parent("frame2")
Gui.FormRegCrate.lblTop.Create(Label,"Top Orientation",True,75,13,0,752,86,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblTop.BorderStyle(0)
Gui.FormRegCrate.lblTop.Parent("frame2")
Gui.FormRegCrate.lblLen.Create(Label,"Length",True,33,13,0,454,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblLen.BorderStyle(0)
Gui.FormRegCrate.lblLen.Parent("frame2")
Gui.FormRegCrate.txtDesc.Create(TextBox,"",True,236,20,0,201,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtDesc.Parent("frame2")
Gui.FormRegCrate.txtDesc.Mask(">")
Gui.FormRegCrate.txtDesc.Event(GotFocus,txtDesc_GotFocus)
Gui.FormRegCrate.txtDesc.MaxLength(30)
Gui.FormRegCrate.lblTempDesc.Create(Label,"Description",True,53,13,0,201,39,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblTempDesc.BorderStyle(0)
Gui.FormRegCrate.lblTempDesc.Parent("frame2")
Gui.FormRegCrate.txtTemplate.Create(TextBox,"",True,133,20,0,14,65,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtTemplate.Parent("frame2")
Gui.FormRegCrate.txtTemplate.Event(LostFocus,txtTemplate_LostFocus)
Gui.FormRegCrate.txtTemplate.Event(GotFocus,txtTemplate_GotFocus)
Gui.FormRegCrate.ddlSide1.Create(DropDownList)
Gui.FormRegCrate.ddlSide1.Enabled(True)
Gui.FormRegCrate.ddlSide1.Visible(True)
Gui.FormRegCrate.ddlSide1.Zorder(0)
Gui.FormRegCrate.ddlSide1.Size(133,20)
Gui.FormRegCrate.ddlSide1.Position(450,99)
Gui.FormRegCrate.ddlSide1.FontName("Tahoma")
Gui.FormRegCrate.ddlSide1.FontSize(8.25)
Gui.FormRegCrate.ddlSide1.Parent("frame2")
Gui.FormRegCrate.ddlTop.Create(DropDownList)
Gui.FormRegCrate.ddlTop.Enabled(True)
Gui.FormRegCrate.ddlTop.Visible(True)
Gui.FormRegCrate.ddlTop.Zorder(0)
Gui.FormRegCrate.ddlTop.Size(125,20)
Gui.FormRegCrate.ddlTop.Position(752,99)
Gui.FormRegCrate.ddlTop.FontName("Tahoma")
Gui.FormRegCrate.ddlTop.FontSize(8.25)
Gui.FormRegCrate.ddlTop.Parent("frame2")
Gui.FormRegCrate.chkTop.Create(CheckBox)
Gui.FormRegCrate.chkTop.Enabled(True)
Gui.FormRegCrate.chkTop.Visible(True)
Gui.FormRegCrate.chkTop.Zorder(0)
Gui.FormRegCrate.chkTop.Size(85,20)
Gui.FormRegCrate.chkTop.Position(706,54)
Gui.FormRegCrate.chkTop.Caption("Framed Top")
Gui.FormRegCrate.chkTop.FontName("Tahoma")
Gui.FormRegCrate.chkTop.FontSize(8.25)
Gui.FormRegCrate.chkTop.Parent("frame2")
Gui.FormRegCrate.lblWidth.Create(Label,"Width",True,28,13,0,546,42,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblWidth.BorderStyle(0)
Gui.FormRegCrate.lblWidth.Parent("frame2")
Gui.FormRegCrate.txtWidth.Create(TextBox,"",True,64,20,0,546,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtWidth.Parent("frame2")
Gui.FormRegCrate.txtWidth.NumericOnly(1)
Gui.FormRegCrate.txtWidth.Event(GotFocus,txtWidth_GotFocus)
Gui.FormRegCrate.txtHeight.Create(TextBox,"",True,64,20,0,637,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtHeight.Parent("frame2")
Gui.FormRegCrate.txtHeight.NumericOnly(1)
Gui.FormRegCrate.txtHeight.Event(GotFocus,txtHeight_GotFocus)
Gui.FormRegCrate.lblBaseB.Create(Label,"Base Bottom Qty",True,81,13,0,797,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblBaseB.BorderStyle(0)
Gui.FormRegCrate.lblBaseB.Parent("frame2")
Gui.FormRegCrate.txtLength.Create(TextBox,"",True,64,20,0,454,54,True,0,"Tahoma",8.25,,1)
Gui.FormRegCrate.txtLength.Parent("frame2")
Gui.FormRegCrate.txtLength.NumericOnly(1)
Gui.FormRegCrate.txtLength.Event(GotFocus,txtLength_GotFocus)
Gui.FormRegCrate.lblHeight.Create(Label,"Height",True,31,13,0,637,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormRegCrate.lblHeight.BorderStyle(0)
Gui.FormRegCrate.lblHeight.Parent("frame2")
Gui.FormRegCrate.cmdBolt.Create(Button)
Gui.FormRegCrate.cmdBolt.Enabled(True)
Gui.FormRegCrate.cmdBolt.Visible(True)
Gui.FormRegCrate.cmdBolt.Zorder(0)
Gui.FormRegCrate.cmdBolt.Size(64,20)
Gui.FormRegCrate.cmdBolt.Position(884,77)
Gui.FormRegCrate.cmdBolt.Caption("Bolt")
Gui.FormRegCrate.cmdBolt.FontName("Tahoma")
Gui.FormRegCrate.cmdBolt.FontSize(8.25)
Gui.FormRegCrate.cmdBolt.Event(Click,cmdBolt_Click)
Gui.FormRegCrate.cmdAddMat.Create(Button)
Gui.FormRegCrate.cmdAddMat.Enabled(True)
Gui.FormRegCrate.cmdAddMat.Visible(True)
Gui.FormRegCrate.cmdAddMat.Zorder(0)
Gui.FormRegCrate.cmdAddMat.Size(133,20)
Gui.FormRegCrate.cmdAddMat.Position(884,99)
Gui.FormRegCrate.cmdAddMat.Caption("Additional Material")
Gui.FormRegCrate.cmdAddMat.FontName("Tahoma")
Gui.FormRegCrate.cmdAddMat.FontSize(8.25)
Gui.FormRegCrate.cmdAddMat.Event(Click,cmdAddMat_Click)
Gui.FormRegCrate.cmdBrace.Create(Button)
Gui.FormRegCrate.cmdBrace.Enabled(True)
Gui.FormRegCrate.cmdBrace.Visible(True)
Gui.FormRegCrate.cmdBrace.Zorder(0)
Gui.FormRegCrate.cmdBrace.Size(64,20)
Gui.FormRegCrate.cmdBrace.Position(953,77)
Gui.FormRegCrate.cmdBrace.Caption("Bracing")
Gui.FormRegCrate.cmdBrace.FontName("Tahoma")
Gui.FormRegCrate.cmdBrace.FontSize(8.25)
Gui.FormRegCrate.cmdBrace.Event(Click,cmdBrace_Click)
Gui.FormCrateSel..Create(BaseForm)
Gui.FormCrateSel..Caption("Crate Selection")
Gui.FormCrateSel..Size(468,120)
Gui.FormCrateSel..MinX(0)
Gui.FormCrateSel..MinY(0)
Gui.FormCrateSel..Position(0,0)
Gui.FormCrateSel..AlwaysOnTop(False)
Gui.FormCrateSel..FontName("Tahoma")
Gui.FormCrateSel..FontSize(8.25)
Gui.FormCrateSel..ControlBox(True)
Gui.FormCrateSel..MaxButton(True)
Gui.FormCrateSel..MinButton(True)
Gui.FormCrateSel..MousePointer(0)
Gui.FormCrateSel..Moveable(True)
Gui.FormCrateSel..Sizeable(True)
Gui.FormCrateSel..ShowInTaskBar(True)
Gui.FormCrateSel..TitleBar(True)
Gui.FormCrateSel..Event(UnLoad,FormCrateSel_UnLoad)
Gui.FormCrateSel.cmdReg.Create(Button)
Gui.FormCrateSel.cmdReg.Enabled(True)
Gui.FormCrateSel.cmdReg.Visible(True)
Gui.FormCrateSel.cmdReg.Zorder(0)
Gui.FormCrateSel.cmdReg.Size(120,47)
Gui.FormCrateSel.cmdReg.Position(19,23)
Gui.FormCrateSel.cmdReg.Caption("CRATE")
Gui.FormCrateSel.cmdReg.FontName("Tahoma")
Gui.FormCrateSel.cmdReg.FontSize(8.25)
Gui.FormCrateSel.cmdReg.Event(Click,cmdReg_Click)
Gui.FormCrateSel.cmdShell.Create(Button)
Gui.FormCrateSel.cmdShell.Enabled(True)
Gui.FormCrateSel.cmdShell.Visible(True)
Gui.FormCrateSel.cmdShell.Zorder(0)
Gui.FormCrateSel.cmdShell.Size(120,47)
Gui.FormCrateSel.cmdShell.Position(176,23)
Gui.FormCrateSel.cmdShell.Caption("SHELL CRATE")
Gui.FormCrateSel.cmdShell.FontName("Tahoma")
Gui.FormCrateSel.cmdShell.FontSize(8.25)
Gui.FormCrateSel.cmdShell.Event(Click,cmdShell_Click)
Gui.FormCrateSel.cmdSKID.Create(Button)
Gui.FormCrateSel.cmdSKID.Enabled(True)
Gui.FormCrateSel.cmdSKID.Visible(True)
Gui.FormCrateSel.cmdSKID.Zorder(0)
Gui.FormCrateSel.cmdSKID.Size(120,47)
Gui.FormCrateSel.cmdSKID.Position(332,23)
Gui.FormCrateSel.cmdSKID.Caption("SKID/PALLET")
Gui.FormCrateSel.cmdSKID.FontName("Tahoma")
Gui.FormCrateSel.cmdSKID.FontSize(8.25)
Gui.FormCrateSel.cmdSKID.Event(Click,cmdSKID_Click)
Gui.FormShell..Create(DashForm)
Gui.FormShell..Caption("SHELL CRATES  |  CUSTOMER: INVOTEC")
Gui.FormShell..Size(1024,639)
Gui.FormShell..MinX(0)
Gui.FormShell..MinY(0)
Gui.FormShell..Position(0,0)
Gui.FormShell..AlwaysOnTop(False)
Gui.FormShell..FontName("Tahoma")
Gui.FormShell..FontSize(8.25)
Gui.FormShell..ControlBox(True)
Gui.FormShell..MaxButton(True)
Gui.FormShell..MinButton(True)
Gui.FormShell..MousePointer(0)
Gui.FormShell..Moveable(True)
Gui.FormShell..Sizeable(True)
Gui.FormShell..ShowInTaskBar(True)
Gui.FormShell..TitleBar(True)
Gui.FormShell..Event(UnLoad,FormShell_UnLoad)
Gui.FormShell..Event(SaveButtonClick,FormShell_SaveButtonClick)
Gui.FormShell..BarSaveButton(True,True)
Gui.FormShell.frame1.Create(Frame)
Gui.FormShell.frame1.Enabled(True)
Gui.FormShell.frame1.Visible(True)
Gui.FormShell.frame1.Zorder(0)
Gui.FormShell.frame1.Size(1024,119)
Gui.FormShell.frame1.Position(0,1)
Gui.FormShell.frame1.Caption("Data Entry")
Gui.FormShell.frame1.FontName("Tahoma")
Gui.FormShell.frame1.FontSize(8.25)
Gui.FormShell.frame1.BorderStyle(1)
Gui.FormShell.frame1.Dock(0)
Gui.FormShell.frame1.Anchor(15)
Gui.FormShell.lbl1.Create(Label,"Template",True,44,13,0,15,46,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl1.BorderStyle(0)
Gui.FormShell.lbl1.Parent("frame1")
Gui.FormShell.txtShellTemplate.Create(TextBox,"",True,142,20,0,15,62,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellTemplate.Parent("frame1")
Gui.FormShell.txtShellTemplate.Event(GotFocus,txtShellTemplate_GotFocus)
Gui.FormShell.txtShellTemplate.Event(LostFocus,txtShellTemplate_LostFocus)
Gui.FormShell.txtRtrTime.Create(TextBox,"",True,58,20,0,99,40,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtRtrTime.NumericOnly(2)
Gui.FormShell.txtRtrTime.Parent("frame1")
Gui.FormShell.cmdShellTemplate.Create(Button)
Gui.FormShell.cmdShellTemplate.Enabled(True)
Gui.FormShell.cmdShellTemplate.Visible(True)
Gui.FormShell.cmdShellTemplate.Zorder(0)
Gui.FormShell.cmdShellTemplate.Size(35,23)
Gui.FormShell.cmdShellTemplate.Position(161,60)
Gui.FormShell.cmdShellTemplate.Caption("")
Gui.FormShell.cmdShellTemplate.FontName("Tahoma")
Gui.FormShell.cmdShellTemplate.FontSize(8.25)
Gui.FormShell.cmdShellTemplate.SvgPicture("icon_browser_color")
Gui.FormShell.cmdShellTemplate.Parent("frame1")
Gui.FormShell.cmdShellTemplate.Event(Click,cmdShellTemplate_Click)
Gui.FormShell.txtShellDesc.Create(TextBox,"",True,233,20,0,216,61,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellDesc.Parent("frame1")
Gui.FormShell.txtShellDesc.Mask(">")
Gui.FormShell.txtShellDesc.MaxLength(30)
Gui.FormShell.txtShellLen.Create(TextBox,"",True,58,20,0,544,54,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellLen.Parent("frame1")
Gui.FormShell.txtShellLen.NumericOnly(1)
Gui.FormShell.txtShellLen.Event(GotFocus,txtShellLen_GotFocus)
Gui.FormShell.txtShellLen.Event(LostFocus,txtShellLen_LostFocus)
Gui.FormShell.txtShellWidth.Create(TextBox,"",True,58,20,0,624,55,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellWidth.Parent("frame1")
Gui.FormShell.txtShellWidth.NumericOnly(1)
Gui.FormShell.txtShellWidth.Event(GotFocus,txtShellWidth_GotFocus)
Gui.FormShell.txtShellWidth.Event(LostFocus,txtShellWidth_LostFocus)
Gui.FormShell.txtShellHeight.Create(TextBox,"",True,58,20,0,704,55,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtShellHeight.Parent("frame1")
Gui.FormShell.txtShellHeight.NumericOnly(1)
Gui.FormShell.txtShellHeight.Event(GotFocus,txtShellHeight_GotFocus)
Gui.FormShell.txtShellHeight.Event(LostFocus,txtShellHeight_LostFocus)
Gui.FormShell.lbl5.Create(Label,"X",True,6,13,0,610,59,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl5.BorderStyle(0)
Gui.FormShell.lbl5.Parent("frame1")
Gui.FormShell.lbl8.Create(Label,"Height",True,31,13,0,706,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl8.BorderStyle(0)
Gui.FormShell.lbl8.Parent("frame1")
Gui.FormShell.lbl6.Create(Label,"Width",True,28,13,0,626,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl6.BorderStyle(0)
Gui.FormShell.lbl6.Parent("frame1")
Gui.FormShell.lbl4.Create(Label,"Length",True,33,13,0,546,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl4.BorderStyle(0)
Gui.FormShell.lbl4.Parent("frame1")
Gui.FormShell.lbl3.Create(Label,"Skid Size",True,41,13,0,492,58,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl3.BorderStyle(0)
Gui.FormShell.lbl3.Parent("frame1")
Gui.FormShell.lblShellDesc.Create(Label,"Description",True,53,13,0,216,44,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblShellDesc.BorderStyle(0)
Gui.FormShell.lblShellDesc.Parent("frame1")
Gui.FormShell.chkShellHT.Create(CheckBox)
Gui.FormShell.chkShellHT.Enabled(True)
Gui.FormShell.chkShellHT.Visible(False)
Gui.FormShell.chkShellHT.Zorder(0)
Gui.FormShell.chkShellHT.Size(123,20)
Gui.FormShell.chkShellHT.Position(769,55)
Gui.FormShell.chkShellHT.Caption("HT STAMP")
Gui.FormShell.chkShellHT.FontName("Tahoma")
Gui.FormShell.chkShellHT.FontSize(8.25)
Gui.FormShell.chkShellHT.Parent("frame1")
Gui.FormShell.lblRtrTime.Create(Label,"Time in Mins per Crate",True,106,13,0,89,27,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblRtrTime.BorderStyle(0)
Gui.FormShell.lblRtrTime.Parent("frame1")
Gui.FormShell.lbl7.Create(Label,"X",True,6,13,0,690,59,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl7.BorderStyle(0)
Gui.FormShell.lbl7.Parent("frame1")
Gui.FormShell.lblExtraShellDesc.Create(Label,"Extra Description",True,82,13,0,17,83,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblExtraShellDesc.BorderStyle(0)
Gui.FormShell.lblExtraShellDesc.Parent("frame1")
Gui.FormShell.txtExtraShellDesc.Create(TextBox,"",True,544,20,0,16,97,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtExtraShellDesc.Mask(">")
Gui.FormShell.txtExtraShellDesc.Parent("frame1")
Gui.FormShell.frame2.Create(Frame)
Gui.FormShell.frame2.Enabled(True)
Gui.FormShell.frame2.Visible(True)
Gui.FormShell.frame2.Zorder(0)
Gui.FormShell.frame2.Size(612,101)
Gui.FormShell.frame2.Position(0,122)
Gui.FormShell.frame2.Caption("Stringers")
Gui.FormShell.frame2.FontName("Tahoma")
Gui.FormShell.frame2.FontSize(8.25)
Gui.FormShell.frame2.BorderStyle(1)
Gui.FormShell.lbl12.Create(Label,"Qty",True,18,13,0,180,41,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl12.BorderStyle(0)
Gui.FormShell.lbl12.Parent("frame2")
Gui.FormShell.lbl10.Create(Label,"Bottom Stringers",True,80,13,0,300,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl10.BorderStyle(0)
Gui.FormShell.lbl10.Parent("frame2")
Gui.FormShell.lbl11.Create(Label,"Material",True,38,13,0,14,78,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl11.BorderStyle(0)
Gui.FormShell.lbl11.Parent("frame2")
Gui.FormShell.lbl14.Create(Label,"Qty",True,18,13,0,464,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl14.BorderStyle(0)
Gui.FormShell.lbl14.Parent("frame2")
Gui.FormShell.lbl13.Create(Label,"Material",True,38,13,0,300,78,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl13.BorderStyle(0)
Gui.FormShell.lbl13.Parent("frame2")
Gui.FormShell.txtTStrg.Create(TextBox,"",True,56,20,0,114,37,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTStrg.Parent("frame2")
Gui.FormShell.txtTStrg.NumericOnly(1)
Gui.FormShell.txtTStrg.Event(GotFocus,txtTStrg_GotFocus)
Gui.FormShell.lbl9.Create(Label,"Length of Stringers",True,92,13,0,14,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl9.BorderStyle(0)
Gui.FormShell.lbl9.Parent("frame2")
Gui.FormShell.ddlBStrg.Create(DropDownList)
Gui.FormShell.ddlBStrg.Enabled(True)
Gui.FormShell.ddlBStrg.Visible(True)
Gui.FormShell.ddlBStrg.Zorder(0)
Gui.FormShell.ddlBStrg.Size(203,20)
Gui.FormShell.ddlBStrg.Position(347,75)
Gui.FormShell.ddlBStrg.FontName("Tahoma")
Gui.FormShell.ddlBStrg.FontSize(8.25)
Gui.FormShell.ddlBStrg.Parent("frame2")
Gui.FormShell.ddlBStrg.Event(SelectedIndexChanged,ddlBStrg_SelectedIndexChanged)
Gui.FormShell.txtBstrgQty.Create(TextBox,"",True,56,20,0,493,38,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtBstrgQty.Parent("frame2")
Gui.FormShell.txtBstrgQty.NumericOnly(1)
Gui.FormShell.txtBstrgQty.Event(GotFocus,txtBstrgQty_GotFocus)
Gui.FormShell.txtBStrg.Create(TextBox,"",True,56,20,0,394,38,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtBStrg.NumericOnly(1)
Gui.FormShell.txtBStrg.Parent("frame2")
Gui.FormShell.txtBStrg.Event(GotFocus,txtBStrg_GotFocus)
Gui.FormShell.ddlTStrgMat.Create(DropDownList)
Gui.FormShell.ddlTStrgMat.Enabled(True)
Gui.FormShell.ddlTStrgMat.Visible(True)
Gui.FormShell.ddlTStrgMat.Zorder(0)
Gui.FormShell.ddlTStrgMat.Size(203,20)
Gui.FormShell.ddlTStrgMat.Position(60,75)
Gui.FormShell.ddlTStrgMat.FontName("Tahoma")
Gui.FormShell.ddlTStrgMat.FontSize(8.25)
Gui.FormShell.ddlTStrgMat.Parent("frame2")
Gui.FormShell.ddlTStrgMat.Event(SelectedIndexChanged,ddlTStrgMat_SelectedIndexChanged)
Gui.FormShell.txtTStrgQty.Create(TextBox,"",True,56,20,0,206,38,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTStrgQty.Parent("frame2")
Gui.FormShell.txtTStrgQty.NumericOnly(1)
Gui.FormShell.txtTStrgQty.Event(GotFocus,txtTStrgQty_GotFocus)
Gui.FormShell.frame3.Create(Frame)
Gui.FormShell.frame3.Enabled(True)
Gui.FormShell.frame3.Visible(True)
Gui.FormShell.frame3.Zorder(0)
Gui.FormShell.frame3.Size(407,100)
Gui.FormShell.frame3.Position(615,123)
Gui.FormShell.frame3.Caption("Runners")
Gui.FormShell.frame3.FontName("Tahoma")
Gui.FormShell.frame3.FontSize(8.25)
Gui.FormShell.frame3.BorderStyle(1)
Gui.FormShell.frame3.Anchor(13)
Gui.FormShell.txtLRun.Create(TextBox,"",True,56,20,0,115,37,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtLRun.Parent("frame3")
Gui.FormShell.txtLRun.NumericOnly(1)
Gui.FormShell.txtLRun.Event(GotFocus,txtLRun_GotFocus)
Gui.FormShell.txtRunQty.Create(TextBox,"",True,56,20,0,212,38,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtRunQty.Parent("frame3")
Gui.FormShell.txtRunQty.NumericOnly(1)
Gui.FormShell.txtRunQty.Event(GotFocus,txtRunQty_GotFocus)
Gui.FormShell.ddlRunMat.Create(DropDownList)
Gui.FormShell.ddlRunMat.Enabled(True)
Gui.FormShell.ddlRunMat.Visible(True)
Gui.FormShell.ddlRunMat.Zorder(0)
Gui.FormShell.ddlRunMat.Size(203,20)
Gui.FormShell.ddlRunMat.Position(67,75)
Gui.FormShell.ddlRunMat.FontName("Tahoma")
Gui.FormShell.ddlRunMat.FontSize(8.25)
Gui.FormShell.ddlRunMat.Parent("frame3")
Gui.FormShell.ddlRunMat.Event(SelectedIndexChanged,ddlRunMat_SelectedIndexChanged)
Gui.FormShell.lbl16.Create(Label,"Qty",True,18,13,0,182,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl16.BorderStyle(0)
Gui.FormShell.lbl16.Parent("frame3")
Gui.FormShell.lbl15.Create(Label,"Length of Runners",True,89,13,0,12,40,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl15.BorderStyle(0)
Gui.FormShell.lbl15.Parent("frame3")
Gui.FormShell.lbl17.Create(Label,"Material",True,38,13,0,13,78,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl17.BorderStyle(0)
Gui.FormShell.lbl17.Parent("frame3")
Gui.FormShell.frame4.Create(Frame)
Gui.FormShell.frame4.Enabled(True)
Gui.FormShell.frame4.Visible(True)
Gui.FormShell.frame4.Zorder(0)
Gui.FormShell.frame4.Size(1022,188)
Gui.FormShell.frame4.Position(0,225)
Gui.FormShell.frame4.Caption("Misc")
Gui.FormShell.frame4.FontName("Tahoma")
Gui.FormShell.frame4.FontSize(8.25)
Gui.FormShell.frame4.BorderStyle(1)
Gui.FormShell.frame4.Anchor(15)
Gui.FormShell.txtTopCutLenDim1.Create(TextBox,"",True,76,20,0,423,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopCutLenDim1.NumericOnly(1)
Gui.FormShell.txtTopCutLenDim1.Parent("frame4")
Gui.FormShell.txtTopCutLenDim1.Event(GotFocus,txtTopCutLenDim1_GotFocus)
Gui.FormShell.txtSide2QtyDim2.Create(TextBox,"",True,76,20,0,536,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2QtyDim2.NumericOnly(1)
Gui.FormShell.txtSide2QtyDim2.Parent("frame4")
Gui.FormShell.txtSide2QtyDim2.Event(GotFocus,txtSide2QtyDim2_GotFocus)
Gui.FormShell.txtTopQtyDim1.Create(TextBox,"",True,76,20,0,314,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopQtyDim1.NumericOnly(1)
Gui.FormShell.txtTopQtyDim1.Parent("frame4")
Gui.FormShell.txtTopQtyDim1.Event(GotFocus,txtTopQtyDim1_GotFocus)
Gui.FormShell.ddlTopMat.Create(DropDownList)
Gui.FormShell.ddlTopMat.Enabled(True)
Gui.FormShell.ddlTopMat.Visible(True)
Gui.FormShell.ddlTopMat.Zorder(0)
Gui.FormShell.ddlTopMat.Size(203,20)
Gui.FormShell.ddlTopMat.Position(78,157)
Gui.FormShell.ddlTopMat.FontName("Tahoma")
Gui.FormShell.ddlTopMat.FontSize(8.25)
Gui.FormShell.ddlTopMat.Parent("frame4")
Gui.FormShell.ddlTopMat.Event(SelectedIndexChanged,ddlTopMat_SelectedIndexChanged)
Gui.FormShell.chkBoltTopRun.Create(CheckBox)
Gui.FormShell.chkBoltTopRun.Enabled(True)
Gui.FormShell.chkBoltTopRun.Visible(False)
Gui.FormShell.chkBoltTopRun.Zorder(0)
Gui.FormShell.chkBoltTopRun.Size(143,20)
Gui.FormShell.chkBoltTopRun.Position(16,40)
Gui.FormShell.chkBoltTopRun.Caption("Bolt Top Runners")
Gui.FormShell.chkBoltTopRun.FontName("Tahoma")
Gui.FormShell.chkBoltTopRun.FontSize(8.25)
Gui.FormShell.chkBoltTopRun.Parent("frame4")
Gui.FormShell.chkLagString.Create(CheckBox)
Gui.FormShell.chkLagString.Enabled(True)
Gui.FormShell.chkLagString.Visible(False)
Gui.FormShell.chkLagString.Zorder(0)
Gui.FormShell.chkLagString.Size(155,20)
Gui.FormShell.chkLagString.Position(192,40)
Gui.FormShell.chkLagString.Caption("Lag Stringers")
Gui.FormShell.chkLagString.FontName("Tahoma")
Gui.FormShell.chkLagString.FontSize(8.25)
Gui.FormShell.chkLagString.Parent("frame4")
Gui.FormShell.txtNotes.Create(TextBox,"",False,530,20,0,488,39,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtNotes.Parent("frame4")
Gui.FormShell.txtNotes.Event(GotFocus,txtNotes_GotFocus)
Gui.FormShell.txtNotes.MaxLength(30)
Gui.FormShell.ddlSide1Mat.Create(DropDownList)
Gui.FormShell.ddlSide1Mat.Enabled(True)
Gui.FormShell.ddlSide1Mat.Visible(True)
Gui.FormShell.ddlSide1Mat.Zorder(0)
Gui.FormShell.ddlSide1Mat.Size(203,20)
Gui.FormShell.ddlSide1Mat.Position(77,87)
Gui.FormShell.ddlSide1Mat.FontName("Tahoma")
Gui.FormShell.ddlSide1Mat.FontSize(8.25)
Gui.FormShell.ddlSide1Mat.Parent("frame4")
Gui.FormShell.ddlSide1Mat.Event(SelectedIndexChanged,ddlSide1Mat_SelectedIndexChanged)
Gui.FormShell.txtSide1CutLenDim1.Create(TextBox,"",True,76,20,0,423,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1CutLenDim1.NumericOnly(1)
Gui.FormShell.txtSide1CutLenDim1.Parent("frame4")
Gui.FormShell.txtSide1CutLenDim1.Event(GotFocus,txtSide1CutLenDim1_GotFocus)
Gui.FormShell.txtSide1QtyDim2.Create(TextBox,"",True,76,20,0,536,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1QtyDim2.NumericOnly(1)
Gui.FormShell.txtSide1QtyDim2.Parent("frame4")
Gui.FormShell.txtSide1QtyDim2.Event(GotFocus,txtSide1QtyDim2_GotFocus)
Gui.FormShell.txtSide1CutLenDim2.Create(TextBox,"",True,76,20,0,645,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1CutLenDim2.NumericOnly(1)
Gui.FormShell.txtSide1CutLenDim2.Parent("frame4")
Gui.FormShell.txtSide1CutLenDim2.Event(GotFocus,txtSide1CutLenDim2_GotFocus)
Gui.FormShell.ddlSide2Mat.Create(DropDownList)
Gui.FormShell.ddlSide2Mat.Enabled(True)
Gui.FormShell.ddlSide2Mat.Visible(True)
Gui.FormShell.ddlSide2Mat.Zorder(0)
Gui.FormShell.ddlSide2Mat.Size(203,20)
Gui.FormShell.ddlSide2Mat.Position(78,123)
Gui.FormShell.ddlSide2Mat.FontName("Tahoma")
Gui.FormShell.ddlSide2Mat.FontSize(8.25)
Gui.FormShell.ddlSide2Mat.Parent("frame4")
Gui.FormShell.ddlSide2Mat.Event(SelectedIndexChanged,ddlSide2Mat_SelectedIndexChanged)
Gui.FormShell.txtSide2QtyDim1.Create(TextBox,"",True,76,20,0,314,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2QtyDim1.NumericOnly(1)
Gui.FormShell.txtSide2QtyDim1.Parent("frame4")
Gui.FormShell.txtSide2QtyDim1.Event(GotFocus,txtSide2QtyDim1_GotFocus)
Gui.FormShell.txtSide2CutLenDim1.Create(TextBox,"",True,76,20,0,423,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2CutLenDim1.NumericOnly(1)
Gui.FormShell.txtSide2CutLenDim1.Parent("frame4")
Gui.FormShell.txtSide2CutLenDim1.Event(GotFocus,txtSide2CutLenDim1_GotFocus)
Gui.FormShell.txtSide1QtyDim1.Create(TextBox,"",True,76,20,0,314,87,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide1QtyDim1.NumericOnly(1)
Gui.FormShell.txtSide1QtyDim1.Parent("frame4")
Gui.FormShell.txtSide1QtyDim1.Event(GotFocus,txtSide1QtyDim1_GotFocus)
Gui.FormShell.txtSide2CutLenDim2.Create(TextBox,"",True,76,20,0,645,123,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtSide2CutLenDim2.NumericOnly(1)
Gui.FormShell.txtSide2CutLenDim2.Parent("frame4")
Gui.FormShell.txtSide2CutLenDim2.Event(GotFocus,txtSide2CutLenDim2_GotFocus)
Gui.FormShell.txtTopQtyDim2.Create(TextBox,"",True,76,20,0,536,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopQtyDim2.NumericOnly(1)
Gui.FormShell.txtTopQtyDim2.Parent("frame4")
Gui.FormShell.txtTopQtyDim2.Event(GotFocus,txtTopQtyDim2_GotFocus)
Gui.FormShell.txtTopCutLenDim2.Create(TextBox,"",True,76,20,0,645,157,True,0,"Tahoma",8.25,,1)
Gui.FormShell.txtTopCutLenDim2.NumericOnly(1)
Gui.FormShell.txtTopCutLenDim2.Parent("frame4")
Gui.FormShell.txtTopCutLenDim2.Event(GotFocus,txtTopCutLenDim2_GotFocus)
Gui.FormShell.lblMaterial.Create(Label,"Material",True,38,13,0,78,66,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblMaterial.BorderStyle(0)
Gui.FormShell.lblMaterial.Parent("frame4")
Gui.FormShell.lblCutLengthDim2.Create(Label,"Cut Length Dim 2",True,82,13,0,645,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblCutLengthDim2.BorderStyle(0)
Gui.FormShell.lblCutLengthDim2.Parent("frame4")
Gui.FormShell.lblQtyDim2.Create(Label,"Qty Dim 2",True,47,13,0,536,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblQtyDim2.BorderStyle(0)
Gui.FormShell.lblQtyDim2.Parent("frame4")
Gui.FormShell.lblCutLengthDim1.Create(Label,"Cut Length Dim 1",True,82,13,0,423,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblCutLengthDim1.BorderStyle(0)
Gui.FormShell.lblCutLengthDim1.Parent("frame4")
Gui.FormShell.lbl20.Create(Label,"Notes",False,28,13,0,445,43,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lbl20.BorderStyle(0)
Gui.FormShell.lbl20.Parent("frame4")
Gui.FormShell.lblSide1.Create(Label,"SIDE 1",True,32,13,0,20,90,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblSide1.BorderStyle(0)
Gui.FormShell.lblSide1.Parent("frame4")
Gui.FormShell.lblSide2.Create(Label,"SIDE 2",True,32,13,0,20,126,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblSide2.BorderStyle(0)
Gui.FormShell.lblSide2.Parent("frame4")
Gui.FormShell.lblTop.Create(Label,"TOP",True,20,13,0,20,160,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblTop.BorderStyle(0)
Gui.FormShell.lblTop.Parent("frame4")
Gui.FormShell.lblQtyDim1.Create(Label,"Qty Dim 1",True,47,13,0,314,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormShell.lblQtyDim1.BorderStyle(0)
Gui.FormShell.lblQtyDim1.Parent("frame4")
Gui.FormShell.frame5.Create(Frame)
Gui.FormShell.frame5.Enabled(True)
Gui.FormShell.frame5.Visible(True)
Gui.FormShell.frame5.Zorder(0)
Gui.FormShell.frame5.Size(1022,281)
Gui.FormShell.frame5.Position(1,408)
Gui.FormShell.frame5.Caption("Router Sequences")
Gui.FormShell.frame5.FontName("Tahoma")
Gui.FormShell.frame5.FontSize(8.25)
Gui.FormShell.frame5.BorderStyle(1)
Gui.FormShell.frame5.Anchor(15)
Gui.FormShell.GsGridShellNewRout.Create(GsGridControl)
Gui.FormShell.GsGridShellNewRout.Enabled(True)
Gui.FormShell.GsGridShellNewRout.Visible(True)
Gui.FormShell.GsGridShellNewRout.Zorder(0)
Gui.FormShell.GsGridShellNewRout.Size(1023,133)
Gui.FormShell.GsGridShellNewRout.Position(-3,29)
Gui.FormShell.GsGridShellNewRout.Parent("frame5")
Gui.FormShell.GsGridShellNewRout.Dock(0)
Gui.FormShell.GsGridShellNewRout.Anchor(15)
Gui.FormShell.cmdShellCalc.Create(Button)
Gui.FormShell.cmdShellCalc.Enabled(True)
Gui.FormShell.cmdShellCalc.Visible(True)
Gui.FormShell.cmdShellCalc.Zorder(0)
Gui.FormShell.cmdShellCalc.Size(63,41)
Gui.FormShell.cmdShellCalc.Position(927,42)
Gui.FormShell.cmdShellCalc.Caption("")
Gui.FormShell.cmdShellCalc.FontName("Tahoma")
Gui.FormShell.cmdShellCalc.FontSize(8.25)
Gui.FormShell.cmdShellCalc.SvgPicture("icon_go_black")
Gui.FormShell.cmdShellCalc.Event(Click,cmdShellCalc_Click)
Gui.FormShell.cmdShellBolt.Create(Button)
Gui.FormShell.cmdShellBolt.Enabled(True)
Gui.FormShell.cmdShellBolt.Visible(True)
Gui.FormShell.cmdShellBolt.Zorder(0)
Gui.FormShell.cmdShellBolt.Size(75,23)
Gui.FormShell.cmdShellBolt.Position(574,89)
Gui.FormShell.cmdShellBolt.Caption("Bolt")
Gui.FormShell.cmdShellBolt.FontName("Tahoma")
Gui.FormShell.cmdShellBolt.FontSize(8.25)
Gui.FormShell.cmdShellBolt.Event(Click,cmdBolt_Click)
Gui.FormShell.cmdShellLag.Create(Button)
Gui.FormShell.cmdShellLag.Enabled(True)
Gui.FormShell.cmdShellLag.Visible(True)
Gui.FormShell.cmdShellLag.Zorder(0)
Gui.FormShell.cmdShellLag.Size(75,23)
Gui.FormShell.cmdShellLag.Position(655,89)
Gui.FormShell.cmdShellLag.Caption("Lag")
Gui.FormShell.cmdShellLag.FontName("Tahoma")
Gui.FormShell.cmdShellLag.FontSize(8.25)
Gui.FormShell.cmdShellLag.Event(Click,cmdBrace_Click)
Gui.FormShell.cmdShellAddMat.Create(Button)
Gui.FormShell.cmdShellAddMat.Enabled(True)
Gui.FormShell.cmdShellAddMat.Visible(True)
Gui.FormShell.cmdShellAddMat.Zorder(0)
Gui.FormShell.cmdShellAddMat.Size(146,23)
Gui.FormShell.cmdShellAddMat.Position(737,89)
Gui.FormShell.cmdShellAddMat.Caption("Additional Material")
Gui.FormShell.cmdShellAddMat.FontName("Tahoma")
Gui.FormShell.cmdShellAddMat.FontSize(8.25)
Gui.FormShell.cmdShellAddMat.Event(Click,cmdAddMat_Click)
Gui.FormSkid..Create(DashForm)
Gui.FormSkid..Caption("SKID/PALLETS |  CUSTOMER: INVOTEC")
Gui.FormSkid..Size(1024,639)
Gui.FormSkid..MinX(0)
Gui.FormSkid..MinY(0)
Gui.FormSkid..Position(0,0)
Gui.FormSkid..AlwaysOnTop(False)
Gui.FormSkid..FontName("Tahoma")
Gui.FormSkid..FontSize(8.25)
Gui.FormSkid..ControlBox(True)
Gui.FormSkid..MaxButton(True)
Gui.FormSkid..MinButton(True)
Gui.FormSkid..MousePointer(0)
Gui.FormSkid..Moveable(True)
Gui.FormSkid..Sizeable(True)
Gui.FormSkid..ShowInTaskBar(True)
Gui.FormSkid..TitleBar(True)
Gui.FormSkid..BarSaveButton(True,True)
Gui.FormSkid..Event(SaveButtonClick,FormSkid_SaveButtonClick)
Gui.FormSkid..Event(UnLoad,FormSkid_UnLoad)
Gui.FormSkid.frame1.Create(Frame)
Gui.FormSkid.frame1.Enabled(True)
Gui.FormSkid.frame1.Visible(True)
Gui.FormSkid.frame1.Zorder(0)
Gui.FormSkid.frame1.Size(1024,131)
Gui.FormSkid.frame1.Position(0,0)
Gui.FormSkid.frame1.Caption("Data Entry")
Gui.FormSkid.frame1.FontName("Tahoma")
Gui.FormSkid.frame1.FontSize(8.25)
Gui.FormSkid.frame1.BorderStyle(1)
Gui.FormSkid.frame1.Dock(0)
Gui.FormSkid.frame1.Anchor(15)
Gui.FormSkid.lbl1.Create(Label,"Template",True,44,13,0,15,43,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl1.BorderStyle(0)
Gui.FormSkid.lbl1.Parent("frame1")
Gui.FormSkid.txtSkidTemplate.Create(TextBox,"",True,142,20,0,15,64,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtSkidTemplate.Parent("frame1")
Gui.FormSkid.txtSkidTemplate.Event(GotFocus,txtSkidTemplate_GotFocus)
Gui.FormSkid.txtSkidTemplate.Event(LostFocus,txtSkidTemplate_LostFocus)
Gui.FormSkid.chkSkidBolt.Create(CheckBox)
Gui.FormSkid.chkSkidBolt.Enabled(True)
Gui.FormSkid.chkSkidBolt.Visible(False)
Gui.FormSkid.chkSkidBolt.Zorder(0)
Gui.FormSkid.chkSkidBolt.Size(80,20)
Gui.FormSkid.chkSkidBolt.Position(605,40)
Gui.FormSkid.chkSkidBolt.Caption("Bolt")
Gui.FormSkid.chkSkidBolt.FontName("Tahoma")
Gui.FormSkid.chkSkidBolt.FontSize(8)
Gui.FormSkid.chkSkidBolt.Parent("frame1")
Gui.FormSkid.cmdSkidTemplate.Create(Button)
Gui.FormSkid.cmdSkidTemplate.Enabled(True)
Gui.FormSkid.cmdSkidTemplate.Visible(True)
Gui.FormSkid.cmdSkidTemplate.Zorder(0)
Gui.FormSkid.cmdSkidTemplate.Size(35,25)
Gui.FormSkid.cmdSkidTemplate.Position(161,64)
Gui.FormSkid.cmdSkidTemplate.Caption("")
Gui.FormSkid.cmdSkidTemplate.FontName("Tahoma")
Gui.FormSkid.cmdSkidTemplate.FontSize(8.25)
Gui.FormSkid.cmdSkidTemplate.SvgPicture("icon_browser_color")
Gui.FormSkid.cmdSkidTemplate.Parent("frame1")
Gui.FormSkid.cmdSkidTemplate.Event(Click,cmdSkidTemplate_Click)
Gui.FormSkid.txtSkidDesc.Create(TextBox,"",True,233,20,0,216,63,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtSkidDesc.Parent("frame1")
Gui.FormSkid.txtSkidDesc.Mask(">")
Gui.FormSkid.txtSkidDesc.MaxLength(30)
Gui.FormSkid.txtSkidLen.Create(TextBox,"",True,58,20,0,464,63,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtSkidLen.Parent("frame1")
Gui.FormSkid.txtSkidLen.NumericOnly(1)
Gui.FormSkid.txtSkidLen.Event(GotFocus,txtSkidLen_GotFocus)
Gui.FormSkid.txtSkidLen.Event(LostFocus,txtSkidLen_LostFocus)
Gui.FormSkid.txtSkidWidth.Create(TextBox,"",True,58,20,0,544,63,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtSkidWidth.Parent("frame1")
Gui.FormSkid.txtSkidWidth.NumericOnly(1)
Gui.FormSkid.txtSkidWidth.Event(GotFocus,txtSkidWidth_GotFocus)
Gui.FormSkid.txtSkidWidth.Event(LostFocus,txtSkidWidth_LostFocus)
Gui.FormSkid.lbl5.Create(Label,"X",True,6,13,0,529,67,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl5.BorderStyle(0)
Gui.FormSkid.lbl5.Parent("frame1")
Gui.FormSkid.lbl6.Create(Label,"Width",True,28,13,0,546,42,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl6.BorderStyle(0)
Gui.FormSkid.lbl6.Parent("frame1")
Gui.FormSkid.lbl4.Create(Label,"Length",True,33,13,0,464,42,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl4.BorderStyle(0)
Gui.FormSkid.lbl4.Parent("frame1")
Gui.FormSkid.lblSkidDesc.Create(Label,"Description",True,53,13,0,216,42,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lblSkidDesc.BorderStyle(0)
Gui.FormSkid.lblSkidDesc.Parent("frame1")
Gui.FormSkid.txtSkidBracing.Create(TextBox,"",False,266,20,0,694,72,True,0,"Tahoma",8,,1)
Gui.FormSkid.txtSkidBracing.MaxLength(30)
Gui.FormSkid.txtSkidBracing.Parent("frame1")
Gui.FormSkid.chkSkidBracing.Create(CheckBox)
Gui.FormSkid.chkSkidBracing.Enabled(True)
Gui.FormSkid.chkSkidBracing.Visible(False)
Gui.FormSkid.chkSkidBracing.Zorder(0)
Gui.FormSkid.chkSkidBracing.Size(87,20)
Gui.FormSkid.chkSkidBracing.Position(605,70)
Gui.FormSkid.chkSkidBracing.Caption("Bracing")
Gui.FormSkid.chkSkidBracing.FontName("Tahoma")
Gui.FormSkid.chkSkidBracing.FontSize(8)
Gui.FormSkid.chkSkidBracing.Parent("frame1")
Gui.FormSkid.txtSkidBolt.Create(TextBox,"",False,267,20,0,694,42,True,0,"Tahoma",8,,1)
Gui.FormSkid.txtSkidBolt.Parent("frame1")
Gui.FormSkid.txtSkidBolt.MaxLength(30)
Gui.FormSkid.lblRtrTime.Create(Label,"Time in Mins per Skid/Pallet",True,128,13,0,79,28,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lblRtrTime.BorderStyle(0)
Gui.FormSkid.lblRtrTime.Parent("frame1")
Gui.FormSkid.txtRtrTime.Create(TextBox,"",True,59,20,0,98,42,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtRtrTime.NumericOnly(2)
Gui.FormSkid.txtRtrTime.Parent("frame1")
Gui.FormSkid.lblSkidExtraDesc.Create(Label,"Extra Description",True,82,13,0,15,91,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lblSkidExtraDesc.BorderStyle(0)
Gui.FormSkid.lblSkidExtraDesc.Parent("frame1")
Gui.FormSkid.txtSkidExtraDesc.Create(TextBox,"",True,544,20,0,15,106,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtSkidExtraDesc.Mask(">")
Gui.FormSkid.txtSkidExtraDesc.Parent("frame1")
Gui.FormSkid.cmdSkidBolt.Create(Button)
Gui.FormSkid.cmdSkidBolt.Enabled(True)
Gui.FormSkid.cmdSkidBolt.Visible(True)
Gui.FormSkid.cmdSkidBolt.Zorder(0)
Gui.FormSkid.cmdSkidBolt.Size(75,23)
Gui.FormSkid.cmdSkidBolt.Position(605,40)
Gui.FormSkid.cmdSkidBolt.Caption("Bolt")
Gui.FormSkid.cmdSkidBolt.FontName("Tahoma")
Gui.FormSkid.cmdSkidBolt.FontSize(8.25)
Gui.FormSkid.cmdSkidBolt.Parent("frame1")
Gui.FormSkid.cmdSkidBolt.Event(Click,cmdBolt_Click)
Gui.FormSkid.cmdSkidBrace.Create(Button)
Gui.FormSkid.cmdSkidBrace.Enabled(True)
Gui.FormSkid.cmdSkidBrace.Visible(True)
Gui.FormSkid.cmdSkidBrace.Zorder(0)
Gui.FormSkid.cmdSkidBrace.Size(75,23)
Gui.FormSkid.cmdSkidBrace.Position(605,70)
Gui.FormSkid.cmdSkidBrace.Caption("Bracing")
Gui.FormSkid.cmdSkidBrace.FontName("Tahoma")
Gui.FormSkid.cmdSkidBrace.FontSize(8.25)
Gui.FormSkid.cmdSkidBrace.Parent("frame1")
Gui.FormSkid.cmdSkidBrace.Event(Click,cmdBrace_Click)
Gui.FormSkid.cmdSkidAddMat.Create(Button)
Gui.FormSkid.cmdSkidAddMat.Enabled(True)
Gui.FormSkid.cmdSkidAddMat.Visible(True)
Gui.FormSkid.cmdSkidAddMat.Zorder(0)
Gui.FormSkid.cmdSkidAddMat.Size(173,23)
Gui.FormSkid.cmdSkidAddMat.Position(605,100)
Gui.FormSkid.cmdSkidAddMat.Caption("Additional Material")
Gui.FormSkid.cmdSkidAddMat.FontName("Tahoma")
Gui.FormSkid.cmdSkidAddMat.FontSize(8.25)
Gui.FormSkid.cmdSkidAddMat.Parent("frame1")
Gui.FormSkid.cmdSkidAddMat.Event(Click,cmdAddMat_Click)
Gui.FormSkid.frame2.Create(Frame)
Gui.FormSkid.frame2.Enabled(True)
Gui.FormSkid.frame2.Visible(True)
Gui.FormSkid.frame2.Zorder(0)
Gui.FormSkid.frame2.Size(612,105)
Gui.FormSkid.frame2.Position(0,131)
Gui.FormSkid.frame2.Caption("Base Top and Bottom")
Gui.FormSkid.frame2.FontName("Tahoma")
Gui.FormSkid.frame2.FontSize(8.25)
Gui.FormSkid.frame2.BorderStyle(1)
Gui.FormSkid.txtTLen.Create(TextBox,"",True,56,20,0,59,43,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtTLen.Parent("frame2")
Gui.FormSkid.txtTLen.NumericOnly(1)
Gui.FormSkid.txtTLen.Event(GotFocus,txtTLen_GotFocus)
Gui.FormSkid.ddlTMat.Create(DropDownList)
Gui.FormSkid.ddlTMat.Enabled(True)
Gui.FormSkid.ddlTMat.Visible(True)
Gui.FormSkid.ddlTMat.Zorder(0)
Gui.FormSkid.ddlTMat.Size(203,20)
Gui.FormSkid.ddlTMat.Position(83,79)
Gui.FormSkid.ddlTMat.FontName("Tahoma")
Gui.FormSkid.ddlTMat.FontSize(8.25)
Gui.FormSkid.ddlTMat.Parent("frame2")
Gui.FormSkid.ddlTMat.Event(SelectedIndexChanged,ddlTMat_SelectedIndexChanged)
Gui.FormSkid.txtBLen.Create(TextBox,"",True,56,20,0,376,41,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtBLen.NumericOnly(1)
Gui.FormSkid.txtBLen.Parent("frame2")
Gui.FormSkid.txtBLen.Event(GotFocus,txtBLen_GotFocus)
Gui.FormSkid.lbl18.Create(Label,"X",True,6,13,0,436,45,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl18.BorderStyle(0)
Gui.FormSkid.lbl18.Parent("frame2")
Gui.FormSkid.txtBWid.Create(TextBox,"",True,56,20,0,450,41,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtBWid.NumericOnly(1)
Gui.FormSkid.txtBWid.Parent("frame2")
Gui.FormSkid.txtBWid.Event(GotFocus,txtBWid_GotFocus)
Gui.FormSkid.lbl13.Create(Label,"Material",True,38,13,0,311,82,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl13.BorderStyle(0)
Gui.FormSkid.lbl13.Parent("frame2")
Gui.FormSkid.txtTWid.Create(TextBox,"",True,56,20,0,139,43,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtTWid.NumericOnly(1)
Gui.FormSkid.txtTWid.Parent("frame2")
Gui.FormSkid.txtTWid.Event(GotFocus,txtTWid_GotFocus)
Gui.FormSkid.lbl7.Create(Label,"X",True,6,13,0,121,46,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl7.BorderStyle(0)
Gui.FormSkid.lbl7.Parent("frame2")
Gui.FormSkid.lbl10.Create(Label,"Bottom",True,34,13,0,314,44,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl10.BorderStyle(0)
Gui.FormSkid.lbl10.Parent("frame2")
Gui.FormSkid.lbl12.Create(Label,"Qty",True,18,13,0,216,45,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl12.BorderStyle(0)
Gui.FormSkid.lbl12.Parent("frame2")
Gui.FormSkid.lbl14.Create(Label,"Qty",True,18,13,0,514,44,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl14.BorderStyle(0)
Gui.FormSkid.lbl14.Parent("frame2")
Gui.FormSkid.lbl11.Create(Label,"Material",True,38,13,0,15,82,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl11.BorderStyle(0)
Gui.FormSkid.lbl11.Parent("frame2")
Gui.FormSkid.txtTQty.Create(TextBox,"",True,56,20,0,246,42,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtTQty.Parent("frame2")
Gui.FormSkid.txtTQty.NumericOnly(1)
Gui.FormSkid.txtTQty.Event(GotFocus,txtTQty_GotFocus)
Gui.FormSkid.txtBQty.Create(TextBox,"",True,56,20,0,543,42,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtBQty.Parent("frame2")
Gui.FormSkid.txtBQty.NumericOnly(1)
Gui.FormSkid.txtBQty.Event(GotFocus,txtBQty_GotFocus)
Gui.FormSkid.ddlBMat.Create(DropDownList)
Gui.FormSkid.ddlBMat.Enabled(True)
Gui.FormSkid.ddlBMat.Visible(True)
Gui.FormSkid.ddlBMat.Zorder(0)
Gui.FormSkid.ddlBMat.Size(203,20)
Gui.FormSkid.ddlBMat.Position(380,79)
Gui.FormSkid.ddlBMat.FontName("Tahoma")
Gui.FormSkid.ddlBMat.FontSize(8.25)
Gui.FormSkid.ddlBMat.Parent("frame2")
Gui.FormSkid.ddlBMat.Event(SelectedIndexChanged,ddlBMat_SelectedIndexChanged)
Gui.FormSkid.lbl9.Create(Label,"Top",True,18,13,0,7,44,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl9.BorderStyle(0)
Gui.FormSkid.lbl9.Parent("frame2")
Gui.FormSkid.frame3.Create(Frame)
Gui.FormSkid.frame3.Enabled(True)
Gui.FormSkid.frame3.Visible(True)
Gui.FormSkid.frame3.Zorder(0)
Gui.FormSkid.frame3.Size(407,105)
Gui.FormSkid.frame3.Position(615,131)
Gui.FormSkid.frame3.Caption("Base Runners")
Gui.FormSkid.frame3.FontName("Tahoma")
Gui.FormSkid.frame3.FontSize(8.25)
Gui.FormSkid.frame3.BorderStyle(1)
Gui.FormSkid.frame3.Anchor(13)
Gui.FormSkid.txtRLen.Create(TextBox,"",True,56,20,0,84,41,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtRLen.Parent("frame3")
Gui.FormSkid.txtRLen.NumericOnly(1)
Gui.FormSkid.txtRLen.Event(GotFocus,txtRLen_GotFocus)
Gui.FormSkid.txtRQty.Create(TextBox,"",True,56,20,0,276,41,True,0,"Tahoma",8.25,,1)
Gui.FormSkid.txtRQty.Parent("frame3")
Gui.FormSkid.txtRQty.NumericOnly(1)
Gui.FormSkid.txtRQty.Event(GotFocus,txtRQty_GotFocus)
Gui.FormSkid.ddlRMat.Create(DropDownList)
Gui.FormSkid.ddlRMat.Enabled(True)
Gui.FormSkid.ddlRMat.Visible(True)
Gui.FormSkid.ddlRMat.Zorder(0)
Gui.FormSkid.ddlRMat.Size(203,20)
Gui.FormSkid.ddlRMat.Position(81,79)
Gui.FormSkid.ddlRMat.FontName("Tahoma")
Gui.FormSkid.ddlRMat.FontSize(8.25)
Gui.FormSkid.ddlRMat.Parent("frame3")
Gui.FormSkid.lbl16.Create(Label,"Qty",True,18,13,0,242,43,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl16.BorderStyle(0)
Gui.FormSkid.lbl16.Parent("frame3")
Gui.FormSkid.lbl17.Create(Label,"Material",True,38,13,0,13,82,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl17.BorderStyle(0)
Gui.FormSkid.lbl17.Parent("frame3")
Gui.FormSkid.lbl15.Create(Label,"Runners",True,40,13,0,12,44,True,0,"Tahoma",8.25,,0,0)
Gui.FormSkid.lbl15.BorderStyle(0)
Gui.FormSkid.lbl15.Parent("frame3")
Gui.FormSkid.frame5.Create(Frame)
Gui.FormSkid.frame5.Enabled(True)
Gui.FormSkid.frame5.Visible(True)
Gui.FormSkid.frame5.Zorder(0)
Gui.FormSkid.frame5.Size(1022,452)
Gui.FormSkid.frame5.Position(1,237)
Gui.FormSkid.frame5.Caption("Router Sequences")
Gui.FormSkid.frame5.FontName("Tahoma")
Gui.FormSkid.frame5.FontSize(8.25)
Gui.FormSkid.frame5.BorderStyle(1)
Gui.FormSkid.frame5.Anchor(15)
Gui.FormSkid.GsGridSkidRout.Create(GsGridControl)
Gui.FormSkid.GsGridSkidRout.Enabled(True)
Gui.FormSkid.GsGridSkidRout.Visible(True)
Gui.FormSkid.GsGridSkidRout.Zorder(0)
Gui.FormSkid.GsGridSkidRout.Size(1023,299)
Gui.FormSkid.GsGridSkidRout.Position(-3,29)
Gui.FormSkid.GsGridSkidRout.Parent("frame5")
Gui.FormSkid.GsGridSkidRout.Dock(0)
Gui.FormSkid.GsGridSkidRout.Anchor(15)
Gui.FormSkid.cmdSkidCalc.Create(Button)
Gui.FormSkid.cmdSkidCalc.Enabled(True)
Gui.FormSkid.cmdSkidCalc.Visible(True)
Gui.FormSkid.cmdSkidCalc.Zorder(0)
Gui.FormSkid.cmdSkidCalc.Size(48,41)
Gui.FormSkid.cmdSkidCalc.Position(970,48)
Gui.FormSkid.cmdSkidCalc.Caption("")
Gui.FormSkid.cmdSkidCalc.FontName("Tahoma")
Gui.FormSkid.cmdSkidCalc.FontSize(8.25)
Gui.FormSkid.cmdSkidCalc.SvgPicture("icon_go_black")
Gui.FormSkid.cmdSkidCalc.Event(Click,cmdSkidCalc_Click)
Gui.FormMat..Create(BaseForm)
Gui.FormMat..Caption("Form Material")
Gui.FormMat..Size(814,442)
Gui.FormMat..MinX(0)
Gui.FormMat..MinY(0)
Gui.FormMat..Position(0,0)
Gui.FormMat..AlwaysOnTop(False)
Gui.FormMat..FontName("Tahoma")
Gui.FormMat..FontSize(8.25)
Gui.FormMat..ControlBox(True)
Gui.FormMat..MaxButton(True)
Gui.FormMat..MinButton(True)
Gui.FormMat..MousePointer(0)
Gui.FormMat..Moveable(True)
Gui.FormMat..Sizeable(True)
Gui.FormMat..ShowInTaskBar(True)
Gui.FormMat..TitleBar(True)
Gui.FormMat..Event(UnLoad,FormMat_UnLoad)
Gui.FormMat.GsGridMat.Create(GsGridControl)
Gui.FormMat.GsGridMat.Enabled(True)
Gui.FormMat.GsGridMat.Visible(True)
Gui.FormMat.GsGridMat.Zorder(0)
Gui.FormMat.GsGridMat.Size(805,367)
Gui.FormMat.GsGridMat.Position(7,13)
Gui.FormMat.GsGridMat.Anchor(15)
Gui.FormMat.GsGridMat.Event(RowCellClick,GsGridMat_RowCellClick)
Gui.FormMat.cmdExit.Create(Button)
Gui.FormMat.cmdExit.Enabled(True)
Gui.FormMat.cmdExit.Visible(True)
Gui.FormMat.cmdExit.Zorder(0)
Gui.FormMat.cmdExit.Size(75,23)
Gui.FormMat.cmdExit.Position(16,386)
Gui.FormMat.cmdExit.Caption("Exit")
Gui.FormMat.cmdExit.FontName("Tahoma")
Gui.FormMat.cmdExit.FontSize(8.25)
Gui.FormMat.cmdExit.Anchor(6)
Gui.FormMat.cmdExit.Event(Click,cmdExit_Click)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Program.External.Include.Library("6021.lib")
Program.External.Include.Library("1500.Lib")
Program.External.Include.Library("400000.lib")
V.Global.lOp.Declare(Long,0)
V.Global.sSelection.Declare(String,"")
V.Global.sSort.Declare(String,"")
V.Global.bSplice.Declare(Boolean,False)
V.Global.bRL.Declare(Boolean,False)
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sCaption.Declare(String,"")
V.Local.sCustName.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.sPart.Declare(String,"")

Function.Intrinsic.UI.UsePixels ' Allows you to use Pixels instead of Twips throughout

F.Intrinsic.Control.SelectCase(V.Caller.Hook)
	
'	F.Intrinsic.Control.Case(10260)
'	'quote line screen	
'		V.Passed.000201.Set("Crate CALC")
'		V.Passed.000202.Set("Cost Buildup")
		
	F.Intrinsic.Control.Case(10670)
		'Part number Passed Variable - 000052
		'Rev passed variable - 000053
		'Quantity Passed Variable - 000007
		'Price Passed Variable - 000009
		'Cost Passed Variable - 000012	
		'Customer Passed Variable - 000112
		'Description Passed Variable - 000056
		'UM Passed Variable - 000006
		'PL Passed Variable - 000013
		'Quote Passed Variable - 000060
		'Line Passed Variable - 000051
		v.Local.sSql.Set(v.Passed.000052.Trim)
		f.Intrinsic.Control.If(V.Local.sSql.Trim,<>,"")
			F.Intrinsic.String.Build("There's already a Part created for the Line {0}. Do you want to reconfigure the Part?",V.Passed.000051,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Reconfig Part",4,V.Local.iRet)
			F.Intrinsic.Control.If(V.Local.iRet,=,7)
				F.Intrinsic.Control.End
			F.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
		
		Gui.FormCrateSel..Show
		Gui.FormCrateSel..AlwaysOnTop(True)
		Gui.FormCrateSel..AlwaysOnTop(False)
		Gui.FormCrateSel..WaitForDismiss
		
		F.Global.General.ReadOption("401113",3,"","0000",V.Global.lOp)
		
		F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
			F.Intrinsic.Control.CallSub(Get_Data)
			F.Intrinsic.Control.CallSub(Set_Prop)

			F.ODBC.Connection!Con.OpenCompanyConnection
			
			F.Data.DataTable.CreateFromSQL("PartDesc",con,"Select rtrim(Part) as Part, Description From V_Inventory_Mstr",True)
			
			F.Intrinsic.String.Build("Select rtrim(name_customer) From V_Customer_Master Where Customer = '{0}'",V.Passed.000112,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(v.Local.sSql,V.Local.sCustName)
			F.ODBC.Connection!con.Close
			
			F.Intrinsic.String.Build("REGULAR CRATES  |  CUSTOMER: {0}",V.Local.sCustName.UCase,V.Local.sCaption)
			Gui.FormRegCrate..Caption(V.Local.sCaption)
			
			Gui.FormRegCrate..show
			Gui.FormRegCrate..AlwaysOnTop(True)
			Gui.FormRegCrate..AlwaysOnTop(False)
			Gui.FormRegCrate.ddlSide1.Text("Horizontal")
			Gui.FormRegCrate.ddlSide2.Text("Horizontal")
			Gui.FormRegCrate.ddlTop.Text("Long Length")
'			Gui.FormRegCrate..WaitForDismiss
			
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Global.sSelection,=,"SHELL")
				F.Intrinsic.Control.CallSub(Get_Data_Shell)
				F.Intrinsic.Control.CallSub(Set_Prop_Shell)

				F.ODBC.Connection!Con.OpenCompanyConnection
				
				F.Data.DataTable.CreateFromSQL("PartDesc",con,"Select rtrim(Part) as Part, Description From V_Inventory_Mstr",True)
				
				F.Intrinsic.String.Build("Select rtrim(name_customer) From V_Customer_Master Where Customer = '{0}'",V.Passed.000112,V.Local.sSql)
				F.ODBC.Connection!Con.ExecuteAndReturn(v.Local.sSql,V.Local.sCustName)
				F.ODBC.Connection!con.Close
			
				F.Intrinsic.String.Build("SHELL CRATES  |  CUSTOMER: {0}",V.Local.sCustName.UCase,V.Local.sCaption)
				Gui.FormShell..Caption(V.Local.sCaption)
			
				Gui.FormShell..show
				Gui.FormShell..AlwaysOnTop(True)
				Gui.FormShell..AlwaysOnTop(False)
'				Gui.FormShell..WaitForDismiss
				
			F.Intrinsic.Control.Else
				F.Intrinsic.Control.If(V.Global.sSelection,=,"SKID")
					F.Intrinsic.Control.CallSub(Get_Skid_Data)
					F.Intrinsic.Control.CallSub(Set_Prop_Skid)

					F.ODBC.Connection!Con.OpenCompanyConnection
					
					F.Data.DataTable.CreateFromSQL("PartDesc",con,"Select rtrim(Part) as Part, Description From V_Inventory_Mstr",True)
					
					F.Intrinsic.String.Build("Select rtrim(name_customer) From V_Customer_Master Where Customer = '{0}'",V.Passed.000112,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(v.Local.sSql,V.Local.sCustName)
					F.ODBC.Connection!con.Close
				
					F.Intrinsic.String.Build("SKID/PALLET  |  CUSTOMER: {0}",V.Local.sCustName.UCase,V.Local.sCaption)
					Gui.FormSkid..Caption(V.Local.sCaption)
				
					Gui.FormSkid..Show
					Gui.FormSkid..AlwaysOnTop(True)
					Gui.FormSkid..AlwaysOnTop(False)
'					Gui.FormSkid..WaitForDismiss
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.End
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
'	F.Intrinsic.Control.Case(10680)
'		F.Intrinsic.UI.InvokeWaitDialog("Router Cost Buildup...................")
'		F.Intrinsic.Control.If(V.Passed.000053.Trim,<>,"")
'			F.Intrinsic.String.RPad(V.Passed.000052," ",17,V.Local.sPart)
'			F.Intrinsic.String.Build("{0}{1}",V.Local.sPart,V.Passed.000053.Trim,V.Local.sPart)
'		F.Intrinsic.Control.Else
'			V.Local.sPart.Set(V.Passed.000052)
'		F.Intrinsic.Control.EndIf
'		
'		F.Data.DataTable.AddRow("1500","ROUTER",V.Local.sPart.Trim,"Quantity",1)
'		F.Intrinsic.Control.CallSub(1500sync)

'		F.Intrinsic.Control.CallSub(Get_Cost)
'		F.Intrinsic.UI.CloseWaitDialog
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Main.End

Program.Sub.Get_Data.Start
F.Intrinsic.Control.SetErrorHandler("Get_Data_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
v.Local.fCP.Declare(Float,0)
V.Local.fSqft.Declare(Float,0)

F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
	F.Data.Datatable.DeleteRow("dtRouter")
	F.Data.Datatable.AcceptChanges("dtRouter")
	V.Local.sRouter.Set(V.Screen.FormRegCrate!txtTemplate.Text)
	F.Intrinsic.Control.If(V.Local.sRouter.Left2,=,"RL")
		V.Global.bSplice.Set(False)
		V.Global.bRL.Set(True)
	F.Intrinsic.Control.Else
		V.Global.bSplice.Set(True)
		V.Global.bRL.Set(False)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Build("Select * From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RHeader.Exists)
		F.Data.Datatable.Close("RHeader")
	F.Intrinsic.Control.EndIf
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Data.Datatable.CreateFromSQL("RHeader","Con",V.Local.sSql,True)
	F.Intrinsic.String.Build("Select * From V_Router_Line Where Router = '{0}' Order by Line_Router",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RLine.Exists)
		F.Data.Datatable.Close("RLine")
	F.Intrinsic.Control.EndIf
	F.Data.Datatable.CreateFromSQL("RLine","Con",V.Local.sSql,True)
	F.Data.Datatable.AddColumn("RLine","Length",Float)
	F.Data.Datatable.AddColumn("RLine","Width",Float)
	F.Data.Dictionary.CreateFromSQL("Len","Con","Select Part, Length From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Len","0")
	F.Data.Datatable.FillFromDictionary("RLine","Len","Part_WC_Outside","Length")
	F.Data.Dictionary.Close("Len")
	F.Data.Dictionary.CreateFromSQL("Wid","Con","Select Part, Width From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Wid","0")
	F.Data.Datatable.FillFromDictionary("RLine","Wid","Part_WC_Outside","Width")
	F.Data.Dictionary.Close("Wid")
	F.Intrinsic.String.Build("Select * From GCG_6761_CRATE_MAINT Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.CrateCalc.Exists)
		F.Data.Datatable.Close("CrateCalc")
	F.Intrinsic.Control.EndIf

	F.Data.Datatable.CreateFromSQL("CrateCalc","Con",V.Local.sSql,True)
	F.ODBC.Connection!Con.Close
	F.Data.DataView.Create("CrateCalc","Temp",22,"OpCode = 'BASE B'","")
	F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
		Gui.FormRegCrate.txtBaseQty.Visible(True)
		Gui.FormRegCrate.lblBaseB.Visible(True)
		V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldVal)
		F.Intrinsic.Control.If(V.Local.sEval.IsNumeric)
			Gui.FormRegCrate.txtBaseQty.Text(V.Local.sEval.Float)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
				F.Data.DataView.Create("RLine","Temp",22,"Operation = 'BASE B' and LMO = 'M'","")
				F.Intrinsic.Control.If(V.DataView.RLine!Temp.RowCount--,<>,-1)
					F.Intrinsic.Math.Mult(V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Length!FieldvalFloat,V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Width!FieldvalFloat,V.Local.fSqft)
					F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Length!FieldvalFloat,V.Local.sEval)
					F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Width!FieldvalFloat,V.Local.sEval)
					F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
					F.Intrinsic.Control.Try
						F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
						F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fCP)
						Gui.FormRegCrate.txtBaseQty.Text(V.Local.fCP)
					F.Intrinsic.Control.Catch
						Gui.FormRegCrate.txtBaseQty.Text("0")
					F.Intrinsic.Control.EndTry
				F.Intrinsic.Control.Else
					Gui.FormRegCrate.txtBaseQty.Text("0")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Else
				Gui.FormRegCrate.txtBaseQty.Text("0")
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Close("RLine","Temp")
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		Gui.FormRegCrate.txtBaseQty.Visible(False)
		Gui.FormRegCrate.lblBaseB.Visible(False)
		Gui.FormRegCrate.txtBaseQty.Text("0")
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("CrateCalc","Temp")
	F.Data.DataView.Create("CrateCalc","Temp",22,"OpCode = 'BASE R'","")
	F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
		Gui.FormRegCrate.txtBaseRQty.Visible(True)
		Gui.FormRegCrate.lblBaseR.Visible(True)
		V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldVal)
		F.Intrinsic.Control.If(V.Local.sEval.IsNumeric)
			Gui.FormRegCrate.txtBaseRQty.Text(V.Local.sEval.Float)
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
				F.Data.DataView.Create("RLine","Temp",22,"Operation = 'BASE R' and LMO = 'M'","")
				F.Intrinsic.Control.If(V.DataView.RLine!Temp.RowCount--,<>,-1)
					F.Intrinsic.Math.Mult(V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Length!FieldvalFloat,V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Width!FieldvalFloat,V.Local.fSqft)
					F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Length!FieldvalFloat,V.Local.sEval)
					F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.DataView.RLine!Temp(V.DataView.RLine!Temp.RowCount--).Width!FieldvalFloat,V.Local.sEval)
					F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
					F.Intrinsic.Control.Try
						F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
						F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fCP)
						Gui.FormRegCrate.txtBaseRQty.Text(V.Local.fCP)
					F.Intrinsic.Control.Catch
						Gui.FormRegCrate.txtBaseRQty.Text("0")
					F.Intrinsic.Control.EndTry
				F.Intrinsic.Control.Else
					Gui.FormRegCrate.txtBaseRQty.Text("0")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("RLine","Temp")
			F.Intrinsic.Control.Else
				Gui.FormRegCrate.txtBaseRQty.Text("0")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		Gui.FormRegCrate.txtBaseRQty.Visible(False)
		Gui.FormRegCrate.lblBaseR.Visible(False)
		Gui.FormRegCrate.txtBaseRQty.Text("0")
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("CrateCalc","Temp")
F.Intrinsic.Control.Else
	f.Data.DataTable.Create("dtRouter",True)
	f.Data.DataTable.AddColumn("dtRouter","Router","string")
	f.Data.DataTable.AddColumn("dtRouter","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouter","LMO","string")
	f.Data.DataTable.AddColumn("dtRouter","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouter","Operation","string")
	f.Data.DataTable.AddColumn("dtRouter","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouter","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouter","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouter","Rate","float")
	f.Data.DataTable.AddColumn("dtRouter","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouter","Cuts","string")
	
	f.Data.DataTable.Create("dtRouterTemp",True)
	f.Data.DataTable.AddColumn("dtRouterTemp","Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","LMO","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Operation","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Rate","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Cuts","string")
	
	f.Data.DataTable.Create("TempCuts",True)
	f.Data.DataTable.AddColumn("TempCuts","Line_Router","string")
	f.Data.DataTable.AddColumn("TempCuts","Operation","string")
	f.Data.DataTable.AddColumn("TempCuts","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("TempCuts","Run_Time","float")
	
	Gui.FormRegCrate.ddlSide1.AddItem("Horizontal",0)
	Gui.FormRegCrate.ddlSide1.AddItem("Vertical",1)
	
	Gui.FormRegCrate.ddlSide2.AddItem("Horizontal",0)
	Gui.FormRegCrate.ddlSide2.AddItem("Vertical",1)
	
	Gui.FormRegCrate.ddlTop.AddItem("Long Length",0)
	Gui.FormRegCrate.ddlTop.AddItem("Short Length",1)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Data_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Data.End

Program.Sub.Set_Prop.Start
F.Intrinsic.Control.SetErrorHandler("Set_Prop_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtTemplate.TabIndex(0)
Gui.FormRegCrate.cmdTemplate.TabIndex(1)
Gui.FormRegCrate.cmdTemplate.TabStop(False)
Gui.FormRegCrate.txtDesc.TabIndex(2)
Gui.FormRegCrate.txtLength.TabIndex(3)
Gui.FormRegCrate.txtWidth.TabIndex(4)
Gui.FormRegCrate.txtHeight.TabIndex(5)
Gui.FormRegCrate.chkTop.TabIndex(6)
Gui.FormRegCrate.txtBaseQty.TabIndex(7)
Gui.FormRegCrate.txtBaseRQty.TabIndex(8)
Gui.FormRegCrate.txtExtraDesc.TabIndex(9)
Gui.FormRegCrate.ddlSide1.TabIndex(10)
Gui.FormRegCrate.ddlSide2.TabIndex(11)
Gui.FormRegCrate.ddlTop.TabIndex(12)
Gui.FormRegCrate.cmdCalc.TabIndex(13)

gui.FormRegCrate.GsGridRouter.AddGridviewFromDatatable("gvRouter","dtRouter")

gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ShowGroupPanel,True)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowAddRows,False)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)
gui.FormRegCrate.GsGridRouter.SetGridviewProperty("gvRouter",V.Enum.GridViewPropertyNames!AllowSort,False)

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",v.Enum.ColumnPropertyNames!Caption,"Router")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",v.Enum.ColumnPropertyNames!Caption,"Seq")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",v.Enum.ColumnPropertyNames!Caption,"Type")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",v.Enum.ColumnPropertyNames!Caption,"Part / Workcenter")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",v.Enum.ColumnPropertyNames!Caption,"Op Code")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",v.Enum.ColumnPropertyNames!Caption,"Setup")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Width,"30")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",v.Enum.ColumnPropertyNames!Caption,"Material Requirements")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",v.Enum.ColumnPropertyNames!Caption,"Unit")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Width,"10")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",v.Enum.ColumnPropertyNames!Caption,"Rate")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Width,"30")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"c2")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",v.Enum.ColumnPropertyNames!Caption,"Description")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",v.Enum.ColumnPropertyNames!Caption,"Cuts")
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormRegCrate.GsGridRouter.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!CellWordWrap,"Wrap")

gui.FormRegCrate.GsGridRouter.MainView("gvRouter")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Set_Prop_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Set_Prop.End

Program.Sub.cmdCalc_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdCalc_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.sTemp2.Declare(String,"")
V.Local.iTemp.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sStart.Declare(String,"")
V.Local.fSetUp.Declare(Float,0)
V.Local.fRunTime.Declare(Float,0)
V.Local.fRate.Declare(Float,0)
V.Local.sFilter.Declare(String,"")
V.Local.sCuts.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sQuote.Declare(String,"")
V.Local.sLine.Declare(String,"")
V.Local.sRate.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.iCuts.Declare(Long,0)
V.Local.bSheet.Declare(Boolean,False)
V.Local.fLen.Declare(Float,0)
V.Local.fWid.Declare(Float,0)
V.Local.fRem.Declare(Float,0)
V.Local.fTemp.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.iID.Declare(Long,0)
V.Local.iNID.Declare(Long,0)
V.Local.fCurrentSheetRunTime.Declare(Float,0)
V.Local.sUM.Declare(String,"")
V.Local.sDesc.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtTemplate.Text,=,"")
	V.Local.sMsg.Set("Select a Template Router")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtLength.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Length Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Length Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtWidth.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Width Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Width Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormRegCrate!txtHeight.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Height Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Height Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Sort_2 From V_Router_Header Where Router = '{0}'",V.Screen.FormRegCrate!txtTemplate.Text,V.Local.sStart)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sStart,V.Local.sStart)
V.Global.sSort.Set(V.Local.sStart.Trim)
F.ODBC.Connection!Con.Close
F.Intrinsic.String.LPad(V.Passed.000060,"0",6,V.Local.sQuote)
F.Intrinsic.String.LPad(V.Passed.000051,"0",3,V.Local.sLine)

F.Intrinsic.String.Build("{0}{1}{2}{3}",V.Passed.000112,V.Global.sSort,V.Local.sQuote,V.Local.sLine,V.Local.sRouter)

V.Local.sDesc.Set(V.Screen.FormRegCrate!txtDesc.Text)
F.Intrinsic.Control.If(V.Local.sDesc.Trim,=,"")
	F.Intrinsic.String.Build("Crate: {0}x{1}x{2}",V.Screen.FormRegCrate!txtLength.Text,V.Screen.FormRegCrate!txtWidth.Text,V.Screen.FormRegCrate!txtHeight.Text,V.Local.sDesc)
	Gui.FormRegCrate.txtDesc.Text(V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("{0}-{1} Crate: {2}x{3}x{4}",V.Passed.000112.Trim,V.Screen.FormRegCrate!txtTemplate.Text,V.Screen.FormRegCrate!txtLength.Text,V.Screen.FormRegCrate!txtWidth.Text,V.Screen.FormRegCrate!txtHeight.Text,V.Local.sDesc)

Gui.FormRegCrate.txtExtraDesc.Text(V.Local.sDesc)

F.Data.DataTable.DeleteRow("dtRouterTemp")
F.Data.DataTable.AcceptChanges("dtRouterTemp")

F.Data.DataTable.DeleteRow("TempCuts")
F.Data.DataTable.AcceptChanges("TempCuts")

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("RLine","MLine",22,"LMO = 'M'","Line_Router")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.RLine!MLine.RowCount--,1)
	F.Intrinsic.String.Build("Line_Router = '{0}'",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldValTrim,V.Local.sFilter)
	F.Data.DataView.Create("CrateCalc","Temp",22,V.Local.sFilter,"")
	F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
		V.Local.fRate.Set(V.DataView.RLine!MLine(V.Local.i).Rate!FieldVal)
		V.Local.fSetUp.Set(V.DataView.RLine!MLine(V.Local.i).Set_Up!FieldVal)
		F.Intrinsic.Control.CallSub(Get_RunTime,"Index",V.Local.i)
		V.Local.fRunTime.Set(V.Args.RunTime)
		V.Local.sCuts.Set(V.Args.Cuts)
	F.Intrinsic.Control.Else
		V.Local.fRate.Set(V.DataView.RLine!MLine(V.Local.i).Rate!FieldVal)
		V.Local.fRunTime.Set(V.DataView.RLine!MLine(V.Local.i).Run_Time!FieldVal)
		V.Local.fSetUp.Set(V.DataView.RLine!MLine(V.Local.i).Set_Up!FieldVal)
		V.Local.sCuts.Set("")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.RLine!MLine(V.Local.i).Part_WC_Outside!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
	F.Intrinsic.Control.If(V.Local.sRate.Trim,<>,"")
		V.Local.fRate.Set(V.Local.sRate.Float)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataView.RLine!MLine(V.Local.i).UM_Inventory!FieldValTrim,<>,"SH","AND",V.DataView.RLine!MLine(V.Local.i).Operation!FieldValTrim,=,"TOP")
		F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1)
			F.Data.Datatable.AddRow("TempCuts","Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"Part_WC_Outside",V.DataView.RLine!MLine(V.Local.i).Part_WC_Outside!FieldVal,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Run_Time",V.Local.fRunTime)
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"LMO",V.DataView.RLine!MLine(V.Local.i).LMO!FieldVal,"Part_WC_Outside",V.DataView.RLine!MLine(V.Local.i).Part_WC_Outside!FieldVal,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Set_Up",V.Local.fSetUp,"Run_Time",V.Local.fRunTime,"UM_Inventory",V.DataView.RLine!MLine(V.Local.i).UM_Inventory!FieldVal,"Rate",V.Local.fRate,"Desc_Rt_Line",V.DataView.RLine!MLine(V.Local.i).Desc_Rt_Line!FieldVal,"Cuts",V.Local.sCuts)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Data.Datatable.AddRow("TempCuts","Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"Part_WC_Outside",V.DataView.RLine!MLine(V.Local.i).Part_WC_Outside!FieldVal,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Run_Time",V.Local.fRunTime)
		F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"LMO",V.DataView.RLine!MLine(V.Local.i).LMO!FieldVal,"Part_WC_Outside",V.DataView.RLine!MLine(V.Local.i).Part_WC_Outside!FieldVal,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Set_Up",V.Local.fSetUp,"Run_Time",V.Local.fRunTime,"UM_Inventory",V.DataView.RLine!MLine(V.Local.i).UM_Inventory!FieldVal,"Rate",V.Local.fRate,"Desc_Rt_Line",V.DataView.RLine!MLine(V.Local.i).Desc_Rt_Line!FieldVal,"Cuts",V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	F.Data.DataView.Close("CrateCalc","Temp")
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataTable.DeleteRow("dtRouter")
F.Data.DataTable.AcceptChanges("dtRouter")

'updating Marterial after all cuts have been figured out.
F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtRouterTemp.RowCount--,1)
'	V.Local.fRunTime.Set(V.DataTable.dtRouterTemp(V.Local.i).Run_Time!FieldValFloat)
'	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
'	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
'		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.EndIf
'	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
	V.Local.fRunTime.Set(0)

	F.Intrinsic.String.Build("Select Top 1 Length, Width From V_Inventory_Mst2 Where Part = '{0}'",V.DataTable.dtRouterTemp(V.Local.i).Part_WC_Outside!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sTemp)
	F.Intrinsic.String.Split(V.Local.sTemp,"*!*",V.Local.sTemp)
	V.Local.fLen.Set(V.Local.sTemp.Float)
	V.Local.fWid.Set(V.Local.sTemp(1).Float)
	F.Intrinsic.String.IsInString(V.DataTable.dtRouterTemp(V.Local.i).Cuts!FieldValTrim,"X",True,V.Local.bSheet)
	F.Intrinsic.String.Split(V.DataTable.dtRouterTemp(V.Local.i).Cuts!FieldValTrim,"|",V.Local.sCuts)
	F.Intrinsic.Control.If(V.Local.bSheet)
		F.Data.DataTable.Create("Sheet",True)
		F.Data.DataTable.AddColumn("Sheet","Len",Float)
		F.Data.DataTable.AddColumn("Sheet","Wid",Float)
		F.Data.DataTable.AddColumn("Sheet","Used",Boolean,False)

		F.Intrinsic.Control.If(V.DataTable.dtRouterTemp(V.Local.i).Operation!FieldValTrim,=,"SIDE 1","AND",V.Screen.FormRegCrate!ddlSide1.Text,=,"Vertical")
			V.Local.fTemp.Set(V.Local.fWid)
			V.Local.fWid.Set(V.Local.fLen)
			V.Local.fLen.Set(v.Local.fTemp)
		F.Intrinsic.Control.ElseIf(V.DataTable.dtRouterTemp(V.Local.i).Operation!FieldValTrim,=,"SIDE 2","AND",V.Screen.FormRegCrate!ddlSide2.Text,=,"Vertical")
			V.Local.fTemp.Set(V.Local.fWid)
			V.Local.fWid.Set(V.Local.fLen)
			V.Local.fLen.Set(v.Local.fTemp)
		F.Intrinsic.Control.ElseIf(V.DataTable.dtRouterTemp(V.Local.i).Operation!FieldValTrim,=,"TOP","AND",V.Screen.FormRegCrate!ddlTop.Text,=,"Short Length")
			V.Local.fTemp.Set(V.Local.fWid)
			V.Local.fWid.Set(V.Local.fLen)
			V.Local.fLen.Set(v.Local.fTemp)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.For(V.Local.iTemp,0,V.Local.sCuts.UBound,1)
			F.Intrinsic.String.Split(V.Local.sCuts(V.Local.iTemp),":",V.Local.sTemp)
			F.Intrinsic.String.Split(V.Local.sTemp(1).UCase,"X",V.Local.sTemp2)
			F.Intrinsic.Control.For(V.Local.iCuts,1,V.Local.sTemp.Long,1)
				F.Data.DataTable.AddRow("Sheet","Len",V.Local.sTemp2,"Wid",V.Local.sTemp2(1))
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Next(V.Local.iTemp)

		F.Data.DataView.Create("Sheet","VSheet",22,"Used = False","Len,Wid")
		F.Intrinsic.Control.DoUntil(V.DataView.Sheet!VSheet.RowCount--,=,-1)
			F.Data.DataTable.Create("Drop",True)
			F.Data.DataTable.AddColumn("Drop","Len",Float)
			F.Data.DataTable.AddColumn("Drop","Wid",Float)
			F.Data.DataTable.AddColumn("Drop","ID",Long)
			F.Data.DataTable.AddRow("Drop","Len",V.Local.fLen,"Wid",V.Local.fWid,"ID",1)
			V.Local.fCurrentSheetRunTime.Set(0)
			F.Intrinsic.Control.For(V.Local.iCuts,V.DataView.Sheet!VSheet.RowCount--,0,-1)
				F.Intrinsic.Control.If(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,>=,V.Local.fLen,"AND",V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,>=,V.Local.fWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Data.DataView.SetValue("Sheet","VSheet",V.Local.iCuts,"Used",True)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Len >= {0} and Wid >= {1}",V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.sFilter)
					F.Data.DataView.Create("Drop","VDrop",22,V.Local.sFilter,"Len,Wid")
					F.Intrinsic.Control.If(V.DataView.Drop!VDrop.RowCount--,<>,-1)
						V.Local.iID.Set(V.DataView.Drop!VDrop(0).ID!FieldValLong)
						F.Intrinsic.Control.If(V.DataView.Drop!VDrop(0).Len!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,"AND",V.DataView.Drop!VDrop(0).Wid!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							V.Local.sTemp.Redim(0,3)
							V.Local.sTemp2.Redim(0,3)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Wid!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp2)
							V.Local.sTemp.Set(V.Local.fTemp)
							V.Local.sTemp(1).Set(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal)
							V.Local.sTemp(2).Set(V.Local.fTemp)
							V.Local.sTemp(3).Set(V.DataView.Drop!VDrop(0).Len!FieldVal)
							V.Local.sTemp2.Set(V.DataView.Drop!VDrop(0).Wid!FieldVal)
							V.Local.sTemp2(1).Set(V.Local.fTemp2)
							V.Local.sTemp2(2).Set(V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							V.Local.sTemp2(3).Set(V.Local.fTemp2)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(0),"Wid",V.Local.sTemp2(0))
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(1),"Wid",V.Local.sTemp2(1))
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(2),"Wid",V.Local.sTemp2(2))
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(3),"Wid",V.Local.sTemp2(3))
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.ElseIf(V.DataView.Drop!VDrop(0).Len!FieldVal,=,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,"AND",V.DataView.Drop!VDrop(0).Wid!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Wid!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp2)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.DataView.Drop!VDrop(0).Len!FieldVal,"Wid",V.Local.fTemp2)
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.fTemp,"Wid",V.DataView.Drop!VDrop(0).Wid!FieldVal)
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Mult(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp)
						F.Intrinsic.Math.Add(V.Local.fCurrentSheetRunTime,V.Local.fTemp,V.Local.fCurrentSheetRunTime)
						F.Data.DataView.SetValue("Sheet","VSheet",V.Local.iCuts,"Used",True)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("Drop","VDrop")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.iCuts,=,0)
					F.Intrinsic.Control.If(V.DataView.Sheet!VSheet.RowCount--,=,-1)
						F.Intrinsic.Math.Mult(V.Local.fLen,V.Local.fWid,V.Local.fTemp)
						F.Intrinsic.Math.Div(V.Local.fCurrentSheetRunTime,V.Local.fTemp,V.Local.fTemp)
						F.Intrinsic.Control.If(V.Local.fTemp,>,.75)
							F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
						F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.50)
							F.Intrinsic.Math.Add(V.Local.fRunTime,.75,V.Local.fRunTime)
						F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.25)
							F.Intrinsic.Math.Add(V.Local.fRunTime,.50,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.Local.fRunTime,.25,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCuts)
			
			F.Data.DataTable.Close("Drop")
		F.Intrinsic.Control.Loop
		F.Data.DataView.Close("Sheet","VSheet")
		F.Data.DataTable.Close("Sheet")
	F.Intrinsic.Control.Else
		F.Data.DataTable.Create("Stick",True)
		F.Data.DataTable.AddColumn("Stick","Len",Float)
		F.Data.DataTable.AddColumn("Stick","Used",Boolean,False)
		F.Intrinsic.Control.For(V.Local.iTemp,0,V.Local.sCuts.UBound,1)
			F.Intrinsic.String.Split(V.Local.sCuts(V.Local.iTemp),":",V.Local.sTemp)
			F.Intrinsic.Control.For(V.Local.iCuts,1,V.Local.sTemp.Long,1)
				F.Data.DataTable.AddRow("Stick","Len",V.Local.sTemp(1))
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Next(V.Local.iTemp)

		F.Data.DataView.Create("Stick","VStick",22,"Used = False","Len")
		F.Intrinsic.Control.DoUntil(V.DataView.Stick!VStick.RowCount--,=,-1)
			V.Local.fRem.Set(V.Local.fLen)
			F.Intrinsic.Control.For(V.Local.iCuts,V.DataView.Stick!VStick.RowCount--,0,-1)
				F.Intrinsic.Control.If(V.DataView.Stick!VStick(V.Local.iCuts).Len!FieldVal,>=,V.Local.fLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Data.DataView.SetValue("Stick","VStick",V.Local.iCuts,"Used",True)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Sub(V.Local.fRem,V.DataView.Stick!VStick(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
					F.Intrinsic.Control.If(V.Local.fTemp,>,0)
						V.Local.fRem.Set(V.Local.fTemp)
						F.Intrinsic.Control.If(V.DataView.Stick!VStick.RowCount--,=,0)
							F.Intrinsic.Math.Sub(V.Local.fLen,V.Local.fRem,V.Local.fTemp)
							F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fLen,V.Local.fTemp)
							F.Intrinsic.Control.If(V.Local.fTemp,>,.75)
								F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
							F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.50)
								F.Intrinsic.Math.Add(V.Local.fRunTime,.75,V.Local.fRunTime)
							F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.25)
								F.Intrinsic.Math.Add(V.Local.fRunTime,.50,V.Local.fRunTime)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Add(V.Local.fRunTime,.25,V.Local.fRunTime)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Data.DataView.SetValue("Stick","VStick",V.Local.iCuts,"Used",True)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.Local.iCuts,=,0)
							F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Loop
		F.Data.DataView.Close("Stick","VStick")
		F.Data.DataTable.Close("Stick")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.If(V.DataTable.Bolt.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Bolt.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("Bolt - {0}",V.DataTable.Bolt(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.Bolt(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.Bolt(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.Bolt(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Brace.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Brace.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("Brace - {0}",V.DataTable.Brace(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.Brace(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.Brace(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.Brace(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.AddMat.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.AddMat.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("AddMat - {0}",V.DataTable.AddMat(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.AddMat(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.AddMat(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.AddMat(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

'F.Data.DataView.Create("TempCuts","Temp",22,"","")
'F.Data.DataView.ToDataTableDistinct("TempCuts","Temp","Mat","Part_WC_Outside",True)
'F.Data.DataView.Close("TempCuts","Temp")
'F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Mat.RowCount--,1)
'	F.Intrinsic.Math.Add(1000000,V.Local.i,V.Local.iTemp)
'	F.Intrinsic.String.Build("Part_WC_Outside = '{0}'",V.DataTable.Mat(V.Local.i).Part_WC_Outside!FieldValTrim,V.Local.sFilter)
'	F.Data.DataView.Create("TempCuts","Temp",22,V.Local.sFilter,"")
'	F.Data.DataView.ToDataTable("TempCuts","Temp","SumRun",True)
'	F.Data.Datatable.AddExpressionColumn("SumRun","sumruntime",Float,"Sum(Run_Time)")
'	F.Data.DataView.Close("TempCuts","Temp")
'	V.Local.fRunTime.Set(V.DataTable.SumRun(V.DataTable.SumRun.RowCount--).SumRunTime!FieldValFloat)
'	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
'	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
'		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.EndIf
'	F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.iTemp,"LMO","Material Sum","Part_WC_Outside",V.DataTable.Mat(V.Local.i).Part_WC_Outside!FieldValTrim,"Run_Time",V.Local.fRunTime)
'	F.Data.Datatable.Close("SumRun")
'F.Intrinsic.Control.Next(V.Local.i)

'F.Data.Datatable.Close("Mat")

F.Data.DataTable.Merge("dtRouterTemp","dtRouter",4,2)

F.Data.DataView.Close("RLine","MLine")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdCalc_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdCalc_Click.End

Program.Sub.cmdTemplate_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdTemplate_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.ODBC.Connection!Con.OpenCompanyConnection

V.Local.sSql.Set("Select rtrim(Router), rtrim(Description_Router) From V_Router_Header Where ltrim(rtrim(ucase(Sort_1))) = 'TEMPLATE' Order by Router")

V.Local.sTitles.Set("Router*!*Description")
V.Local.sWidths.Set("1800*!*2400")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.Intrinsic.UI.Browser("Select Template","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormRegCrate.txtTemplate.Text(V.Local.sRet.UCase)
'	Gui.FormRegCrate.txtDesc.Text(V.Local.sRet.UCase)
	F.Intrinsic.Control.CallSub(Get_Data)
F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdTemplate_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdTemplate_Click.End

Program.Sub.txtTemplate_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTemplate_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sSql.Declare(String,"")

Gui.FormRegCrate.txtTemplate.Enabled(True)

V.Local.sRouter.Set(V.Screen.FormRegCrate!txtTemplate.Text)
F.Intrinsic.Control.If(V.Local.sRouter.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
F.ODBC.Connection!Conx.OpenCompanyConnection
F.ODBC.Connection!Conx.ExecuteAndReturn(V.Local.sSql,V.Local.sRouter)
F.ODBC.Connection!Conx.Close
F.Intrinsic.Control.If(V.Local.sRouter.Trim,<>,"")
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(Get_Data)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Template Router Not Found.....","Attention")
	Gui.FormRegCrate.txtTemplate.SetFocus
	Gui.FormRegCrate.txtTemplate.SelectAll
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTemplate_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTemplate_LostFocus.End

Program.Sub.txtTemplate_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTemplate_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtTemplate.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTemplate_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTemplate_GotFocus.End

Program.Sub.txtLength_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtLength_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtLength.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtLength_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtLength_GotFocus.End

Program.Sub.txtWidth_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtWidth_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtWidth.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtWidth_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtWidth_GotFocus.End

Program.Sub.txtHeight_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtHeight_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtHeight.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtHeight_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtHeight_GotFocus.End

Program.Sub.FormRegCrate_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormRegCrate_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormRegCrate_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.FormRegCrate_UnLoad.End

Program.Sub.FormRegCrate_SaveButtonClick.Start
F.Intrinsic.Control.SetErrorHandler("FormRegCrate_SaveButtonClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sDesc.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sComment.Declare(String,"")
V.Local.iSeq.Declare(Long,0)
V.Local.sSeq.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sRunTime.Declare(String,"")
V.Local.sRate.Declare(String,"")
V.Local.sSetup.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.iTime.Declare(Long,0)
V.Local.fTemp.Declare(Float,0)
V.Local.sTemp.Declare(String,"")
V.Local.sExtraDesc.Declare(String,"")
V.Local.sPartDesc.Declare(String,"")
V.Local.sPartUM.Declare(String,"")

F.Intrinsic.Control.BlockEvents

V.Local.iTime.Set(V.Screen.FormRegCrate!txtRtrTime.Text)
F.Intrinsic.Control.If(V.Local.iTime,<=,0)
	F.Intrinsic.UI.Msgbox("Enter Time in Mins for a Single Crate","Attention")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Format(V.Ambient.Date,"MMDDYY",V.Local.sDate)

'F.Intrinsic.String.Build("Crate {0}x{1}x{2}",V.Screen.FormRegCrate!txtLength.Text,V.Screen.FormRegCrate!txtWidth.Text,V.Screen.FormRegCrate!txtHeight.Text,V.Local.sDesc)
V.Local.sDesc.Set(V.Screen.FormRegCrate!txtDesc.Text)

V.Local.sExtraDesc.Set(V.Screen.FormRegCrate!txtExtraDesc.Text)

F.Intrinsic.Control.If(v.Local.sDesc.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Enter in a Description","Attention")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sDesc.Length,>,30)
	F.Intrinsic.String.Left(V.Local.sDesc,30,V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.dtRouter.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Are you sure you want to create a New Part/Router?","New Part/Router",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.ODBC.Connection!Con.OpenCompanyConnection
		F.Intrinsic.String.Build("Select Part From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)
		
		V.Local.sPL.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
		V.Local.sUM.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim)

		F.Intrinsic.Control.If(V.Local.sPart.Trim,=,"")
			F.Global.Inventory.CreatePart(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim,V.Local.sDesc,"",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"F","","",0,"NOMAINT")
		F.Intrinsic.Control.Else
			F.Intrinsic.String.Build("Update Inventory_Mstr Set Description = '{1}' Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sDesc.Trim,V.Local.sSql)
			F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.String.Build("Select Part From INV_EXTRA_TEXT Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
		F.Intrinsic.Control.If(V.Local.sSql.Trim,<>,"")
			F.Intrinsic.String.Build("Update INV_EXTRA_TEXT Set Text = '{1}' Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sExtraDesc.Trim,V.Local.sSql)
		F.Intrinsic.Control.Else
			f.Intrinsic.String.Build("INSERT INTO INV_EXTRA_TEXT VALUES ('{0}','{1}')",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sExtraDesc.Trim,v.Local.ssql)
		F.Intrinsic.Control.EndIf
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.RLine.RowCount--,1)
			F.Intrinsic.Control.SelectCase(V.DataTable.RLine(V.Local.i).LMO!FieldValTrim)
				F.Intrinsic.Control.Case("L")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.Math.Mult(V.DataTable.RLine(V.Local.i).Run_Time!FieldValFloat,V.Local.iTime,V.Local.fTemp)
					F.Intrinsic.Math.Div(V.Local.fTemp,60,v.Local.fTemp)
					F.Intrinsic.String.Format(V.Local.fTemp,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","L","WC",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("M")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Build("Line_Router = '{0}'",V.DataTable.RLine(V.Local.i).Line_Router!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
					
				F.Intrinsic.Control.Case("O")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","O","PartNum",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("C")
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sComment.Redim(0,0)
					F.Intrinsic.String.Build("Line_Router = '{0}' and LMO = 'M'",V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Split(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim,"|",V.Local.sComment)
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sComment.UBound,1)
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment(V.Local.iC).Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.UnBlockEvents
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.6021.RowCount--,<>,-1)
	V.Local.iSeq.Set(V.DataTable.6021(V.DataTable.6021.RowCount--).Seq!FieldValLong)
	F.Intrinsic.Control.If(V.DataTable.Bolt.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Bolt.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'Bolt - {0}'",V.DataTable.Bolt(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.Bolt(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.Bolt(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.Brace.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Brace.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'Brace - {0}'",V.DataTable.Brace(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.Brace(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.Brace(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.Brace(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.AddMat.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.AddMat.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'AddMat - {0}'",V.DataTable.AddMat(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
				
					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.AddMat(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.AddMat(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30,"AND",v.Local.sComment.Trim,<>,"")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("Delete From Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.String.Build("Delete From ROUTER_SUPP_HDR Where Rtr_Num = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.CallSub(6021Sync)
F.Intrinsic.Control.EndIf

F.Data.Datatable.DeleteRow("6021")
F.Data.Datatable.AcceptChanges("6021")

'F.Global.General.CallWrappersync(50,"RE0017")

F.Data.DataTable.AddRow("400000","Mode","O","Router",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)

F.Intrinsic.Control.CallSub(400000Sync)

F.Data.DataTable.AddRow("1500","ROUTER",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"Quantity",1)
F.Intrinsic.Control.CallSub(1500sync)

F.Intrinsic.Control.CallSub(Get_Cost)

V.Passed.000052.Set(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
V.Passed.000056.Set(V.Local.sDesc.Trim)
v.Passed.000006.Set(V.Local.sUM)
V.Passed.000013.Set(V.Local.sPL)

F.Intrinsic.String.Build("Update INVENTORY_COST Set Cost = {0} Where Part = '{1}'",V.Passed.000012,V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("Update INVENTORY_MSTR Set Amt_Cost = {0} Where Part = '{1}'",V.Passed.000012,V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.Execute(V.Local.sSql)

F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormRegCrate_SaveButtonClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormRegCrate_SaveButtonClick.End

Program.Sub.Get_RunTime.Start
F.Intrinsic.Control.SetErrorHandler("Get_RunTime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fTemp1.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.fTemp3.Declare(Float,0)
V.Local.fSqft.Declare(Float,0)
V.Local.fMLen.Declare(Float,0)
V.Local.fMWid.Declare(Float,0)
V.Local.fCL.Declare(Float,0)
V.Local.fCW.Declare(Float,0)
V.Local.fCH.Declare(Float,0)
V.Local.fCP1.Declare(Float,0)
V.Local.fCP2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fRunTime.Declare(Float,0)
V.Local.fRunTime1.Declare(Float,0)
V.Local.fRunTime2.Declare(Float,0)
V.Local.fRunTime3.Declare(Float,0)
V.Local.fRunTime4.Declare(Float,0)
V.Local.sCuts.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.fRemLen.Declare(Float,0)
V.Local.fRemWid.Declare(Float,0)
V.Local.sTempCut1.Declare(String,"")
V.Local.sTempCut2.Declare(String,"")
V.Local.sTempCut3.Declare(String,"")
V.Local.sTempCut4.Declare(String,"")
V.Local.fTempRunTime1.Declare(Float,0)
V.Local.fHalfLen.Declare(Float,0)
V.Local.fHalfWid.Declare(Float,0)
V.Local.fPartMult.Declare(Float,0)
V.Local.fPartQty.Declare(Float,0)
V.Local.bRet.Declare(Boolean,False)
V.Local.fTempWidth.Declare(Float,0)
V.Local.fTempLen.Declare(Float,0)
V.Local.bTemp.Declare(Boolean,False)

V.Local.bTemp.Set(V.Global.bSplice)

V.Local.fMWid.Set(V.DataView.RLine!MLine(V.Args.Index).Width!FieldValFloat)
F.Intrinsic.Math.Div(V.Local.fMWid,2,V.Local.fHalfWid)
V.Local.fMLen.Set(V.DataView.RLine!MLine(V.Args.Index).Length!FieldValFloat)
F.Intrinsic.Math.Div(V.Local.fMLen,2,V.Local.fHalfLen)

V.Local.fTempWidth.Set(V.Local.fMWid)
V.Local.fTempLen.Set(V.Local.fMLen)

F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.fMLen,V.Local.fSqft)

F.Intrinsic.Control.If(V.DataView.RLine!MLine(V.Args.Index).UM_Inventory!FieldValTrim,=,"SH")
	F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"SIDE 1","AND",V.Screen.FormRegCrate!ddlSide1.Text,=,"Vertical")
		V.Local.fTemp1.Set(V.Local.fMLen)
		V.Local.fTemp2.Set(V.Local.fHalfLen)
		V.Local.fMLen.Set(V.Local.fMWid)
		V.Local.fHalfLen.Set(V.Local.fHalfWid)
		V.Local.fMWid.Set(V.Local.fTemp1)
		V.Local.fHalfWid.Set(V.Local.fTemp2)
		V.Local.fTemp1.Set(0)
		V.Local.fTemp2.Set(0)
	F.Intrinsic.Control.ElseIf(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"SIDE 2","AND",V.Screen.FormRegCrate!ddlSide2.Text,=,"Vertical")
		V.Local.fTemp1.Set(V.Local.fMLen)
		V.Local.fTemp2.Set(V.Local.fHalfLen)
		V.Local.fMLen.Set(V.Local.fMWid)
		V.Local.fHalfLen.Set(V.Local.fHalfWid)
		V.Local.fMWid.Set(V.Local.fTemp1)
		V.Local.fHalfWid.Set(V.Local.fTemp2)
		V.Local.fTemp1.Set(0)
		V.Local.fTemp2.Set(0)
	F.Intrinsic.Control.ElseIf(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"TOP","AND",V.Screen.FormRegCrate!ddlTop.Text,=,"Short Length")
		V.Local.fTemp1.Set(V.Local.fMLen)
		V.Local.fTemp2.Set(V.Local.fHalfLen)
		V.Local.fMLen.Set(V.Local.fMWid)
		V.Local.fHalfLen.Set(V.Local.fHalfWid)
		V.Local.fMWid.Set(V.Local.fTemp1)
		V.Local.fHalfWid.Set(V.Local.fTemp2)
		V.Local.fTemp1.Set(0)
		V.Local.fTemp2.Set(0)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

V.Local.fCL.Set(V.Screen.FormRegCrate!txtLength.Text)
V.Local.fCW.Set(V.Screen.FormRegCrate!txtWidth.Text)
V.Local.fCH.Set(V.Screen.FormRegCrate!txtHeight.Text)

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"BASE B")
	V.Local.fCP1.Set(V.Screen.FormRegCrate!txtBaseQty.Text)
F.Intrinsic.Control.ElseIf(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"BASE R")
	V.Local.fCP1.Set(V.Screen.FormRegCrate!txtBaseRQty.Text)
F.Intrinsic.Control.Else
	V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldVal)
	F.Intrinsic.Control.If(V.Local.sEval.IsNumeric)
		V.Local.fCP1.Set(V.Local.sEval.Float)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
			F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[BASE B]",V.Screen.FormRegCrate!txtBaseQty.Text,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[BASE R]",V.Screen.FormRegCrate!txtBaseRQty.Text,V.Local.sEval)
			F.Intrinsic.Control.Try
				F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
				F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fCP1)
				F.Intrinsic.Math.Int(V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fCP1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fCP1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.If(V.Local.fCP1,=,V.Local.fTemp1)
						V.Local.fCP1.Set(V.Local.fTemp1.Long)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fCP1)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Catch
				V.Local.fCP1.Set(1)
			F.Intrinsic.Control.EndTry
		F.Intrinsic.Control.Else
			V.Local.fCP1.Set(0)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldVal)
F.Intrinsic.Control.If(V.Local.sEval.IsNumeric)
	V.Local.fCP2.Set(V.Local.sEval.Float)
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
		F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[BASE B]",V.Screen.FormRegCrate!txtBaseQty.Text,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[BASE R]",V.Screen.FormRegCrate!txtBaseRQty.Text,V.Local.sEval)
		F.Intrinsic.Control.Try
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fCP2)
			F.Intrinsic.Math.Int(V.Local.fCP2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fCP2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fCP2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Control.If(V.Local.fCP2,=,V.Local.fTemp1)
						V.Local.fCP2.Set(V.Local.fTemp1.Long)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fCP2)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Catch
			V.Local.fCP2.Set(1)
		F.Intrinsic.Control.EndTry
	F.Intrinsic.Control.Else
		V.Local.fCP2.Set(0)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
	
V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim)

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"TOP","AND",V.DataView.RLine!MLine(V.Args.Index).UM_Inventory!FieldValTrim,<>,"SH")
	F.Intrinsic.Control.If(V.Local.fCL,>=,V.Local.fCW)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCW,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCL,V.Local.sEval)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.IsInString(V.Local.sEval,"[CL]",False,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet)
		V.Local.fRunTime3.Set(V.Local.fCL)
	F.Intrinsic.Control.Else	
		F.Intrinsic.String.IsInString(V.Local.sEval,"[CW]",False,V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			V.Local.fRunTime3.Set(V.Local.fCW)
		F.Intrinsic.Control.Else 
			F.Intrinsic.String.IsInString(V.Local.sEval,"[CH]",False,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet)
				V.Local.fRunTime3.Set(V.Local.fCH)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CP]",V.Local.fCP1,V.Local.sEval)

F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)

F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
	F.Intrinsic.Control.Try
		F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fRunTime1)
	F.Intrinsic.Control.Catch
		V.Local.fRunTime1.Set(0)
	F.Intrinsic.Control.EndTry
F.Intrinsic.Control.Else
	V.Local.fRunTime1.Set(0)
F.Intrinsic.Control.EndIf

V.Local.sEval.Set(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim)

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"TOP","AND",V.DataView.RLine!MLine(V.Args.Index).UM_Inventory!FieldValTrim,<>,"SH")
	F.Intrinsic.Control.If(V.Local.fCL,>=,V.Local.fCW)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCW,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCL,V.Local.sEval)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.Intrinsic.String.IsInString(V.Local.sEval,"[CL]",False,V.Local.bRet)
	F.Intrinsic.Control.If(V.Local.bRet)
		V.Local.fRunTime4.Set(V.Local.fCL)
	F.Intrinsic.Control.Else	
		F.Intrinsic.String.IsInString(V.Local.sEval,"[CW]",False,V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet)
			V.Local.fRunTime4.Set(V.Local.fCW)
		F.Intrinsic.Control.Else 
			F.Intrinsic.String.IsInString(V.Local.sEval,"[CH]",False,V.Local.bRet)
			F.Intrinsic.Control.If(V.Local.bRet)
				V.Local.fRunTime4.Set(V.Local.fCH)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Intrinsic.String.Replace(V.Local.sEval,"[CL]",V.Local.fCL,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fCW,V.Local.sEval)
F.Intrinsic.Control.EndIf
F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fCH,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMLen,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMWid,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[SF]",V.Local.fSqft,V.Local.sEval)
F.Intrinsic.String.Replace(V.Local.sEval,"[CP]",V.Local.fCP2,V.Local.sEval)

F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)

F.Intrinsic.Control.If(V.Local.sEval.Trim,<>,"")
	F.Intrinsic.Control.Try
		F.Intrinsic.Math.Evaluate(V.Local.sEval,v.Local.fRunTime2)
	F.Intrinsic.Control.Catch
		V.Local.fRunTime2.Set(0)
	F.Intrinsic.Control.EndTry
F.Intrinsic.Control.Else
	V.Local.fRunTime2.Set(0)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.fRunTime3,=,0)
	v.Local.fRunTime3.Set(V.Local.fRunTime1)
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.If(v.Local.fRunTime4,=,0)
	V.Local.fRunTime4.Set(V.Local.fRunTime2)
F.Intrinsic.Control.EndIf

''F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,<>,"SIDE 2")
	v.Local.fRunTime3.Set(V.Local.fRunTime1)
	V.Local.fRunTime4.Set(V.Local.fRunTime2)
'F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataView.RLine!MLine(V.Args.Index).UM_Inventory!FieldValTrim,<>,"SH")
	F.Intrinsic.Control.SelectCase(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim)
			
		F.Intrinsic.Control.CaseElse
			F.Intrinsic.Control.If(V.Local.fCP1,>,0,"AND",V.Local.fCP2,>,0)
				V.Local.fTemp1.Set(V.Local.fRunTime1)
				V.Local.fTemp2.Set(V.Local.fRunTime2)
				F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
				F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fRunTime)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fRunTime.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sTempCut1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut1,V.Local.fCP1,V.Local.fTemp3,V.Local.sTempCut1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sTempCut1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp2,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fMLen,V.Local.sTempCut2)
					F.Intrinsic.Math.Sub(V.Local.fTemp2,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut2,V.Local.fCP2,V.Local.fTemp3,V.Local.sTempCut2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp2,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fTemp2,V.Local.sTempCut2)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.String.Build("{0} | {1}",V.Local.sTempCut1,V.Local.sTempCut2,V.Local.sCuts)
				
			F.Intrinsic.Control.ElseIf(V.Local.fCP1,>,0,"AND",V.Local.fCP2,<=,0)
				V.Local.fTemp1.Set(V.Local.fRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
				V.Local.fRunTime.Set(V.Local.fRunTime1)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fRunTime.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
					F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fCP1,<=,0,"AND",V.Local.fCP2,>,0)
				V.Local.fTemp1.Set(V.Local.fRunTime2)
				F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
				V.Local.fRunTime.Set(V.Local.fRunTime2)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fRunTime.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
					F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
					F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
					F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Else
	F.Intrinsic.Control.SelectCase(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim)

		F.Intrinsic.Control.Case("TOP")
			V.Local.fRunTime.Set(0)

			'figuring out partials
			F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Control.If(V.Local.fTemp1.Long,=,V.Local.fTemp2.Long)
'					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					V.Local.fTemp3.Set(V.Local.fTemp1.Long)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf

					'figureing addtional stick cuts
					F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							V.Local.fPartMult.Set(1)

							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

							F.Intrinsic.Math.Div(V.Local.fMWid,2,V.Local.fHalfWid)
							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							
							F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
							
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,>,V.Local.fTemp2.Long)
'					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					V.Local.fTemp3.Set(V.Local.fTemp1.Long)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"2",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf

					F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
						'figureing addtional stick cuts
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							V.Local.fPartMult.Set(1)

							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
							
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp2.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
					
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,<,V.Local.fTemp2.Long)
'					F.Intrinsic.Math.Mult(V.Local.fTemp2.Long,V.Local.fCP2,V.Local.fTemp3)
					V.Local.fTemp3.Set(V.Local.fTemp2.Long)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"2",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf

					F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
						'figureing addtional stick cuts
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							V.Local.fPartMult.Set(1)
							
							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
							
							
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,=<,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				V.Local.fTemp2.Set(V.Local.sTemp.Long)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf

				V.Local.fTemp3.Set(V.Local.fTemp1.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fHalfWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen,"AND",V.Local.fRunTime2,>,V.Local.fHalfWid)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP1.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP1.Long,V.Local.fRemLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fPartMult.Set(1)
						
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
						
							
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp1.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp1.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,=<,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				V.Local.fTemp1.Set(V.Local.sTemp.Long)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				
				V.Local.fTemp3.Set(V.Local.fTemp2.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fHalfLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp3,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fRunTime1,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
					F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid,"AND",V.Local.fRunTime1,>,V.Local.fHalfLen)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP2.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP2.Long,V.Local.fRunTime1,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fPartMult.Set(1)
						
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
							
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp2.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp2.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1,V.Local.fTempRunTime1)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTempRunTime1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime2,V.Local.sCuts)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.CaseElse
			F.Intrinsic.Control.If(V.Global.bRL)
				F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OpCode!FieldValTrim,=,"SIDE 2")
					V.Global.bSplice.Set(True)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			V.Local.fRunTime.Set(0)

			'figuring out partials
			F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Control.If(V.Local.fTemp1.Long,=,V.Local.fTemp2.Long)
'					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					V.Local.fTemp3.Set(V.Local.fTemp1.Long)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf

					'figureing addtional stick cuts
					F.Intrinsic.Control.If(V.Global.bSplice)
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 1","OR",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2")
								V.Local.fPartMult.Set(2)
							F.Intrinsic.Control.Else
								V.Local.fPartMult.Set(1)
							F.Intrinsic.Control.EndIf

							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

							F.Intrinsic.Math.Div(V.Local.fMWid,2,V.Local.fHalfWid)
							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							
							F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
								
							F.Intrinsic.String.IsInString(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Part_WC_Outside!FieldVal,"SK 2*4",False,V.Local.bRet)
						
							F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2","AND",V.Local.bRet,=,True)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,5,V.Local.fRunTime2)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,>,V.Local.fTemp2.Long)
'					F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
					V.Local.fTemp3.Set(V.Local.fTemp1.Long)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"2",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf

					F.Intrinsic.Control.If(V.Global.bSplice)
						'figureing addtional stick cuts
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 1","OR",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2")
								V.Local.fPartMult.Set(2)
							F.Intrinsic.Control.Else
								V.Local.fPartMult.Set(1)
							F.Intrinsic.Control.EndIf

							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
							
							F.Intrinsic.String.IsInString(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Part_WC_Outside!FieldVal,"SK 2*4",False,V.Local.bRet)
						
							F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2","AND",V.Local.bRet,=,True)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,5,V.Local.fRunTime2)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp2.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
					
				F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,<,V.Local.fTemp2.Long)
'					F.Intrinsic.Math.Mult(V.Local.fTemp2.Long,V.Local.fCP2,V.Local.fTemp3)
					V.Local.fTemp3.Set(V.Local.fTemp2.Long)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
						F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
						F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fSqft,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
						F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"2",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
					F.Intrinsic.Control.EndIf

					F.Intrinsic.Control.If(V.Global.bSplice)
						'figureing addtional stick cuts
						F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
						F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
						F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
						F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
							F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 1","OR",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2")
								V.Local.fPartMult.Set(2)
							F.Intrinsic.Control.Else
								V.Local.fPartMult.Set(1)
							F.Intrinsic.Control.EndIf
							V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
							V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

							F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
							F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
							F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
							
							F.Intrinsic.String.IsInString(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Part_WC_Outside!FieldVal,"SK 2*4",False,V.Local.bRet)
						
							F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2","AND",V.Local.bRet,=,True)
								F.Intrinsic.Math.Sub(V.Local.fRunTime2,5,V.Local.fRunTime2)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp2.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut4)
								F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
								F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'								F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'								F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
								V.Local.fPartQty.Set(V.Local.fTemp1.Long)
								F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut4)
							F.Intrinsic.Control.EndIf
							
							F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
							F.Intrinsic.Control.If(V.Local.fMLen,=,0)
								V.Local.fTempRunTime1.Set(0)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
							F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
							F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Data.DataView.Close("RLine","MTemp")
						F.Data.DataView.Close("dtRouterTemp","Temp")
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,=<,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMLen,=,0)
					V.Local.fTemp1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
				V.Local.fTemp2.Set(V.Local.sTemp.Long)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
				F.Intrinsic.Control.EndIf

				V.Local.fTemp3.Set(V.Local.fTemp1.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fHalfWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen,"AND",V.Local.fRunTime2,>,V.Local.fHalfWid)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP1.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP1.Long,V.Local.fRemLen,V.Local.fRunTime2,V.Local.sCuts)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Control.If(V.Global.bSplice)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 1","OR",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2")
							V.Local.fPartMult.Set(2)
						F.Intrinsic.Control.Else
							V.Local.fPartMult.Set(1)
						F.Intrinsic.Control.EndIf
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
						
						F.Intrinsic.String.IsInString(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Part_WC_Outside!FieldVal,"SK 2*4",False,V.Local.bRet)
						
						F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2","AND",V.Local.bRet,=,True)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,5,V.Local.fRunTime2)
						F.Intrinsic.Control.EndIf
							
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp1.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,=<,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp1.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime2,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,=<,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
				F.Intrinsic.Control.If(V.Local.fMWid,=,0)
					V.Local.fTemp2.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
				V.Local.fTemp1.Set(V.Local.sTemp.Long)
				F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
				F.Intrinsic.Control.EndIf
				
				V.Local.fTemp3.Set(V.Local.fTemp2.Long)
				F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fHalfLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp3,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fRunTime1,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
					F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid,"AND",V.Local.fRunTime1,>,V.Local.fHalfLen)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP2.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP2.Long,V.Local.fRunTime1,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf

				F.Intrinsic.Control.If(V.Global.bSplice)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 1","OR",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2")
							V.Local.fPartMult.Set(2)
						F.Intrinsic.Control.Else
							V.Local.fPartMult.Set(1)
						F.Intrinsic.Control.EndIf
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)

						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime3,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Math.Sub(V.Local.fRunTime4,V.Local.fMWid,V.Local.fRunTime2)
						
						F.Intrinsic.String.IsInString(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Part_WC_Outside!FieldVal,"SK 2*4",False,V.Local.bRet)
						
						F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,=,"SIDE 2","AND",V.Local.bRet,=,True)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,5,V.Local.fRunTime2)
						F.Intrinsic.Control.EndIf
							
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp2.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fPartQty.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,=<,V.Local.fMLen)
'							F.Intrinsic.Math.Sub(V.Local.fTemp2.Long,1,V.Local.fTemp3)
'							F.Intrinsic.Math.Mult(V.Local.fTemp3.Long,V.Local.fPartMult,V.Local.fPartQty)
							V.Local.fPartQty.Set(V.Local.fTemp2.Long)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fPartQty.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1,V.Local.fTempRunTime1)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTempRunTime1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime2,V.Local.sCuts)
			F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.EndIf

V.Global.bSplice.Set(V.Local.bTemp)

F.Intrinsic.Variable.AddRV("RunTime",V.Local.fRunTime,"Cuts",V.Local.sCuts)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_RunTime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_RunTime.End

Program.Sub.Get_Cost.Start
F.Intrinsic.Control.SetErrorHandler("Get_Cost_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sFile.Declare(String,"")
V.Local.fMat.Declare(Float,0)
V.Local.fOut.Declare(Float,0)
V.Local.fLab.Declare(Float,0)
V.Local.fTotalCost.Declare(Float,0)
V.Local.fMrkUpMat.Declare(Float,0)
V.Local.fMrkUpOut.Declare(Float,0)
V.Local.fMrkUpLab.Declare(Float,0)
V.Local.fPrice.Declare(Float,0)
V.Local.sSql.Declare(String,"")
	
'get the output file from the router biuld up and put it in a datatable(s)
F.Intrinsic.String.Build("{0}\{1}{2}PRICING.OUT",v.Caller.FilesDir,v.Caller.User.Trim,v.Caller.Terminal.Trim,v.Local.sFile)
F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sPart)

F.Data.DataTable.CreateFromString("ROUTER",V.Local.sPart,"TYPE*!*ROUTER*!*QTY*!*DIR_COST*!*COST*!*MATERIAL*!*OUTSIDE*!*LABOR*!*LABOR_HOURS*!*OVERHEAD*!*TIME_QTY*!*GP%-1*!*PRICE-1*!*GP%-2*!*PRICE-2*!*GP%-3*!*PRICE-3*!*GP%-4*!*PRICE-4*!*SELL3","STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING*!*STRING","*!*",V.Ambient.NewLine,True)
F.Intrinsic.Control.If(V.DataTable.ROUTER.RowCount--,>,0)
    'Type M = Markup  Marterial markup Columns(Router, Qty, Dir_Cost, Cost), Outside markup columns(Material, Outside, Labor, Labor_Hours), Labor markup columns(Overhead, Time_Qty, GP%-1, Price-1)
    'Type T = Total, Material = Material Column, Outside = Outside Column, Labor&Overhead = Labor Column + Overhead Column
    F.Data.DataView.Create("Router","TRouter",22,"Type = 'T'","")
    F.Data.DataView.Create("Router","MRouter",22,"Type = 'M'","")
    V.Local.fMat.Set(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Material!FieldVal)
    V.Local.fOut.Set(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Outside!FieldVal)
    F.Intrinsic.Math.Add(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Labor!FieldVal,V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Overhead!FieldVal,V.Local.fLab)
    V.Local.fTotalCost.Set(V.DataView.ROUTER!TRouter(V.DataView.ROUTER!TRouter.RowCount--).Cost!FieldVal)
    
    F.Intrinsic.Math.Mult(V.Local.fMat,V.DataView.ROUTER!MRouter(V.DataView.ROUTER!MRouter.RowCount--).Cost!FieldVal,V.Local.fMrkUpMat)
    F.Intrinsic.Math.Mult(V.Local.fOut,V.DataView.ROUTER!MRouter(V.DataView.ROUTER!MRouter.RowCount--).Labor_Hours!FieldVal,V.Local.fMrkUpOut)
    F.Intrinsic.Math.Mult(V.Local.fLab,V.DataView.ROUTER!MRouter(V.DataView.ROUTER!MRouter.RowCount--).Price-1!FieldVal,V.Local.fMrkUpLab)
    F.Intrinsic.Math.Add(V.Local.fMrkUpLab,V.Local.fMrkUpMat,V.Local.fMrkUpOut,V.Local.fPrice)
    
    F.Data.DataView.Close("Router","TRouter")
    F.Data.DataView.Close("Router","MRouter")
F.Intrinsic.Control.EndIf

F.Data.Datatable.Close("ROUTER")

V.Passed.000009.Set(V.Local.fPrice)
V.Passed.000012.Set(V.Local.fTotalCost)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Cost_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Cost.End

Program.Sub.FormCrateSel_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormCrateSel_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormCrateSel..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormCrateSel_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormCrateSel_UnLoad.End

Program.Sub.cmdReg_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdReg_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

V.Global.sSelection.Set("CRATE")

F.Intrinsic.Control.CallSub(FormCrateSel_UnLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdReg_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdReg_Click.End

Program.Sub.cmdShell_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdShell_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

V.Global.sSelection.Set("SHELL")

F.Intrinsic.Control.CallSub(FormCrateSel_UnLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdShell_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdShell_Click.End

Program.Sub.Get_Data_Shell.Start
F.Intrinsic.Control.SetErrorHandler("Get_Data_Shell_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.i.Declare(Long,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fCutLen1.Declare(Float,0)
V.Local.fCutLen2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.sSql.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
	F.Data.Datatable.DeleteRow("dtRouter")
	F.Data.Datatable.AcceptChanges("dtRouter")
	V.Local.sRouter.Set(V.Screen.FormShell!txtShellTemplate.Text)
	F.Intrinsic.String.Build("Select * From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RHeader.Exists)
		F.Data.Datatable.Close("RHeader")
	F.Intrinsic.Control.EndIf
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Data.Dictionary.CreateFromSQL("Part","con","Select rtrim(Part), rtrim(Part) From V_Inventory_Mstr where Code_Sort = 'LSTK' Order by Part")
	Gui.FormShell.ddlBStrg.AddItems("Dictionary","Part")
	Gui.FormShell.ddlRunMat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlSide1Mat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlSide2Mat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlTopMat.AddItems("Dictionary","Part")
	Gui.FormShell.ddlTStrgMat.AddItems("Dictionary","Part")
	F.Data.Dictionary.Close("Part")
	F.Data.Datatable.CreateFromSQL("RHeader","Con",V.Local.sSql,True)
	F.Intrinsic.String.Build("Select * From V_Router_Line Where Router = '{0}' Order by Line_Router",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RLine.Exists)
		F.Data.Datatable.Close("RLine")
	F.Intrinsic.Control.EndIf
	F.Data.Datatable.CreateFromSQL("RLine","Con",V.Local.sSql,True)
	F.Data.Datatable.AddColumn("RLine","Length",Float)
	F.Data.Datatable.AddColumn("RLine","Width",Float)
	F.Data.Dictionary.CreateFromSQL("Len","Con","Select Part, Length From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Len","0")
	F.Data.Datatable.FillFromDictionary("RLine","Len","Part_WC_Outside","Length")
	F.Data.Dictionary.Close("Len")
	F.Data.Dictionary.CreateFromSQL("Wid","Con","Select Part, Width From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Wid","0")
	F.Data.Datatable.FillFromDictionary("RLine","Wid","Part_WC_Outside","Width")
	F.Data.Dictionary.Close("Wid")
	F.Intrinsic.String.Build("Select * From GCG_6761_CRATE_MAINT Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.CrateCalc.Exists)
		F.Data.Datatable.Close("CrateCalc")
	F.Intrinsic.Control.EndIf

	F.Data.Datatable.CreateFromSQL("CrateCalc","Con",V.Local.sSql,True)
	
	F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
		F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
		F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
		F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
		F.Intrinsic.Control.Else
			V.Local.fQty1.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
		F.Intrinsic.Control.Else
			V.Local.fQty2.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fCutLen1)
		F.Intrinsic.Control.Else
			V.Local.fCutLen1.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fCutLen2)
		F.Intrinsic.Control.Else
			V.Local.fCutLen2.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.bMW1)
			F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
			F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
				F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.bMW2)
			F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
			F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
				F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
			F.Intrinsic.Control.Case("SIDE 1")
				gui.FormShell.ddlSide1Mat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
				Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fCutLen1)
				Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fCutLen2)
				Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
				Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			F.Intrinsic.Control.Case("SIDE 2")
				gui.FormShell.ddlSide2Mat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
				Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fCutLen1)
				Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fCutLen2)
				Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
				Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			F.Intrinsic.Control.Case("TOP")
				gui.FormShell.ddlTopMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
				Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fCutLen1)
				Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fCutLen2)
				Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
				Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			F.Intrinsic.Control.Case("T STRG")
				gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
				gui.FormShell.txtTStrg.Text(V.Local.fCutLen1)
				gui.FormShell.ddlTStrgMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
			F.Intrinsic.Control.Case("B STRG")
				Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
				gui.FormShell.txtBStrg.Text(V.Local.fCutLen1)
				gui.FormShell.ddlBStrg.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
			F.Intrinsic.Control.Case("RUN")
				Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
				gui.FormShell.txtLRun.Text(V.Local.fCutLen1)
				gui.FormShell.ddlRunMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Next(V.Local.i)
	
	F.ODBC.Connection!Con.Close
F.Intrinsic.Control.Else
	f.Data.DataTable.Create("dtRouter",True)
	f.Data.DataTable.AddColumn("dtRouter","Router","string")
	f.Data.DataTable.AddColumn("dtRouter","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouter","LMO","string")
	f.Data.DataTable.AddColumn("dtRouter","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouter","Operation","string")
	f.Data.DataTable.AddColumn("dtRouter","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouter","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouter","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouter","Rate","float")
	f.Data.DataTable.AddColumn("dtRouter","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouter","Cuts","string")

	f.Data.DataTable.Create("dtRouterTemp",True)
	f.Data.DataTable.AddColumn("dtRouterTemp","Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","LMO","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Operation","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Rate","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Cuts","string")
	
	f.Data.DataTable.Create("TempCuts",True)
	f.Data.DataTable.AddColumn("TempCuts","Line_Router","string")
	f.Data.DataTable.AddColumn("TempCuts","Operation","string")
	f.Data.DataTable.AddColumn("TempCuts","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("TempCuts","Run_Time","float")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Data_Shell_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Data_Shell.End

Program.Sub.FormShell_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormShell_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormShell_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.FormShell_UnLoad.End

Program.Sub.Set_Prop_Shell.Start
F.Intrinsic.Control.SetErrorHandler("Set_Prop_Shell_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellLen.TabStop(True)
Gui.FormShell.txtShellWidth.TabStop(True)
Gui.FormShell.txtShellHeight.TabStop(True)

Gui.FormShell.txtShellTemplate.TabIndex(0)
Gui.FormShell.cmdShellTemplate.TabIndex(1)
Gui.FormShell.cmdShellTemplate.TabStop(False)
Gui.FormShell.txtShellDesc.TabIndex(2)
Gui.FormShell.txtShellLen.TabIndex(3)
Gui.FormShell.txtShellWidth.TabIndex(4)
Gui.FormShell.txtShellHeight.TabIndex(5)
Gui.FormShell.txtExtraShellDesc.TabIndex(6)
Gui.FormShell.txtTStrg.TabIndex(7)
Gui.FormShell.txtTStrgQty.TabIndex(8)
Gui.FormShell.ddlTStrgMat.TabIndex(9)
Gui.FormShell.txtBStrg.TabIndex(10)
Gui.FormShell.txtBstrgQty.TabIndex(11)
Gui.FormShell.ddlBStrg.TabIndex(12)
Gui.FormShell.ddlRunMat.TabIndex(13)
Gui.FormShell.txtLRun.TabIndex(14)
Gui.FormShell.txtRunQty.TabIndex(15)
Gui.FormShell.ddlRunMat.TabIndex(16)
Gui.FormShell.ddlSide1Mat.TabIndex(17)
Gui.FormShell.txtSide1QtyDim1.TabIndex(20)
Gui.FormShell.txtSide1CutLenDim1.TabIndex(21)
Gui.FormShell.txtSide1QtyDim2.TabIndex(22)
Gui.FormShell.txtSide1CutLenDim2.TabIndex(23)
Gui.FormShell.ddlSide2Mat.TabIndex(24)
Gui.FormShell.txtSide2QtyDim1.TabIndex(25)
Gui.FormShell.txtSide2CutLenDim1.TabIndex(26)
Gui.FormShell.txtSide2QtyDim2.TabIndex(27)
Gui.FormShell.txtSide2CutLenDim2.TabIndex(28)
Gui.FormShell.ddlTopMat.TabIndex(29)
Gui.FormShell.txtTopQtyDim1.TabIndex(30)
Gui.FormShell.txtTopCutLenDim1.TabIndex(31)
Gui.FormShell.txtTopQtyDim2.TabIndex(32)
Gui.FormShell.txtTopCutLenDim2.TabIndex(33)
Gui.FormShell.cmdShellCalc.TabIndex(34)

gui.FormShell.GsGridShellNewRout.AddGridviewFromDatatable("gvRouter","dtRouter")

gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ShowGroupPanel,True)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowAddRows,False)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)
gui.FormShell.GsGridShellNewRout.SetGridviewProperty("gvRouter",V.Enum.GridViewPropertyNames!AllowSort,False)

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",v.Enum.ColumnPropertyNames!Caption,"Router")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",v.Enum.ColumnPropertyNames!Caption,"Seq")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",v.Enum.ColumnPropertyNames!Caption,"Type")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",v.Enum.ColumnPropertyNames!Caption,"Part / Workcenter")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",v.Enum.ColumnPropertyNames!Caption,"Op Code")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",v.Enum.ColumnPropertyNames!Caption,"Setup")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Width,"30")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",v.Enum.ColumnPropertyNames!Caption,"Material Requirements")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",v.Enum.ColumnPropertyNames!Caption,"Unit")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Width,"10")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",v.Enum.ColumnPropertyNames!Caption,"Rate")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Width,"30")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"c2")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",v.Enum.ColumnPropertyNames!Caption,"Description")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",v.Enum.ColumnPropertyNames!Caption,"Cuts")
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormShell.GsGridShellNewRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!CellWordWrap,"Wrap")

gui.FormShell.GsGridShellNewRout.MainView("gvRouter")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Set_Prop_Shell_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Set_Prop_Shell.End

Program.Sub.txtShellTemplate_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellTemplate_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellTemplate.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellTemplate_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellTemplate_GotFocus.End

Program.Sub.txtShellTemplate_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellTemplate_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sSql.Declare(String,"")

Gui.FormShell.txtShellTemplate.Enabled(True)

V.Local.sRouter.Set(V.Screen.FormShell!txtShellTemplate.Text)
F.Intrinsic.Control.If(V.Local.sRouter.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
F.ODBC.Connection!Conx.OpenCompanyConnection
F.ODBC.Connection!Conx.ExecuteAndReturn(V.Local.sSql,V.Local.sRouter)
F.ODBC.Connection!Conx.Close
F.Intrinsic.Control.If(V.Local.sRouter.Trim,<>,"")
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(Get_Data_Shell)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Template Router Not Found.....","Attention")
	Gui.FormShell.txtShellTemplate.SetFocus
	Gui.FormShell.txtShellTemplate.SelectAll
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellTemplate_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellTemplate_LostFocus.End

Program.Sub.txtShellLen_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellLen_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellLen.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellLen_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellLen_GotFocus.End

Program.Sub.txtShellWidth_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellWidth_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellWidth.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellWidth_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellWidth_GotFocus.End

Program.Sub.txtShellHeight_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellHeight_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtShellHeight.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellHeight_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellHeight_GotFocus.End

Program.Sub.cmdShellCalc_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdShellCalc_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.iTemp.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sStart.Declare(String,"")
V.Local.fSetUp.Declare(Float,0)
V.Local.fRunTime.Declare(Float,0)
V.Local.fRate.Declare(Float,0)
V.Local.sFilter.Declare(String,"")
V.Local.sCuts.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sQuote.Declare(String,"")
V.Local.sLine.Declare(String,"")
V.Local.sRate.Declare(String,"")
V.Local.iCuts.Declare(Long,0)
V.Local.bSheet.Declare(Boolean,False)
V.Local.fLen.Declare(Float,0)
V.Local.fWid.Declare(Float,0)
V.Local.fRem.Declare(Float,0)
V.Local.fTemp.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.iID.Declare(Long,0)
V.Local.iNID.Declare(Long,0)
V.Local.fCurrentSheetRunTime.Declare(Float,0)
V.Local.sTemp2.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sDesc.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellTemplate.Text,=,"")
	V.Local.sMsg.Set("Select a Template Router")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellLen.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Length Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Length Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellWidth.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Width Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Width Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormShell!txtShellHeight.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Crate Height Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Crate Height Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

Gui.FormShell..Enabled(False)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Sort_2 From V_Router_Header Where Router = '{0}'",V.Screen.FormShell!txtShellTemplate.Text,V.Local.sStart)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sStart,V.Local.sStart)
V.Global.sSort.Set(V.Local.sStart.Trim)
F.ODBC.Connection!Con.Close

F.Intrinsic.String.LPad(V.Passed.000060,"0",6,V.Local.sQuote)
F.Intrinsic.String.LPad(V.Passed.000051,"0",3,V.Local.sLine)

F.Intrinsic.String.Build("{0}{1}{2}{3}",V.Passed.000112,V.Global.sSort,V.Local.sQuote,V.Local.sLine,V.Local.sRouter)

'F.Intrinsic.String.Build("{0}x{1}x{2}",V.Screen.FormShell!txtShellLen.Text,V.Screen.FormShell!txtShellWidth.Text,V.Screen.FormShell!txtShellHeight.Text,V.Local.sRouter)

'F.Intrinsic.String.Build("{0}-{1}",V.Local.sStart.Trim,V.Local.sRouter,V.Local.sRouter)

V.Local.sDesc.Set(V.Screen.FormShell!txtShellDesc.Text)
F.Intrinsic.Control.If(V.Local.sDesc.Trim,=,"")
	F.Intrinsic.String.Build("Crate: {0}x{1}x{2}",V.Screen.FormShell!txtShellLen.Text,V.Screen.FormShell!txtShellWidth.Text,V.Screen.FormShell!txtShellHeight.Text,V.Local.sDesc)
	Gui.FormShell.txtShellDesc.Text(V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("{0}-{1} Crate: {2}x{3}x{4}",V.Passed.000112.Trim,V.Screen.FormShell!txtShellTemplate.Text,V.Screen.FormShell!txtShellLen.Text,V.Screen.FormShell!txtShellWidth.Text,V.Screen.FormShell!txtShellHeight.Text,V.Local.sDesc)

Gui.FormShell.txtExtraShellDesc.Text(V.Local.sDesc)

F.Data.DataTable.DeleteRow("dtRouterTemp")
F.Data.DataTable.AcceptChanges("dtRouterTemp")

F.Data.DataTable.DeleteRow("TempCuts")
F.Data.DataTable.AcceptChanges("TempCuts")

F.Data.DataView.Create("RLine","MLine",22,"LMO = 'M'","Line_Router")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.RLine!MLine.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.DataView.RLine!MLine(V.Local.i).Operation!FieldValTrim)
		F.Intrinsic.Control.Case("T STRG")
			V.Local.sPart.Set(V.Screen.FormShell!ddlTStrgMat.Text)
			
		F.Intrinsic.Control.Case("B STRG")
			V.Local.sPart.Set(V.Screen.FormShell!ddlBStrg.Text)
			
		F.Intrinsic.Control.Case("RUN")
			V.Local.sPart.Set(V.Screen.FormShell!ddlRunMat.Text)
			
		F.Intrinsic.Control.Case("SIDE 1")
			V.Local.sPart.Set(V.Screen.FormShell!ddlSide1Mat.Text)
			
		F.Intrinsic.Control.Case("SIDE 2")
			V.Local.sPart.Set(V.Screen.FormShell!ddlSide2Mat.Text)
			
		F.Intrinsic.Control.Case("TOP")
			V.Local.sPart.Set(V.Screen.FormShell!ddlTopMat.Text)
			
		F.Intrinsic.Control.CaseElse
			V.Local.sPart.Set("")
			
	F.Intrinsic.Control.EndSelect
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Intrinsic.String.Build("Select Top 1 a.UM_Inventory, a.Description, b.Cost, c.Length, c.Width From V_Inventory_Mstr a Left Join V_Inventory_Cost b on a.Part = b.Part and a.Location = b.Locn Left Join V_Inventory_Mst2 c on a.Part = c.Part and a.Location = c.Location Where a.Part = '{0}'",V.Local.sPart.Trim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sTemp)
	F.ODBC.Connection!Con.Close
	F.Intrinsic.String.Split(V.Local.sTemp,"*!*",V.Local.sTemp)
	V.Local.sTemp.RedimPreserve(0,4)
	
	F.Intrinsic.Control.If(V.Local.sTemp(2),<>,"")
		V.Local.fRate.Set(V.Local.sTemp(2).Float)
	F.Intrinsic.Control.Else
		V.Local.fRate.Set(V.DataView.RLine!MLine(V.Local.i).Rate!FieldVal)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.sTemp(3),=,"")
		V.Local.sTemp(3).Set("1")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.sTemp(4),=,"")
		V.Local.sTemp(4).Set("1")
	F.Intrinsic.Control.EndIf
	V.Local.fSetUp.Set(V.DataView.RLine!MLine(V.Local.i).Set_Up!FieldVal)
	F.Intrinsic.Control.CallSub(Get_Shell_Runtime,"Index",V.Local.i,"Len",V.Local.sTemp(3).Float,"Wid",V.Local.sTemp(4).Float)
	V.Local.fRunTime.Set(V.Args.RunTime)
	V.Local.sCuts.Set(V.Args.Cuts)
	
	F.Data.Datatable.AddRow("TempCuts","Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"Part_WC_Outside",V.Local.sPart.Trim,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Run_Time",V.Local.fRunTime)
	F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"LMO",V.DataView.RLine!MLine(V.Local.i).LMO!FieldVal,"Part_WC_Outside",V.Local.sPart.Trim,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Set_Up",V.Local.fSetUp,"Run_Time",V.Local.fRunTime,"UM_Inventory",V.Local.sTemp(0).Trim,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sTemp(1).Trim,"Cuts",V.Local.sCuts)	
		
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataTable.DeleteRow("dtRouter")
F.Data.DataTable.AcceptChanges("dtRouter")

F.ODBC.Connection!Con.OpenCompanyConnection

F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtRouterTemp.RowCount--,1)
'	V.Local.fRunTime.Set(V.DataTable.dtRouterTemp(V.Local.i).Run_Time!FieldValFloat)
'	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
'	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
'		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.EndIf
'	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
	V.Local.fRunTime.Set(0)

	F.Intrinsic.String.Build("Select Top 1 Length, Width From V_Inventory_Mst2 Where Part = '{0}'",V.DataTable.dtRouterTemp(V.Local.i).Part_WC_Outside!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sTemp)
	F.Intrinsic.String.Split(V.Local.sTemp,"*!*",V.Local.sTemp)
	V.Local.fLen.Set(V.Local.sTemp.Float)
	V.Local.fWid.Set(V.Local.sTemp(1).Float)
	F.Intrinsic.String.IsInString(V.DataTable.dtRouterTemp(V.Local.i).Cuts!FieldValTrim,"X",True,V.Local.bSheet)
	F.Intrinsic.String.Split(V.DataTable.dtRouterTemp(V.Local.i).Cuts!FieldValTrim,"|",V.Local.sCuts)
	F.Intrinsic.Control.If(V.Local.bSheet)
		F.Data.DataTable.Create("Sheet",True)
		F.Data.DataTable.AddColumn("Sheet","Len",Float)
		F.Data.DataTable.AddColumn("Sheet","Wid",Float)
		F.Data.DataTable.AddColumn("Sheet","Used",Boolean,False)

		F.Intrinsic.Control.For(V.Local.iTemp,0,V.Local.sCuts.UBound,1)
			F.Intrinsic.String.Split(V.Local.sCuts(V.Local.iTemp),":",V.Local.sTemp)
			F.Intrinsic.String.Split(V.Local.sTemp(1).UCase,"X",V.Local.sTemp2)
			F.Intrinsic.Control.For(V.Local.iCuts,1,V.Local.sTemp.Long,1)
				F.Data.DataTable.AddRow("Sheet","Len",V.Local.sTemp2,"Wid",V.Local.sTemp2(1))
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Next(V.Local.iTemp)

		F.Data.DataView.Create("Sheet","VSheet",22,"Used = False","Len,Wid")
		F.Intrinsic.Control.DoUntil(V.DataView.Sheet!VSheet.RowCount--,=,-1)
			F.Data.DataTable.Create("Drop",True)
			F.Data.DataTable.AddColumn("Drop","Len",Float)
			F.Data.DataTable.AddColumn("Drop","Wid",Float)
			F.Data.DataTable.AddColumn("Drop","ID",Long)
			F.Data.DataTable.AddRow("Drop","Len",V.Local.fLen,"Wid",V.Local.fWid,"ID",1)
			V.Local.fCurrentSheetRunTime.Set(0)
			F.Intrinsic.Control.For(V.Local.iCuts,V.DataView.Sheet!VSheet.RowCount--,0,-1)
				F.Intrinsic.Control.If(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,>=,V.Local.fLen,"AND",V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,>=,V.Local.fWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Data.DataView.SetValue("Sheet","VSheet",V.Local.iCuts,"Used",True)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Len >= {0} and Wid >= {1}",V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.sFilter)
					F.Data.DataView.Create("Drop","VDrop",22,V.Local.sFilter,"Len,Wid")
					F.Intrinsic.Control.If(V.DataView.Drop!VDrop.RowCount--,<>,-1)
						V.Local.iID.Set(V.DataView.Drop!VDrop(0).ID!FieldValLong)
						F.Intrinsic.Control.If(V.DataView.Drop!VDrop(0).Len!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,"AND",V.DataView.Drop!VDrop(0).Wid!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							V.Local.sTemp.Redim(0,3)
							V.Local.sTemp2.Redim(0,3)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Wid!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp2)
							V.Local.sTemp.Set(V.Local.fTemp)
							V.Local.sTemp(1).Set(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal)
							V.Local.sTemp(2).Set(V.Local.fTemp)
							V.Local.sTemp(3).Set(V.DataView.Drop!VDrop(0).Len!FieldVal)
							V.Local.sTemp2.Set(V.DataView.Drop!VDrop(0).Wid!FieldVal)
							V.Local.sTemp2(1).Set(V.Local.fTemp2)
							V.Local.sTemp2(2).Set(V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							V.Local.sTemp2(3).Set(V.Local.fTemp2)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(0),"Wid",V.Local.sTemp2(0))
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(1),"Wid",V.Local.sTemp2(1))
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(2),"Wid",V.Local.sTemp2(2))
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(3),"Wid",V.Local.sTemp2(3))
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.ElseIf(V.DataView.Drop!VDrop(0).Len!FieldVal,=,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,"AND",V.DataView.Drop!VDrop(0).Wid!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Wid!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp2)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.DataView.Drop!VDrop(0).Len!FieldVal,"Wid",V.Local.fTemp2)
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.fTemp,"Wid",V.DataView.Drop!VDrop(0).Wid!FieldVal)
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Mult(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp)
						F.Intrinsic.Math.Add(V.Local.fCurrentSheetRunTime,V.Local.fTemp,V.Local.fCurrentSheetRunTime)
						F.Data.DataView.SetValue("Sheet","VSheet",V.Local.iCuts,"Used",True)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("Drop","VDrop")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.iCuts,=,0)
					F.Intrinsic.Control.If(V.DataView.Sheet!VSheet.RowCount--,=,-1)
						F.Intrinsic.Math.Mult(V.Local.fLen,V.Local.fWid,V.Local.fTemp)
						F.Intrinsic.Math.Div(V.Local.fCurrentSheetRunTime,V.Local.fTemp,V.Local.fTemp)
						F.Intrinsic.Control.If(V.Local.fTemp,>,.75)
							F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
						F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.50)
							F.Intrinsic.Math.Add(V.Local.fRunTime,.75,V.Local.fRunTime)
						F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.25)
							F.Intrinsic.Math.Add(V.Local.fRunTime,.50,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.Local.fRunTime,.25,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCuts)
			
			F.Data.DataTable.Close("Drop")
		F.Intrinsic.Control.Loop
		F.Data.DataView.Close("Sheet","VSheet")
		F.Data.DataTable.Close("Sheet")
	F.Intrinsic.Control.Else
		F.Data.DataTable.Create("Stick",True)
		F.Data.DataTable.AddColumn("Stick","Len",Float)
		F.Data.DataTable.AddColumn("Stick","Used",Boolean,False)
		F.Intrinsic.Control.For(V.Local.iTemp,0,V.Local.sCuts.UBound,1)
			F.Intrinsic.String.Split(V.Local.sCuts(V.Local.iTemp),":",V.Local.sTemp)
			F.Intrinsic.Control.For(V.Local.iCuts,1,V.Local.sTemp.Long,1)
				F.Data.DataTable.AddRow("Stick","Len",V.Local.sTemp(1))
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Next(V.Local.iTemp)

		F.Data.DataView.Create("Stick","VStick",22,"Used = False","Len")
		F.Intrinsic.Control.DoUntil(V.DataView.Stick!VStick.RowCount--,=,-1)
			V.Local.fRem.Set(V.Local.fLen)
			F.Intrinsic.Control.For(V.Local.iCuts,V.DataView.Stick!VStick.RowCount--,0,-1)
				F.Intrinsic.Control.If(V.DataView.Stick!VStick(V.Local.iCuts).Len!FieldVal,>=,V.Local.fLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Data.DataView.SetValue("Stick","VStick",V.Local.iCuts,"Used",True)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Sub(V.Local.fRem,V.DataView.Stick!VStick(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
					F.Intrinsic.Control.If(V.Local.fTemp,>,0)
						V.Local.fRem.Set(V.Local.fTemp)
						F.Intrinsic.Control.If(V.DataView.Stick!VStick.RowCount--,=,0)
							F.Intrinsic.Math.Sub(V.Local.fLen,V.Local.fRem,V.Local.fTemp)
							F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fLen,V.Local.fTemp)
							F.Intrinsic.Control.If(V.Local.fTemp,>,.75)
								F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
							F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.50)
								F.Intrinsic.Math.Add(V.Local.fRunTime,.75,V.Local.fRunTime)
							F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.25)
								F.Intrinsic.Math.Add(V.Local.fRunTime,.50,V.Local.fRunTime)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Add(V.Local.fRunTime,.25,V.Local.fRunTime)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Data.DataView.SetValue("Stick","VStick",V.Local.iCuts,"Used",True)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.Local.iCuts,=,0)
							F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Loop
		F.Data.DataView.Close("Stick","VStick")
		F.Data.DataTable.Close("Stick")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.If(V.DataTable.Bolt.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Bolt.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("Bolt - {0}",V.DataTable.Bolt(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.Bolt(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.Bolt(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.Bolt(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Brace.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Brace.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("Lag - {0}",V.DataTable.Brace(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.Brace(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.Brace(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.Brace(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.AddMat.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.AddMat.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("AddMat - {0}",V.DataTable.AddMat(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.AddMat(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.AddMat(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.AddMat(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

'F.Data.DataView.Create("TempCuts","Temp",22,"","")
'F.Data.DataView.ToDataTableDistinct("TempCuts","Temp","Mat","Part_WC_Outside",True)
'F.Data.DataView.Close("TempCuts","Temp")
'F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Mat.RowCount--,1)
'	F.Intrinsic.Math.Add(1000000,V.Local.i,V.Local.iTemp)
'	F.Intrinsic.String.Build("Part_WC_Outside = '{0}'",V.DataTable.Mat(V.Local.i).Part_WC_Outside!FieldValTrim,V.Local.sFilter)
'	F.Data.DataView.Create("TempCuts","Temp",22,V.Local.sFilter,"")
'	F.Data.DataView.ToDataTable("TempCuts","Temp","SumRun",True)
'	F.Data.Datatable.AddExpressionColumn("SumRun","sumruntime",Float,"Sum(Run_Time)")
'	F.Data.DataView.Close("TempCuts","Temp")
'	V.Local.fRunTime.Set(V.DataTable.SumRun(V.DataTable.SumRun.RowCount--).SumRunTime!FieldValFloat)
'	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
'	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
'		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.EndIf
'	F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.iTemp,"LMO","Material Sum","Part_WC_Outside",V.DataTable.Mat(V.Local.i).Part_WC_Outside!FieldValTrim,"Run_Time",V.Local.fRunTime)
'	F.Data.Datatable.Close("SumRun")
'F.Intrinsic.Control.Next(V.Local.i)

'F.Data.Datatable.Close("Mat")

F.Data.DataTable.Merge("dtRouterTemp","dtRouter",4,2)

F.Data.DataView.Close("RLine","MLine")

Gui.FormShell..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdShellCalc_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdShellCalc_Click.End

Program.Sub.txtNotes_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtNotes_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtNotes.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtNotes_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtNotes_GotFocus.End

Program.Sub.cmdShellTemplate_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdShellTemplate_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.ODBC.Connection!Con.OpenCompanyConnection

V.Local.sSql.Set("Select rtrim(Router), rtrim(Description_Router) From V_Router_Header Where ltrim(rtrim(ucase(Sort_1))) = 'SHELL TEMPLATE' Order by Router")

V.Local.sTitles.Set("Router*!*Description")
V.Local.sWidths.Set("1800*!*2400")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.Intrinsic.UI.Browser("Select Template","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormShell.txtShellTemplate.Text(V.Local.sRet.UCase)
'	Gui.FormShell.txtShellDesc.Text(V.Local.sRet.UCase)
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(Get_Data_Shell)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdShellTemplate_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdShellTemplate_Click.End

Program.Sub.txtShellLen_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellLen_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)
V.Local.sValue.Declare(String,"")

F.Intrinsic.Control.BlockEvents

Gui.FormShell.txtShellLen.Enabled(True)

V.Local.sValue.Set(V.Screen.FormShell!txtShellLen.Text)

F.Intrinsic.Control.If(V.Datatable.CrateCalc.Exists,=,False,"OR",V.Local.sValue.Trim,=,"")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)
V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
		
		
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Qty like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtLRun.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CL[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellLen_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellLen_LostFocus.End

Program.Sub.txtShellWidth_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellWidth_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

F.Intrinsic.Control.BlockEvents

Gui.FormShell.txtShellWidth.Enabled(True)

F.Intrinsic.Control.If(V.Datatable.CrateCalc.Exists,=,False)
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)
V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Qty like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtLRun.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellWidth_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellWidth_LostFocus.End

Program.Sub.txtShellHeight_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtShellHeight_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

F.Intrinsic.Control.BlockEvents

Gui.FormShell.txtShellHeight.Enabled(True)

F.Intrinsic.Control.If(V.Datatable.CrateCalc.Exists,=,False)
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)
V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtRunQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Qty like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW2)
				F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("T STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormShell.txtTStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("B STRG")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtBStrg.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("RUN")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtLRun.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CH[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("SIDE 1")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide1Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("SIDE 2")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlSide2Mat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("TOP")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTopMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtShellHeight_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtShellHeight_LostFocus.End

Program.Sub.txtTStrg_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTStrg_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTStrg.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTStrg_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTStrg_GotFocus.End

Program.Sub.txtTStrgQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTStrgQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTStrgQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTStrgQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTStrgQty_GotFocus.End

Program.Sub.txtBStrg_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtBStrg_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtBStrg.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtBStrg_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtBStrg_GotFocus.End

Program.Sub.txtBstrgQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtBstrgQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtBstrgQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtBstrgQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtBstrgQty_GotFocus.End

Program.Sub.txtLRun_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtLRun_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtLRun.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtLRun_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtLRun_GotFocus.End

Program.Sub.txtRunQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtRunQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtRunQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtRunQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtRunQty_GotFocus.End

Program.Sub.txtSide1QtyDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1QtyDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1QtyDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1QtyDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1QtyDim1_GotFocus.End

Program.Sub.txtSide1CutLenDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1CutLenDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1CutLenDim1_GotFocus.End

Program.Sub.txtSide1QtyDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1QtyDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1QtyDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1QtyDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1QtyDim2_GotFocus.End

Program.Sub.txtSide1CutLenDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide1CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide1CutLenDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide1CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide1CutLenDim2_GotFocus.End

Program.Sub.txtSide2QtyDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2QtyDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2QtyDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2QtyDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2QtyDim1_GotFocus.End

Program.Sub.txtSide2CutLenDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2CutLenDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2CutLenDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2CutLenDim1_GotFocus.End

Program.Sub.txtSide2QtyDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2QtyDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2QtyDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2QtyDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2QtyDim2_GotFocus.End

Program.Sub.txtSide2CutLenDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSide2CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtSide2CutLenDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSide2CutLenDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSide2CutLenDim2_GotFocus.End

Program.Sub.txtTopQtyDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopQtyDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopQtyDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopQtyDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopQtyDim1_GotFocus.End

Program.Sub.txtTopCutLenDim1_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopCutLenDim1_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopCutLenDim1.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopCutLenDim1_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopCutLenDim1_GotFocus.End

Program.Sub.txtTopQtyDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopQtyDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopQtyDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopQtyDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopQtyDim2_GotFocus.End

Program.Sub.txtTopCutLenDim2_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTopCutLenDim2_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormShell.txtTopCutLenDim2.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTopCutLenDim2_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTopCutLenDim2_GotFocus.End

Program.Sub.ddlTStrgMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlTStrgMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlTStrgMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'T STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTStrgQty.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'T STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTStrg.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlTStrgMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlTStrgMat_SelectedIndexChanged.End

Program.Sub.ddlBStrg_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlBStrg_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlBStrg.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'B STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtBstrgQty.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'B STRG'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtBstrg.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlBStrg_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlBStrg_SelectedIndexChanged.End

Program.Sub.ddlRunMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlRunMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'RUN'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtRunQty.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'RUN'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtLRun.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlRunMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlRunMat_SelectedIndexChanged.End

Program.Sub.ddlSide1Mat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlSide1Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1QtyDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1CutLenDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1QtyDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'SIDE 1'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide1CutLenDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlSide1Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlSide1Mat_SelectedIndexChanged.End

Program.Sub.ddlSide2Mat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlSide2Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2QtyDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2CutLenDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2QtyDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'SIDE 2'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtSide2CutLenDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlSide2Mat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlSide2Mat_SelectedIndexChanged.End

Program.Sub.ddlTopMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlTopMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fHeight.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)

V.Local.fLength.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fWidth.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fHeight.Set(V.Screen.FormShell!txtShellHeight.Text)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormShell!ddlRunMat.Text,V.Local.sSql)
F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
F.ODBC.Connection!con.Close

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Qty like '*[[]MW[]]*' or Dim1Qty like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopQtyDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim1Form like '*[[]MW[]]*' or Dim1Form like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopCutLenDim1.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Qty like '*[[]MW[]]*' or Dim2Qty like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
	F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.Else
		F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopQtyDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"(Dim2Form like '*[[]MW[]]*' or Dim2Form like '*[[]ML[]]*') and OpCode = 'TOP'","")

F.Intrinsic.Control.If(V.DataView.CrateCalc!Temp.RowCount--,<>,-1)
	F.Intrinsic.String.Replace(V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[CH]",V.Local.fHeight,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
	F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
	F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
	F.Intrinsic.Control.If(V.Local.sEval,<>,"")
		F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
	F.Intrinsic.Control.Else
		V.Local.fQty1.Set(0)
	F.Intrinsic.Control.EndIf
	gui.FormShell.txtTopCutLenDim2.Text(V.Local.fQty1)
F.Intrinsic.Control.EndIf

F.Data.DataView.Close("CrateCalc","Temp")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlTopMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlTopMat_SelectedIndexChanged.End

Program.Sub.Get_Shell_Runtime.Start
F.Intrinsic.Control.SetErrorHandler("Get_Shell_Runtime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fTemp1.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.fTemp3.Declare(Float,0)
V.Local.fSqft.Declare(Float,0)
V.Local.fMLen.Declare(Float,0)
V.Local.fMWid.Declare(Float,0)
V.Local.fCL.Declare(Float,0)
V.Local.fCW.Declare(Float,0)
V.Local.fCH.Declare(Float,0)
V.Local.fCP1.Declare(Float,0)
V.Local.fCP2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fRunTime.Declare(Float,0)
V.Local.fRunTime1.Declare(Float,0)
V.Local.fRunTime2.Declare(Float,0)
V.Local.sCuts.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.fRemLen.Declare(Float,0)
V.Local.fRemWid.Declare(Float,0)
V.Local.sTempCut1.Declare(String,"")
V.Local.sTempCut2.Declare(String,"")
V.Local.sTempCut3.Declare(String,"")
V.Local.sTempCut4.Declare(String,"")
V.Local.fTempRunTime1.Declare(Float,0)
V.Local.fHalfLen.Declare(Float,0)
V.Local.fHalfWid.Declare(Float,0)

V.Local.fCL.Set(V.Screen.FormShell!txtShellLen.Text)
V.Local.fCW.Set(V.Screen.FormShell!txtShellWidth.Text)
V.Local.fCH.Set(V.Screen.FormShell!txtShellHeight.Text)

V.Local.fMWid.Set(V.Args.Wid)
F.Intrinsic.Math.Div(V.Local.fMWid,2,V.Local.fHalfWid)
V.Local.fMLen.Set(V.Args.Len)
F.Intrinsic.Math.Div(V.Local.fMLen,2,V.Local.fHalfLen)

F.Intrinsic.Control.SelectCase(V.DataView.RLine!MLine(V.Args.Index).Operation!FieldValTrim)
	F.Intrinsic.Control.Case("SIDE 1")
		V.Local.fCP1.Set(V.Screen.FormShell!txtSide1QtyDim1.Text)
		V.Local.fCP2.Set(V.Screen.FormShell!txtSide1QtyDim2.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtSide1CutLenDim1.Text)
		V.Local.fRunTime2.Set(V.Screen.FormShell!txtSide1CutLenDim2.Text)
		
	F.Intrinsic.Control.Case("SIDE 2")
		V.Local.fCP1.Set(V.Screen.FormShell!txtSide2QtyDim1.Text)
		V.Local.fCP2.Set(V.Screen.FormShell!txtSide2QtyDim2.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtSide2CutLenDim1.Text)
		V.Local.fRunTime2.Set(V.Screen.FormShell!txtSide2CutLenDim2.Text)	
			
	F.Intrinsic.Control.Case("TOP")
		V.Local.fCP1.Set(V.Screen.FormShell!txtTopQtyDim1.Text)
		V.Local.fCP2.Set(V.Screen.FormShell!txtTopQtyDim2.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtTopCutLenDim1.Text)
		V.Local.fRunTime2.Set(V.Screen.FormShell!txtTopCutLenDim2.Text)		
			
	F.Intrinsic.Control.Case("T STRG")
		V.Local.fCP1.Set(V.Screen.FormShell!txtTStrgQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtTStrg.Text)	
		V.Local.fCP2.Set(0)
		V.Local.fRunTime2.Set(0)
		
	F.Intrinsic.Control.Case("B STRG")
		V.Local.fCP1.Set(V.Screen.FormShell!txtBstrgQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtBStrg.Text)		
		V.Local.fCP2.Set(0)
		V.Local.fRunTime2.Set(0)
		
	F.Intrinsic.Control.Case("RUN")
		V.Local.fCP1.Set(V.Screen.FormShell!txtRunQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormShell!txtLRun.Text)	
		V.Local.fCP2.Set(0)
		V.Local.fRunTime2.Set(0)
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.If(V.Local.fCP1,>,0,"AND",V.Local.fCP2,>,0)
	V.Local.fTemp1.Set(V.Local.fRunTime1)
	V.Local.fTemp2.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
	F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
	F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fRunTime)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sTempCut1)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut1,V.Local.fCP1,V.Local.fTemp3,V.Local.sTempCut1)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sTempCut1)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.fTemp2,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fMLen,V.Local.sTempCut2)
		F.Intrinsic.Math.Sub(V.Local.fTemp2,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut2,V.Local.fCP2,V.Local.fTemp3,V.Local.sTempCut2)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.fTemp2,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fTemp2,V.Local.sTempCut2)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("{0} | {1}",V.Local.sTempCut1,V.Local.sTempCut2,V.Local.sCuts)
	
F.Intrinsic.Control.ElseIf(V.Local.fCP1,>,0,"AND",V.Local.fCP2,<=,0)
	V.Local.fTemp1.Set(V.Local.fRunTime1)
	F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
	V.Local.fRunTime.Set(V.Local.fRunTime1)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
	F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.ElseIf(V.Local.fCP1,<=,0,"AND",V.Local.fCP2,>,0)
	V.Local.fTemp1.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
	V.Local.fRunTime.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
	F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.EndIf
			
F.Intrinsic.Variable.AddRV("RunTime",V.Local.fRunTime,"Cuts",V.Local.sCuts)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Shell_Runtime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Shell_Runtime.End

Program.Sub.FormShell_SaveButtonClick.Start
F.Intrinsic.Control.SetErrorHandler("FormShell_SaveButtonClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sDesc.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sComment.Declare(String,"")
V.Local.iSeq.Declare(Long,0)
V.Local.sSeq.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sRunTime.Declare(String,"")
V.Local.sRate.Declare(String,"")
V.Local.sSetup.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sMDesc.Declare(String,"")
V.Local.iTime.Declare(Long,0)
V.Local.fTemp.Declare(Float,0)
V.Local.sTemp.Declare(String,"")
V.Local.sExtraDesc.Declare(String,"")

F.Intrinsic.Control.BlockEvents

V.Local.iTime.Set(V.Screen.FormShell!txtRtrTime.Text)
F.Intrinsic.Control.If(V.Local.iTime,<=,0)
	F.Intrinsic.UI.Msgbox("Enter Time in Mins for a Single Crate","Attention")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Format(V.Ambient.Date,"MMDDYY",V.Local.sDate)

'F.Intrinsic.String.Build("Crate {0}x{1}x{2}",V.Screen.FormShell!txtShellLen.Text,V.Screen.FormShell!txtShellWidth.Text,V.Screen.FormShell!txtShellHeight.Text,V.Local.sDesc)

V.Local.sDesc.Set(V.Screen.FormShell!txtShellDesc.Text)

V.Local.sExtraDesc.Set(V.Screen.FormShell!txtExtraShellDesc.Text)

F.Intrinsic.Control.If(v.Local.sDesc.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Enter in a Description","Attention")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sDesc.Length,>,30)
	F.Intrinsic.String.Left(V.Local.sDesc,30,V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Part From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

V.Local.sPL.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
V.Local.sUM.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim)

F.Intrinsic.Control.If(V.Local.sPart.Trim,=,V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
	F.Global.Inventory.CreatePart(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim,V.Local.sDesc,"",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"F","","",0,"NOMAINT")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Update Inventory_Mstr Set Description = '{1}' Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sDesc.Trim,V.Local.sSql)
	F.ODBC.Connection!Con.Execute(V.Local.sSql)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Part From INV_EXTRA_TEXT Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
F.Intrinsic.Control.If(V.Local.sSql.Trim,<>,"")
	F.Intrinsic.String.Build("Update INV_EXTRA_TEXT Set Text = '{1}' Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sExtraDesc.Trim,V.Local.sSql)
F.Intrinsic.Control.Else
	f.Intrinsic.String.Build("INSERT INTO INV_EXTRA_TEXT VALUES ('{0}','{1}')",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sExtraDesc.Trim,v.Local.ssql)
F.Intrinsic.Control.EndIf
F.ODBC.Connection!Con.Execute(V.Local.sSql)
		
F.Intrinsic.Control.If(V.DataTable.dtRouter.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Are you sure you want to create a New Part/Router?","New Part/Router",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.RLine.RowCount--,1)
			F.Intrinsic.Control.SelectCase(V.DataTable.RLine(V.Local.i).LMO!FieldValTrim)
				F.Intrinsic.Control.Case("L")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.Math.Mult(V.DataTable.RLine(V.Local.i).Run_Time!FieldValFloat,V.Local.iTime,V.Local.fTemp)
					F.Intrinsic.Math.Div(V.Local.fTemp,60,V.Local.fTemp)
					F.Intrinsic.String.Format(V.Local.fTemp,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","L","WC",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("M")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Build("Line_Router = '{0}'",V.DataTable.RLine(V.Local.i).Line_Router!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
						F.Intrinsic.String.Build("Select Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sMDesc)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.Local.sMDesc.Trim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
					
				F.Intrinsic.Control.Case("O")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","O","PartNum",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("C")
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sComment.Redim(0,0)
					F.Intrinsic.String.Build("Line_Router = '{0}' and LMO = 'M'",V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Split(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim,"|",V.Local.sComment)
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sComment.UBound,1)
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment(V.Local.iC).Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.Else
'							F.Intrinsic.Control.If(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"BOLT")
'								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
'								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
'								F.Intrinsic.Control.If(V.Screen.FormShell!chkBoltTopRun.Value,=,1)
'									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Bolt Top Runners: Yes","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
'								F.Intrinsic.Control.Else
'									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Bolt Top Runners: No","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
'								F.Intrinsic.Control.EndIf
'							F.Intrinsic.Control.ElseIf(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"LAG")
'								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
'								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
'								F.Intrinsic.Control.If(V.Screen.FormShell!chkLagString.Value,=,1)
'									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Lag Stringers: Yes","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
'								F.Intrinsic.Control.Else
'									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","Lag Stringers: No","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
'								F.Intrinsic.Control.EndIf
'								V.Local.sComment.Set(V.Screen.FormShell!txtNotes.Text)
'								F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
'									F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
'									F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
'									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
'								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,=,"STAMP")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Intrinsic.Control.If(V.Screen.FormShell!chkShellHT.Value,=,1)
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","HT Stamp: Yes","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.Else
									F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc","HT Stamp: No","PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.UnBlockEvents
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.6021.RowCount--,<>,-1)
	V.Local.iSeq.Set(V.DataTable.6021(V.DataTable.6021.RowCount--).Seq!FieldValLong)
	F.Intrinsic.Control.If(V.DataTable.Bolt.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Bolt.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'Bolt - {0}'",V.DataTable.Bolt(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.Bolt(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.Bolt(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.Brace.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Brace.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'Lag - {0}'",V.DataTable.Brace(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.Brace(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.Brace(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.Brace(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.AddMat.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.AddMat.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'AddMat - {0}'",V.DataTable.AddMat(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
				
					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.AddMat(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.AddMat(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("Delete From Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.String.Build("Delete From ROUTER_SUPP_HDR Where Rtr_Num = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.CallSub(6021Sync)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!con.Close

F.Data.Datatable.DeleteRow("6021")
F.Data.Datatable.AcceptChanges("6021")

'F.Global.General.CallWrappersync(50,"RE0017")

F.Data.DataTable.AddRow("400000","Mode","O","Router",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)

F.Intrinsic.Control.CallSub(400000Sync)

F.Data.DataTable.AddRow("1500","ROUTER",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"Quantity",1)
F.Intrinsic.Control.CallSub(1500sync)

F.Intrinsic.Control.CallSub(Get_Cost)

V.Passed.000052.Set(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
V.Passed.000056.Set(V.Local.sDesc.Trim)
v.Passed.000006.Set(V.Local.sUM)
V.Passed.000013.Set(V.Local.sPL)

F.Intrinsic.Control.CallSub(FormShell_UnLoad)

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormShell_SaveButtonClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormShell_SaveButtonClick.End

Program.Sub.cmdSKID_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSKID_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

V.Global.sSelection.Set("SKID")
Gui.FormCrateSel..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSKID_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormShell_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdSKID_Click.End

Program.Sub.txtSkidLen_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSkidLen_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtSkidLen.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSkidLen_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSkidLen_GotFocus.End

Program.Sub.txtSkidWidth_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSkidWidth_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtSkidWidth.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSkidWidth_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSkidWidth_GotFocus.End

Program.Sub.txtSkidWidth_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSkidWidth_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

'octsrs is currently disabling this txt box before the lost focus event runs
Gui.FormSkid.txtSkidWidth.Enabled(True)

F.Intrinsic.Control.If(V.Datatable.CrateCalc.Exists,=,False)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

V.Local.fLength.Set(V.Screen.FormSkid!txtSkidLen.Text)
V.Local.fWidth.Set(V.Screen.FormSkid!txtSkidWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)	
		F.Intrinsic.Control.Case("BASE T")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormSkid.txtTQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE B")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtBQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE R")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtRQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)	
		F.Intrinsic.Control.Case("BASE T")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormSkid.txtTLen.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE B")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtBLen.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE R")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtRLen.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("BASE T")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtTWid.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("BASE B")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtBWid.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSkidWidth_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSkidWidth_LostFocus.End

Program.Sub.txtSkidLen_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSkidLen_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.sSql.Declare(String,"")
V.Local.sEval.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fMatLen.Declare(Float,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)

'octsrs is currently disabling this txt box before the lost focus event runs
Gui.FormSkid.txtSkidLen.Enabled(True)

F.Intrinsic.Control.If(V.Datatable.CrateCalc.Exists,=,False)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

V.Local.fLength.Set(V.Screen.FormSkid!txtSkidLen.Text)
V.Local.fWidth.Set(V.Screen.FormSkid!txtSkidWidth.Text)

F.ODBC.Connection!Con.OpenCompanyConnection

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Qty like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)	
		F.Intrinsic.Control.Case("BASE T")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			gui.FormSkid.txtTQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE B")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtBQty.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE R")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.Local.bMW1)
				F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
				F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
					F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtRQty.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim1Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)	
		F.Intrinsic.Control.Case("BASE T")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			gui.FormSkid.txtTLen.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE B")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtBLen.Text(V.Local.fQty1)
			
		F.Intrinsic.Control.Case("BASE R")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
			F.Intrinsic.Control.Else
				V.Local.fQty1.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtRLen.Text(V.Local.fQty1)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.Data.DataView.Create("CrateCalc","Temp",22,"Dim2Form like '*[[]CW[]]*'","")

F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
		F.Intrinsic.Control.Case("BASE T")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtTWid.Text(V.Local.fQty2)
			
		F.Intrinsic.Control.Case("BASE B")
			F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
			F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
			F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
			F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
			F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
			F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
			F.Intrinsic.Control.If(V.Local.sEval,<>,"")
				F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
			F.Intrinsic.Control.Else
				V.Local.fQty2.Set(0)
			F.Intrinsic.Control.EndIf
			Gui.FormSkid.txtBWid.Text(V.Local.fQty2)
			
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close("CrateCalc","Temp")

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSkidLen_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSkidLen_LostFocus.End

Program.Sub.cmdSkidCalc_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSkidCalc_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.iTemp.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.sStart.Declare(String,"")
V.Local.fSetUp.Declare(Float,0)
V.Local.fRunTime.Declare(Float,0)
V.Local.fRate.Declare(Float,0)
V.Local.sFilter.Declare(String,"")
V.Local.sCuts.Declare(String,"")
V.Local.sMsg.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sQuote.Declare(String,"")
V.Local.sLine.Declare(String,"")
V.Local.iCuts.Declare(Long,0)
V.Local.bSheet.Declare(Boolean,False)
V.Local.fLen.Declare(Float,0)
V.Local.fWid.Declare(Float,0)
V.Local.fRem.Declare(Float,0)
V.Local.fTemp.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.iID.Declare(Long,0)
V.Local.iNID.Declare(Long,0)
V.Local.fCurrentSheetRunTime.Declare(Float,0)
V.Local.sTemp2.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sDesc.Declare(String,"")

F.Intrinsic.Control.If(V.Screen.FormSkid!txtSkidTemplate.Text,=,"")
	V.Local.sMsg.Set("Select a Template Router")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormSkid!txtSkidLen.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Skid/Pallet Length Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Skid/Pallet Length Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.FormSkid!txtSkidWidth.Text,=,"")
	F.Intrinsic.Control.If(V.Local.sMsg.Trim,=,"")
		V.Local.sMsg.Set("Skid/Pallet Width Missing")
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0} and Skid/Pallet Width Missing")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sMsg.Trim,<>,"")
	F.Intrinsic.UI.Msgbox(V.Local.sMsg,"Attention")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

Gui.FormSkid..Enabled(False)

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Sort_2 From V_Router_Header Where Router = '{0}'",V.Screen.FormSkid!txtSkidTemplate.Text,V.Local.sStart)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sStart,V.Local.sStart)
V.Global.sSort.Set(V.Local.sStart.Trim)
F.ODBC.Connection!Con.Close

F.Intrinsic.String.LPad(V.Passed.000060,"0",6,V.Local.sQuote)
F.Intrinsic.String.LPad(V.Passed.000051,"0",3,V.Local.sLine)

F.Intrinsic.String.Build("{0}{1}{2}{3}",V.Passed.000112,V.Global.sSort,V.Local.sQuote,V.Local.sLine,V.Local.sRouter)

'F.Intrinsic.String.Build("{0}x{1}x{2}",V.Screen.FormSkid!txtShellLen.Text,V.Screen.FormSkid!txtShellWidth.Text,V.Screen.FormSkid!txtShellHeight.Text,V.Local.sRouter)

'F.Intrinsic.String.Build("{0}-{1}",V.Local.sStart.Trim,V.Local.sRouter,V.Local.sRouter)

V.Local.sDesc.Set(V.Screen.FormSkid!txtSkidDesc.Text)
F.Intrinsic.Control.If(V.Local.sDesc.Trim,=,"")
	F.Intrinsic.String.Build("Crate: {0}x{1}",V.Screen.FormSkid!txtSkidLen.Text,V.Screen.FormSkid!txtSkidWidth.Text,V.Local.sDesc)
	Gui.FormSkid.txtSkidDesc.Text(V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("{0}-{1} Crate: {2}x{3}",V.Passed.000112.Trim,V.Screen.FormSkid!txtSkidTemplate.Text,V.Screen.FormSkid!txtSkidLen.Text,V.Screen.FormSkid!txtSkidWidth.Text,V.Local.sDesc)

Gui.FormSkid.txtSkidExtraDesc.Text(V.Local.sDesc)

F.Data.DataTable.DeleteRow("dtRouterTemp")
F.Data.DataTable.AcceptChanges("dtRouterTemp")

F.Data.DataTable.DeleteRow("TempCuts")
F.Data.DataTable.AcceptChanges("TempCuts")

F.Data.DataView.Create("RLine","MLine",22,"LMO = 'M'","Line_Router")
F.Intrinsic.Control.For(V.Local.i,0,V.DataView.RLine!MLine.RowCount--,1)
	F.Intrinsic.Control.SelectCase(V.DataView.RLine!MLine(V.Local.i).Operation!FieldValTrim)
		F.Intrinsic.Control.Case("BASE T")
			V.Local.sPart.Set(V.Screen.FormSkid!ddlTMat.Text)
			
		F.Intrinsic.Control.Case("BASE B")
			V.Local.sPart.Set(V.Screen.FormSkid!ddlBMat.Text)
			
		F.Intrinsic.Control.Case("BASE R")
			V.Local.sPart.Set(V.Screen.FormSkid!ddlRMat.Text)
			
	F.Intrinsic.Control.EndSelect
	
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Intrinsic.String.Build("Select Top 1 a.UM_Inventory, a.Description, b.Cost, c.Length, c.Width From V_Inventory_Mstr a Left Join V_Inventory_Cost b on a.Part = b.Part and a.Location = b.Locn Left Join V_Inventory_Mst2 c on a.Part = c.Part and a.Location = c.Location Where a.Part = '{0}'",V.Local.sPart.Trim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sTemp)
	F.ODBC.Connection!Con.Close
	F.Intrinsic.String.Split(V.Local.sTemp,"*!*",V.Local.sTemp)
	V.Local.sTemp.RedimPreserve(0,4)
	
	F.Intrinsic.Control.If(V.Local.sTemp(2),<>,"")
		V.Local.fRate.Set(V.Local.sTemp(2).Float)
	F.Intrinsic.Control.Else
		V.Local.fRate.Set(V.DataView.RLine!MLine(V.Local.i).Rate!FieldVal)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.sTemp(3),=,"")
		V.Local.sTemp(3).Set("1")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.sTemp(4),=,"")
		V.Local.sTemp(4).Set("1")
	F.Intrinsic.Control.EndIf
	V.Local.fSetUp.Set(V.DataView.RLine!MLine(V.Local.i).Set_Up!FieldVal)
	F.Intrinsic.Control.CallSub(Get_Skid_Runtime,"Index",V.Local.i,"Len",V.Local.sTemp(3).Float,"Wid",V.Local.sTemp(4).Float)
	V.Local.fRunTime.Set(V.Args.RunTime)
	V.Local.sCuts.Set(V.Args.Cuts)
	
	F.Data.Datatable.AddRow("TempCuts","Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"Part_WC_Outside",V.Local.sPart.Trim,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Run_Time",V.Local.fRunTime)
	F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.DataView.RLine!MLine(V.Local.i).Line_Router!FieldVal,"LMO",V.DataView.RLine!MLine(V.Local.i).LMO!FieldVal,"Part_WC_Outside",V.Local.sPart.Trim,"Operation",V.DataView.RLine!MLine(V.Local.i).Operation!FieldVal,"Set_Up",V.Local.fSetUp,"Run_Time",V.Local.fRunTime,"UM_Inventory",V.Local.sTemp(0).Trim,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sTemp(1).Trim,"Cuts",V.Local.sCuts)	
		
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataTable.DeleteRow("dtRouter")
F.Data.DataTable.AcceptChanges("dtRouter")

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtRouterTemp.RowCount--,1)
'	V.Local.fRunTime.Set(V.DataTable.dtRouterTemp(V.Local.i).Run_Time!FieldValFloat)
'	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
'	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
'		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.EndIf
'	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
	V.Local.fRunTime.Set(0)

	F.Intrinsic.String.Build("Select Top 1 Length, Width From V_Inventory_Mst2 Where Part = '{0}'",V.DataTable.dtRouterTemp(V.Local.i).Part_WC_Outside!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sTemp)
	F.Intrinsic.String.Split(V.Local.sTemp,"*!*",V.Local.sTemp)
	V.Local.fLen.Set(V.Local.sTemp.Float)
	V.Local.fWid.Set(V.Local.sTemp(1).Float)
	F.Intrinsic.String.IsInString(V.DataTable.dtRouterTemp(V.Local.i).Cuts!FieldValTrim,"X",True,V.Local.bSheet)
	F.Intrinsic.String.Split(V.DataTable.dtRouterTemp(V.Local.i).Cuts!FieldValTrim,"|",V.Local.sCuts)
	F.Intrinsic.Control.If(V.Local.bSheet)
		F.Data.DataTable.Create("Sheet",True)
		F.Data.DataTable.AddColumn("Sheet","Len",Float)
		F.Data.DataTable.AddColumn("Sheet","Wid",Float)
		F.Data.DataTable.AddColumn("Sheet","Used",Boolean,False)

		F.Intrinsic.Control.For(V.Local.iTemp,0,V.Local.sCuts.UBound,1)
			F.Intrinsic.String.Split(V.Local.sCuts(V.Local.iTemp),":",V.Local.sTemp)
			F.Intrinsic.String.Split(V.Local.sTemp(1).UCase,"X",V.Local.sTemp2)
			F.Intrinsic.Control.For(V.Local.iCuts,1,V.Local.sTemp.Long,1)
				F.Data.DataTable.AddRow("Sheet","Len",V.Local.sTemp2,"Wid",V.Local.sTemp2(1))
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Next(V.Local.iTemp)

		F.Data.DataView.Create("Sheet","VSheet",22,"Used = False","Len,Wid")
		F.Intrinsic.Control.DoUntil(V.DataView.Sheet!VSheet.RowCount--,=,-1)
			F.Data.DataTable.Create("Drop",True)
			F.Data.DataTable.AddColumn("Drop","Len",Float)
			F.Data.DataTable.AddColumn("Drop","Wid",Float)
			F.Data.DataTable.AddColumn("Drop","ID",Long)
			F.Data.DataTable.AddRow("Drop","Len",V.Local.fLen,"Wid",V.Local.fWid,"ID",1)
			V.Local.fCurrentSheetRunTime.Set(0)
			F.Intrinsic.Control.For(V.Local.iCuts,V.DataView.Sheet!VSheet.RowCount--,0,-1)
				F.Intrinsic.Control.If(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,>=,V.Local.fLen,"AND",V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,>=,V.Local.fWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Data.DataView.SetValue("Sheet","VSheet",V.Local.iCuts,"Used",True)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Len >= {0} and Wid >= {1}",V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.sFilter)
					F.Data.DataView.Create("Drop","VDrop",22,V.Local.sFilter,"Len,Wid")
					F.Intrinsic.Control.If(V.DataView.Drop!VDrop.RowCount--,<>,-1)
						V.Local.iID.Set(V.DataView.Drop!VDrop(0).ID!FieldValLong)
						F.Intrinsic.Control.If(V.DataView.Drop!VDrop(0).Len!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,"AND",V.DataView.Drop!VDrop(0).Wid!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							V.Local.sTemp.Redim(0,3)
							V.Local.sTemp2.Redim(0,3)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Wid!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp2)
							V.Local.sTemp.Set(V.Local.fTemp)
							V.Local.sTemp(1).Set(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal)
							V.Local.sTemp(2).Set(V.Local.fTemp)
							V.Local.sTemp(3).Set(V.DataView.Drop!VDrop(0).Len!FieldVal)
							V.Local.sTemp2.Set(V.DataView.Drop!VDrop(0).Wid!FieldVal)
							V.Local.sTemp2(1).Set(V.Local.fTemp2)
							V.Local.sTemp2(2).Set(V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							V.Local.sTemp2(3).Set(V.Local.fTemp2)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(0),"Wid",V.Local.sTemp2(0))
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(1),"Wid",V.Local.sTemp2(1))
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(2),"Wid",V.Local.sTemp2(2))
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.sTemp(3),"Wid",V.Local.sTemp2(3))
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.ElseIf(V.DataView.Drop!VDrop(0).Len!FieldVal,=,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,"AND",V.DataView.Drop!VDrop(0).Wid!FieldVal,>,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal)
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Wid!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp2)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.DataView.Drop!VDrop(0).Len!FieldVal,"Wid",V.Local.fTemp2)
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.DataTable.Drop(V.DataTable.Drop.RowCount--).ID!FieldValLong,1,V.Local.iNID)
							F.Intrinsic.Math.Sub(V.DataView.Drop!VDrop(0).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
							F.Data.DataTable.AddRow("Drop","ID",V.Local.iNID,"Len",V.Local.fTemp,"Wid",V.DataView.Drop!VDrop(0).Wid!FieldVal)
							F.Intrinsic.String.Build("ID = {0}",V.Local.iID,V.Local.sFilter)
							F.Data.DataView.Create("Drop","Temp",22,V.Local.sFilter,"")
							F.Intrinsic.Control.For(V.Local.iNID,V.DataView.Drop!Temp.RowCount--,0,-1)
								F.Data.DataTable.DeleteRow("Drop",V.DataView.Drop!Temp(V.Local.iNID).DataTableIndex)
							F.Intrinsic.Control.Next(V.Local.iNID)
							F.Data.DataView.Close("Drop","Temp")
							F.Data.DataTable.AcceptChanges("Drop")
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Mult(V.DataView.Sheet!VSheet(V.Local.iCuts).Len!FieldVal,V.DataView.Sheet!VSheet(V.Local.iCuts).Wid!FieldVal,V.Local.fTemp)
						F.Intrinsic.Math.Add(V.Local.fCurrentSheetRunTime,V.Local.fTemp,V.Local.fCurrentSheetRunTime)
						F.Data.DataView.SetValue("Sheet","VSheet",V.Local.iCuts,"Used",True)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("Drop","VDrop")
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.iCuts,=,0)
					F.Intrinsic.Control.If(V.DataView.Sheet!VSheet.RowCount--,=,-1)
						F.Intrinsic.Math.Mult(V.Local.fLen,V.Local.fWid,V.Local.fTemp)
						F.Intrinsic.Math.Div(V.Local.fCurrentSheetRunTime,V.Local.fTemp,V.Local.fTemp)
						F.Intrinsic.Control.If(V.Local.fTemp,>,.75)
							F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
						F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.50)
							F.Intrinsic.Math.Add(V.Local.fRunTime,.75,V.Local.fRunTime)
						F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.25)
							F.Intrinsic.Math.Add(V.Local.fRunTime,.50,V.Local.fRunTime)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Add(V.Local.fRunTime,.25,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCuts)
			
			F.Data.DataTable.Close("Drop")
		F.Intrinsic.Control.Loop
		F.Data.DataView.Close("Sheet","VSheet")
		F.Data.DataTable.Close("Sheet")
	F.Intrinsic.Control.Else
		F.Data.DataTable.Create("Stick",True)
		F.Data.DataTable.AddColumn("Stick","Len",Float)
		F.Data.DataTable.AddColumn("Stick","Used",Boolean,False)
		F.Intrinsic.Control.For(V.Local.iTemp,0,V.Local.sCuts.UBound,1)
			F.Intrinsic.String.Split(V.Local.sCuts(V.Local.iTemp),":",V.Local.sTemp)
			F.Intrinsic.Control.For(V.Local.iCuts,1,V.Local.sTemp.Long,1)
				F.Data.DataTable.AddRow("Stick","Len",V.Local.sTemp(1))
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Next(V.Local.iTemp)

		F.Data.DataView.Create("Stick","VStick",22,"Used = False","Len")
		F.Intrinsic.Control.DoUntil(V.DataView.Stick!VStick.RowCount--,=,-1)
			V.Local.fRem.Set(V.Local.fLen)
			F.Intrinsic.Control.For(V.Local.iCuts,V.DataView.Stick!VStick.RowCount--,0,-1)
				F.Intrinsic.Control.If(V.DataView.Stick!VStick(V.Local.iCuts).Len!FieldVal,>=,V.Local.fLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
					F.Data.DataView.SetValue("Stick","VStick",V.Local.iCuts,"Used",True)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Sub(V.Local.fRem,V.DataView.Stick!VStick(V.Local.iCuts).Len!FieldVal,V.Local.fTemp)
					F.Intrinsic.Control.If(V.Local.fTemp,>,0)
						V.Local.fRem.Set(V.Local.fTemp)
						F.Intrinsic.Control.If(V.DataView.Stick!VStick.RowCount--,=,0)
							F.Intrinsic.Math.Sub(V.Local.fLen,V.Local.fRem,V.Local.fTemp)
							F.Intrinsic.Math.Div(V.Local.fTemp,V.Local.fLen,V.Local.fTemp)
							F.Intrinsic.Control.If(V.Local.fTemp,>,.75)
								F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
							F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.50)
								F.Intrinsic.Math.Add(V.Local.fRunTime,.75,V.Local.fRunTime)
							F.Intrinsic.Control.ElseIf(V.Local.fTemp,>,.25)
								F.Intrinsic.Math.Add(V.Local.fRunTime,.50,V.Local.fRunTime)
							F.Intrinsic.Control.Else
								F.Intrinsic.Math.Add(V.Local.fRunTime,.25,V.Local.fRunTime)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Data.DataView.SetValue("Stick","VStick",V.Local.iCuts,"Used",True)
					F.Intrinsic.Control.Else
						F.Intrinsic.Control.If(V.Local.iCuts,=,0)
							F.Intrinsic.Math.Add(V.Local.fRunTime,1,V.Local.fRunTime)
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCuts)
		F.Intrinsic.Control.Loop
		F.Data.DataView.Close("Stick","VStick")
		F.Data.DataTable.Close("Stick")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.SetValue("dtRouterTemp",V.Local.i,"Run_Time",V.Local.fRunTime)
F.Intrinsic.Control.Next(V.Local.i)

F.Intrinsic.Control.If(V.DataTable.Bolt.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Bolt.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("Bolt - {0}",V.DataTable.Bolt(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.Bolt(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.Bolt(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.Bolt(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Brace.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Brace.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("Brace - {0}",V.DataTable.Brace(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.Brace(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.Brace(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.Brace(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.AddMat.Exists)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.AddMat.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
			F.Intrinsic.String.Build("AddMat - {0}",V.DataTable.AddMat(V.Local.i).ID!FieldVal,V.Local.sLine)
			F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
			F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
			F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.fRate)
			F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Description!FieldValTrim,=,"")
				F.Intrinsic.String.Build("Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("PartDesc","Temp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.PartDesc!Temp.RowCount--,<>,-1)
					V.Local.sDesc.Set(V.DataView.PartDesc!Temp(V.DataView.PartDesc!Temp.RowCount--).Description!FieldValTrim)
				F.Intrinsic.Control.Else
					V.Local.sDesc.Set("")
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("PartDesc","Temp")
			F.Intrinsic.Control.Else	
				V.Local.sDesc.Set(V.DataTable.AddMat(V.Local.i).Description!FieldValTrim)
			F.Intrinsic.Control.EndIf
			F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.sLine,"LMO","M","Part_WC_Outside",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,"Operation",V.DataTable.AddMat(V.Local.i).OpCode!FieldValTrim,"Set_Up","0.00","Run_Time",V.DataTable.AddMat(V.Local.i).Qty!FieldValFloat,"UM_Inventory",V.Local.sUM,"Rate",V.Local.fRate,"Desc_Rt_Line",V.Local.sDesc,"Cuts",V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.Close

'F.Data.DataView.Create("TempCuts","Temp",22,"","")
'F.Data.DataView.ToDataTableDistinct("TempCuts","Temp","Mat","Part_WC_Outside",True)
'F.Data.DataView.Close("TempCuts","Temp")
'F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Mat.RowCount--,1)
'	F.Intrinsic.Math.Add(1000000,V.Local.i,V.Local.iTemp)
'	F.Intrinsic.String.Build("Part_WC_Outside = '{0}'",V.DataTable.Mat(V.Local.i).Part_WC_Outside!FieldValTrim,V.Local.sFilter)
'	F.Data.DataView.Create("TempCuts","Temp",22,V.Local.sFilter,"")
'	F.Data.DataView.ToDataTable("TempCuts","Temp","SumRun",True)
'	F.Data.Datatable.AddExpressionColumn("SumRun","sumruntime",Float,"Sum(Run_Time)")
'	F.Data.DataView.Close("TempCuts","Temp")
'	V.Local.fRunTime.Set(V.DataTable.SumRun(V.DataTable.SumRun.RowCount--).SumRunTime!FieldValFloat)

'	F.Intrinsic.Math.Int(V.Local.fRunTime,V.Local.fSetUp)
'	F.Intrinsic.Control.If(V.Local.fRunTime,<,V.Local.fSetUp)
'		F.Intrinsic.Math.Sub(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.Else
'		F.Intrinsic.Math.Add(V.Local.fSetUp.Long,1,V.Local.fRunTime)
'	F.Intrinsic.Control.EndIf
'	F.Data.Datatable.AddRow("dtRouterTemp","Router",V.Local.sRouter,"Line_Router",V.Local.iTemp,"LMO","Material Sum","Part_WC_Outside",V.DataTable.Mat(V.Local.i).Part_WC_Outside!FieldValTrim,"Run_Time",V.Local.fRunTime)
'	F.Data.Datatable.Close("SumRun")
'F.Intrinsic.Control.Next(V.Local.i)

'F.Data.Datatable.Close("Mat")

F.Data.DataTable.Merge("dtRouterTemp","dtRouter",4,2)

F.Data.DataView.Close("RLine","MLine")

Gui.FormSkid..Enabled(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSkidCalc_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdSkidCalc_Click.End

Program.Sub.FormSkid_SaveButtonClick.Start
F.Intrinsic.Control.SetErrorHandler("FormSkid_SaveButtonClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.iRet.Declare(Long,0)
V.Local.i.Declare(Long,0)
V.Local.iC.Declare(Long,0)
V.Local.sDesc.Declare(String,"")
V.Local.sFilter.Declare(String,"")
V.Local.sComment.Declare(String,"")
V.Local.iSeq.Declare(Long,0)
V.Local.sSeq.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sPart.Declare(String,"")
V.Local.sRunTime.Declare(String,"")
V.Local.sRate.Declare(String,"")
V.Local.sSetup.Declare(String,"")
V.Local.sPL.Declare(String,"")
V.Local.sUM.Declare(String,"")
V.Local.sDate.Declare(String,"")
V.Local.sMDesc.Declare(String,"")
V.Local.iTime.Declare(Long,0)
V.Local.fTemp.Declare(Float,0)
V.Local.sTemp.Declare(String,"")
V.Local.sExtraDesc.Declare(String,"")

F.Intrinsic.Control.BlockEvents

V.Local.iTime.Set(V.Screen.FormSkid!txtRtrTime.Text)
F.Intrinsic.Control.If(V.Local.iTime,<=,0)
	F.Intrinsic.UI.Msgbox("Enter Time in Mins for a Single Skid/Pallet","Attention")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Format(V.Ambient.Date,"MMDDYY",V.Local.sDate)

'F.Intrinsic.String.Build("{2} {0}x{1}",V.Screen.FormSkid!txtSkidLen.Text,V.Screen.FormSkid!txtSkidWidth.Text,V.Global.sSort.Trim,V.Local.sDesc)

V.Local.sDesc.Set(V.Screen.FormSkid!txtSkidDesc.Text)

V.Local.sExtraDesc.Set(V.Screen.FormSkid!txtSkidExtraDesc.Text)

F.Intrinsic.Control.If(v.Local.sDesc.Trim,=,"")
	F.Intrinsic.UI.Msgbox("Enter in a Description","Attention")
	F.Intrinsic.Control.UnBlockEvents
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Local.sDesc.Length,>,30)
	F.Intrinsic.String.Left(V.Local.sDesc,30,V.Local.sDesc)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Con.OpenCompanyConnection
F.Intrinsic.String.Build("Select Part From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

V.Local.sPL.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
V.Local.sUM.Set(V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim)

F.Intrinsic.Control.If(V.Local.sPart.Trim,=,V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
	F.Global.Inventory.CreatePart(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).UM_Inventory!FieldValTrim,V.Local.sDesc,"",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"F","","",0,"NOMAINT")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Build("Update Inventory_Mstr Set Description = '{1}' Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sDesc.Trim,V.Local.sSql)
	F.ODBC.Connection!Con.Execute(V.Local.sSql)
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Update INV_EXTRA_TEXT Set Text = '{1}' Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sExtraDesc.Trim,V.Local.sSql)
F.ODBC.Connection!Con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("Select Part From INV_EXTRA_TEXT Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sSql)
F.Intrinsic.Control.If(V.Local.sSql.Trim,<>,"")
	F.Intrinsic.String.Build("Update INV_EXTRA_TEXT Set Text = '{1}' Where Part = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sExtraDesc.Trim,V.Local.sSql)
F.Intrinsic.Control.Else
	f.Intrinsic.String.Build("INSERT INTO INV_EXTRA_TEXT VALUES ('{0}','{1}')",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sExtraDesc.Trim,v.Local.ssql)
F.Intrinsic.Control.EndIf
F.ODBC.Connection!Con.Execute(V.Local.sSql)
		
F.Intrinsic.Control.If(V.DataTable.dtRouter.RowCount--,<>,-1)
	F.Intrinsic.UI.Msgbox("Are you sure you want to create a New Part/Router?","New Part/Router",4,V.Local.iRet)
	F.Intrinsic.Control.If(V.Local.iRet,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.RLine.RowCount--,1)
			F.Intrinsic.Control.SelectCase(V.DataTable.RLine(V.Local.i).LMO!FieldValTrim)
				F.Intrinsic.Control.Case("L")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.Math.Mult(V.DataTable.RLine(V.Local.i).Run_Time!FieldValFloat,V.Local.iTime,V.Local.fTemp)
					F.Intrinsic.Math.Div(V.Local.fTemp,60,V.Local.fTemp)
					F.Intrinsic.String.Format(V.Local.fTemp,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","L","WC",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("M")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Build("Line_Router = '{0}'",V.DataTable.RLine(V.Local.i).Line_Router!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
						F.Intrinsic.String.Build("Select Description From V_Inventory_Mstr Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sMDesc)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.Local.sMDesc.Trim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
					
				F.Intrinsic.Control.Case("O")
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.RLine(V.Local.i).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","O","PartNum",V.DataTable.RLine(V.Local.i).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"UM",V.DataTable.RLine(V.Local.i).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					
				F.Intrinsic.Control.Case("C")
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sComment.Redim(0,0)
					F.Intrinsic.String.Build("Line_Router = '{0}' and LMO = 'M'",V.DataTable.RLine(V.Local.i).Operation!FieldValTrim,V.Local.sFilter)
					F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
					
					F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
						F.Intrinsic.String.Split(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim,"|",V.Local.sComment)
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sComment.UBound,1)
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment(V.Local.iC).Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.DataTable.RLine(V.Local.i).Desc_Rt_Line!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.EndSelect
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.UnBlockEvents
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.6021.RowCount--,<>,-1)
	V.Local.iSeq.Set(V.DataTable.6021(V.DataTable.6021.RowCount--).Seq!FieldValLong)
	F.Intrinsic.Control.If(V.DataTable.Bolt.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Bolt.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'Bolt - {0}'",V.DataTable.Bolt(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.Bolt(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.Bolt(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.Bolt(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.Bolt(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.Bolt(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.Brace.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.Brace.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'Brace - {0}'",V.DataTable.Brace(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.Brace(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.Brace(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.Brace(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.Brace(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.Brace(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.DataTable.AddMat.Exists)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.AddMat.RowCount--,1)
			F.Intrinsic.Control.If(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"","AND",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,<>,"##NO MATERIAL##")
				F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
				F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
				F.Intrinsic.String.Build("Line_Router = 'AddMat - {0}'",V.DataTable.AddMat(V.Local.i).ID!FieldValTrim,V.Local.sFilter)
				F.Data.DataView.Create("dtRouter","MTemp",22,V.Local.sFilter,"")
				F.Intrinsic.Control.If(V.DataView.dtRouter!MTemp.RowCount--,<>,-1)
					F.Intrinsic.String.Build("Select Cost From V_Inventory_Cost Where Part = '{0}'",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Run_Time!FieldVal,"#0.0000",V.Local.sRunTime)
'						F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Rate!FieldVal,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Set_Up!FieldVal,"#0.0000",V.Local.sSetup)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Operation!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Part_WC_Outside!FieldValTrim,"PartStepDesc",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Desc_Rt_Line!FieldValTrim,"UM",V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).UM_Inventory!FieldValTrim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)
				
					V.Local.sComment.Set(V.DataView.dtRouter!MTemp(V.DataView.dtRouter!MTemp.RowCount--).Cuts!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("Select Top 1 Cost From V_Inventory_Cost Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sRate)
					F.Intrinsic.String.Format(V.DataTable.AddMat(V.Local.i).Qty!FieldValTrim,"#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format(V.Local.sRate.Float,"#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					V.Local.sPartDesc.Set(V.DataTable.AddMat(V.Local.i).Material!FieldValTrim)
					F.Intrinsic.Control.If(V.Local.sPartDesc,=,"")
						F.Intrinsic.String.Build("Select Top 1 Description From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
						F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartDesc)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,V.Local.sSql)
					F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPartUM)
						
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"OperationCodeVend",V.DataTable.AddMat(V.Local.i).OpCode!FieldValTrim,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","M","PartNum",V.DataTable.AddMat(V.Local.i).Material!FieldValTrim,"PartStepDesc",V.Local.sPartDesc,"UM",V.Local.sPartUM,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim)

					V.Local.sComment.Set(V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
					F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
					F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
						F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
						F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
						F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
						V.Local.sComment.Set("")
						F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
							F.Intrinsic.Control.If(V.Local.iC,>,0)
								F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
									V.Local.sTemp.Set(V.Local.sFilter)
									F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
									F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
										V.Local.sComment.Set(V.Local.sTemp)
										V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
									F.Intrinsic.Control.Else
										F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
											V.Local.sComment.Set(V.Local.sFilter)
										F.Intrinsic.Control.EndIf
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.Else
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
									V.Local.sComment.Set(V.Local.sFilter)
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
								F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
								F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
								F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
								V.Local.sComment.Set("")
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Next(V.Local.iC)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("dtRouter","MTemp")
			F.Intrinsic.Control.Else
				V.Local.sComment.Set(V.DataTable.AddMat(V.Local.i).Comment!FieldValTrim)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRunTime)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sRate)
				F.Intrinsic.String.Format("0","#0.0000",V.Local.sSetup)
				F.Intrinsic.Control.If(V.Local.sComment.Length,<=,30)
					F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
					F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
					F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Split(V.Local.sComment," ",V.Local.sFilter)
					V.Local.sComment.Set("")
					F.Intrinsic.Control.For(V.Local.iC,0,V.Local.sFilter.UBound,1)
						F.Intrinsic.Control.If(V.Local.iC,>,0)
							F.Intrinsic.Control.If(V.Local.sFilter.Trim,<>,"")
								V.Local.sTemp.Set(V.Local.sFilter)
								F.Intrinsic.String.Build("{0} {1}",V.Local.sFilter,V.Local.sFilter(V.Local.iC),V.Local.sFilter)
								F.Intrinsic.Control.If(V.Local.sFilter.Length,>,30)
									V.Local.sComment.Set(V.Local.sTemp)
									V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
								F.Intrinsic.Control.Else
									F.Intrinsic.Control.If(V.Local.iC,=,V.Local.sFilter.UBound)
										V.Local.sComment.Set(V.Local.sFilter)
									F.Intrinsic.Control.EndIf
								F.Intrinsic.Control.EndIf
							F.Intrinsic.Control.Else
								V.Local.sFilter.Set(V.Local.sFilter(V.Local.iC))
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.Else
							F.Intrinsic.Control.If(V.Local.sFilter.UBound,=,0)
								V.Local.sComment.Set(V.Local.sFilter)
							F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.sComment.Trim,<>,"")
							F.Intrinsic.Math.Add(V.Local.iSeq,V.Global.lOp,V.Local.iSeq)
							F.Intrinsic.String.Format(V.Local.iSeq,"000000",V.Local.sSeq)
							F.Data.DataTable.AddRow("6021","OriginalDate",V.Local.sDate,"RouterNum",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"RouterDesc",V.Local.sDesc,"RunTimeMatlQty",V.Local.sRunTime,"RateUC",V.Local.sRate,"SetupQty",V.Local.sSetup,"Seq",V.Local.sSeq,"LineType","C","PartStepDesc",V.Local.sComment.Trim,"PL",V.DataTable.RHeader(V.DataTable.RHeader.RowCount--).Prod_Line!FieldValTrim,"Freq", "0", "WCFactor", "0", "Overlap", "0", "LeadTime", "0", "MainCommentFlag", "Y")
							V.Local.sComment.Set("")
						F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.Next(V.Local.iC)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
	F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sPart)

	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("Delete From Router_Header Where Router = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
		F.Intrinsic.String.Build("Delete From ROUTER_SUPP_HDR Where Rtr_Num = '{0}'",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!Con.Execute(V.Local.sSql)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.CallSub(6021Sync)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!con.Close

F.Data.Datatable.DeleteRow("6021")
F.Data.Datatable.AcceptChanges("6021")

'F.Global.General.CallWrappersync(50,"RE0017")

F.Data.DataTable.AddRow("400000","Mode","O","Router",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)

F.Intrinsic.Control.CallSub(400000Sync)

F.Data.DataTable.AddRow("1500","ROUTER",V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim,"Quantity",1)
F.Intrinsic.Control.CallSub(1500sync)

F.Intrinsic.Control.CallSub(Get_Cost)

V.Passed.000052.Set(V.DataTable.dtRouter(V.DataTable.dtRouter.RowCount--).Router!FieldValTrim)
V.Passed.000056.Set(V.Local.sDesc.Trim)
v.Passed.000006.Set(V.Local.sUM)
V.Passed.000013.Set(V.Local.sPL)

F.Intrinsic.Control.CallSub(FormSkid_UnLoad)

F.Intrinsic.Control.UnBlockEvents

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormSkid_SaveButtonClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.FormSkid_SaveButtonClick.End

Program.Sub.ddlTMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlTMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sUM.Declare(String,"")

F.ODBC.Connection!ConG.OpenCompanyConnection
F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
F.ODBC.Connection!ConG.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
F.ODBC.Connection!ConG.Close

F.Intrinsic.Control.If(V.Local.sUM.Trim,=,"SH")
	Gui.FormSkid.txtTWid.Enabled(True)
F.Intrinsic.Control.Else
	Gui.FormSkid.txtTWid.Enabled(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlTMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlTMat_SelectedIndexChanged.End

Program.Sub.txtTLen_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTLen_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtTLen.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTLen_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTLen_GotFocus.End

Program.Sub.txtTWid_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTWid_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtTWid.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTWid_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTWid_GotFocus.End

Program.Sub.txtBLen_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtBLen_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtBLen.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtBLen_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtBLen_GotFocus.End

Program.Sub.txtBWid_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtBWid_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtBWid.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtBWid_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtBWid_GotFocus.End

Program.Sub.txtBQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtBQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtBQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtBQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtBQty_GotFocus.End

Program.Sub.txtRLen_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtRLen_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtRLen.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtRLen_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtRLen_GotFocus.End

Program.Sub.txtRQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtRQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtRQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtRQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtRQty_GotFocus.End

Program.Sub.FormSkid_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormSkid_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormSkid_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.Control.End
Function.Intrinsic.Control.EndIf
Program.Sub.FormSkid_UnLoad.End

Program.Sub.txtSkidTemplate_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSkidTemplate_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtSkidTemplate.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSkidTemplate_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSkidTemplate_GotFocus.End

Program.Sub.txtSkidTemplate_LostFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtSkidTemplate_LostFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.sSql.Declare(String,"")

'octsrs is currently disabling this txt box before the lost focus event runs
Gui.FormSkid.txtSkidTemplate.Enabled(True)

V.Local.sRouter.Set(V.Screen.FormSkid!txtSkidTemplate.Text)
F.Intrinsic.Control.If(V.Local.sRouter.Trim,=,"")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

F.Intrinsic.String.Build("Select Router From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
F.ODBC.Connection!Conx.OpenCompanyConnection
F.ODBC.Connection!Conx.ExecuteAndReturn(V.Local.sSql,V.Local.sRouter)
F.ODBC.Connection!Conx.Close
F.Intrinsic.Control.If(V.Local.sRouter.Trim,<>,"")
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(Get_Skid_Data)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Template Router Not Found.....","Attention")
	Gui.FormSkid.txtSkidTemplate.SetFocus
	Gui.FormSkid.txtSkidTemplate.SelectAll
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtSkidTemplate_LostFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtSkidTemplate_LostFocus.End

Program.Sub.cmdSkidTemplate_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdSkidTemplate_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sRet.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sTitles.Declare(String,"")
V.Local.sWidths.Declare(String,"")

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)

F.ODBC.Connection!Con.OpenCompanyConnection

V.Local.sSql.Set("Select rtrim(Router), rtrim(Description_Router) From V_Router_Header Where ltrim(rtrim(ucase(Sort_1))) = 'SKID TEMPLATE' or ltrim(rtrim(ucase(Sort_1))) = 'PALLET TEMPLATE' Order by Router")

V.Local.sTitles.Set("Router*!*Description")
V.Local.sWidths.Set("1800*!*2400")

F.Intrinsic.String.Split(V.Local.sTitles,"*!*",V.Local.sTitles)
F.Intrinsic.String.Split(V.Local.sWidths,"*!*",V.Local.sWidths)

F.Intrinsic.UI.Browser("Select Template","con",V.Local.sSql,V.Local.sTitles,V.Local.sWidths,10200,8700,V.Local.sRet)

F.ODBC.Connection!Con.Close

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.FormSkid.txtSkidTemplate.Text(V.Local.sRet.UCase)
'	Gui.FormSkid.txtSkidDesc.Text(V.Local.sRet.UCase)
	F.Intrinsic.Control.BlockEvents
	F.Intrinsic.Control.CallSub(Get_Skid_Data)
	F.Intrinsic.Control.UnBlockEvents
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdSkidTemplate_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdSkidTemplate_Click.End

Program.Sub.ddlBMat_SelectedIndexChanged.Start
F.Intrinsic.Control.SetErrorHandler("ddlBMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sSql.Declare(String,"")
V.Local.sUM.Declare(String,"")

F.ODBC.Connection!ConG.OpenCompanyConnection
F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
F.ODBC.Connection!ConG.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
F.ODBC.Connection!ConG.Close

F.Intrinsic.Control.If(V.Local.sUM.Trim,=,"SH")
	Gui.FormSkid.txtBWid.Enabled(True)
F.Intrinsic.Control.Else
	Gui.FormSkid.txtBWid.Enabled(False)
F.Intrinsic.Control.EndIf
		
F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ddlBMat_SelectedIndexChanged_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.ddlBMat_SelectedIndexChanged.End

Program.Sub.txtTQty_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtTQty_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtTQty.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtTQty_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.txtTQty_GotFocus.End

Program.Sub.Get_Skid_Data.Start
F.Intrinsic.Control.SetErrorHandler("Get_Skid_Data_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fWidth.Declare(Float,0)
V.Local.fLength.Declare(Float,0)
V.Local.i.Declare(Long,0)
V.Local.fQty1.Declare(Float,0)
V.Local.fQty2.Declare(Float,0)
V.Local.fCutLen1.Declare(Float,0)
V.Local.fCutLen2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fMatLen.Declare(Float,0)
V.Local.fMatWid.Declare(Float,0)
V.Local.fTemp1.Declare(Float,0)
V.Local.sSql.Declare(String,"")
V.Local.sRouter.Declare(String,"")
V.Local.bMW1.Declare(Boolean,False)
V.Local.bMW2.Declare(Boolean,False)
V.Local.sUM.Declare(String,"")

V.Local.fLength.Set(V.Screen.FormSkid!txtSkidLen.Text)
V.Local.fWidth.Set(V.Screen.FormSkid!txtSkidWidth.Text)

F.Intrinsic.Control.If(V.DataTable.dtRouter.Exists)
	F.Data.Datatable.DeleteRow("dtRouter")
	F.Data.Datatable.AcceptChanges("dtRouter")
	V.Local.sRouter.Set(V.Screen.FormSkid!txtSkidTemplate.Text)
	F.Intrinsic.String.Build("Select * From V_Router_Header Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RHeader.Exists)
		F.Data.Datatable.Close("RHeader")
	F.Intrinsic.Control.EndIf
	F.ODBC.Connection!Con.OpenCompanyConnection
	F.Data.Dictionary.CreateFromSQL("Part","con","Select rtrim(Part), rtrim(Part) From V_Inventory_Mstr where Code_Sort = 'LSTK' Order by Part")
	F.Data.Dictionary.CreateFromSQL("Part2","con","Select rtrim(Part), rtrim(Part) From V_Inventory_Mstr where Code_Sort IN ('LSTK','LOSB','LPLY') Order by Part,Code_Sort")
	Gui.FormSkid.ddlBMat.AddItems("Dictionary","Part2")
	Gui.FormSkid.ddlRMat.AddItems("Dictionary","Part")
	Gui.FormSkid.ddlTMat.AddItems("Dictionary","Part2")
	F.Data.Dictionary.Close("Part")
	F.Data.Dictionary.Close("Part2")
	F.Data.Datatable.CreateFromSQL("RHeader","Con",V.Local.sSql,True)
	F.Intrinsic.String.Build("Select * From V_Router_Line Where Router = '{0}' Order by Line_Router",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.RLine.Exists)
		F.Data.Datatable.Close("RLine")
	F.Intrinsic.Control.EndIf
	F.Data.Datatable.CreateFromSQL("RLine","Con",V.Local.sSql,True)
	F.Data.Datatable.AddColumn("RLine","Length",Float)
	F.Data.Datatable.AddColumn("RLine","Width",Float)
	F.Data.Dictionary.CreateFromSQL("Len","Con","Select Part, Length From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Len","0")
	F.Data.Datatable.FillFromDictionary("RLine","Len","Part_WC_Outside","Length")
	F.Data.Dictionary.Close("Len")
	F.Data.Dictionary.CreateFromSQL("Wid","Con","Select Part, Width From V_Inventory_Mst2")
	F.Data.Dictionary.SetDefaultReturn("Wid","0")
	F.Data.Datatable.FillFromDictionary("RLine","Wid","Part_WC_Outside","Width")
	F.Data.Dictionary.Close("Wid")
	F.Intrinsic.String.Build("Select * From GCG_6761_CRATE_MAINT Where Router = '{0}'",V.Local.sRouter.Trim,V.Local.sSql)
	F.Intrinsic.Control.If(V.DataTable.CrateCalc.Exists)
		F.Data.Datatable.Close("CrateCalc")
	F.Intrinsic.Control.EndIf

	F.Data.Datatable.CreateFromSQL("CrateCalc","Con",V.Local.sSql,True)
	
	F.Intrinsic.Control.For(V.Local.i,0,V.Datatable.CrateCalc.RowCount--,1)
		F.Intrinsic.String.Build("Select Length From V_Inventory_Mst2 Where Part = '{0}'",V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatLen)
		F.Intrinsic.String.Build("Select Width From V_Inventory_Mst2 Where Part = '{0}'",V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim,V.Local.sSql)
		F.ODBC.Connection!con.ExecuteAndReturn(V.Local.sSql,V.Local.fMatWid)
		F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"/[MW]",True,V.Local.bMW1)
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty1)
		F.Intrinsic.Control.Else
			V.Local.fQty1.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.IsInString(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"/[MW]",True,V.Local.bMW2)
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Qty!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fQty2)
		F.Intrinsic.Control.Else
			V.Local.fQty2.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim1Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fCutLen1)
		F.Intrinsic.Control.Else
			V.Local.fCutLen1.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.String.Replace(V.Datatable.CrateCalc(V.Local.i).Dim2Form!FieldValTrim,"[CL]",V.Local.fLength,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[CW]",V.Local.fWidth,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[MW]",V.Local.fMatWid,V.Local.sEval)
		F.Intrinsic.String.Replace(V.Local.sEval,"[ML]",V.Local.fMatLen,V.Local.sEval)
		F.Intrinsic.String.RegExReplace(V.Local.sEval,"/0","/1",True,True,V.Local.sEval)
		F.Intrinsic.Control.If(V.Local.sEval,<>,"")
			F.Intrinsic.Math.Evaluate(V.Local.sEval,V.Local.fCutLen2)
		F.Intrinsic.Control.Else
			V.Local.fCutLen2.Set(0)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.bMW1)
			F.Intrinsic.Math.Int(V.Local.fQty1,V.Local.fTemp1)
			F.Intrinsic.Control.If(V.Local.fQty1,<,V.Local.fTemp1)
				F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty1)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty1)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.bMW2)
			F.Intrinsic.Math.Int(V.Local.fQty2,V.Local.fTemp1)
			F.Intrinsic.Control.If(V.Local.fQty2,<,V.Local.fTemp1)
				F.Intrinsic.Math.Sub(V.Local.fTemp1.Long,1,V.Local.fQty2)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Add(V.Local.fTemp1.Long,1,V.Local.fQty2)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.SelectCase(V.Datatable.CrateCalc(V.Local.i).OpCode!FieldValTrim)
			F.Intrinsic.Control.Case("BASE T")
				gui.FormSkid.txtTQty.Text(V.Local.fQty1)
				gui.FormSkid.txtTLen.Text(V.Local.fCutLen1)
				gui.FormSkid.ddlTMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)

				F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
				F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
				
				F.Intrinsic.Control.If(V.Local.sUM.Trim,=,"SH")
					Gui.FormSkid.txtTWid.Enabled(True)
				F.Intrinsic.Control.Else
					Gui.FormSkid.txtTWid.Enabled(False)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Case("BASE B")
				Gui.FormSkid.txtBQty.Text(V.Local.fQty1)
				gui.FormSkid.txtBLen.Text(V.Local.fCutLen1)
				gui.FormSkid.ddlBMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
				
				F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
				F.ODBC.Connection!Con.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
				
				F.Intrinsic.Control.If(V.Local.sUM.Trim,=,"SH")
					Gui.FormSkid.txtBWid.Enabled(True)
				F.Intrinsic.Control.Else
					Gui.FormSkid.txtBWid.Enabled(False)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Case("BASE R")
				Gui.FormSkid.txtRQty.Text(V.Local.fQty1)
				gui.FormSkid.txtRLen.Text(V.Local.fCutLen1)
				gui.FormSkid.ddlRMat.Text(V.Datatable.CrateCalc(V.Local.i).Material!FieldValTrim)
		F.Intrinsic.Control.EndSelect
	F.Intrinsic.Control.Next(V.Local.i)
	
	F.ODBC.Connection!Con.Close
F.Intrinsic.Control.Else
	f.Data.DataTable.Create("dtRouter",True)
	f.Data.DataTable.AddColumn("dtRouter","Router","string")
	f.Data.DataTable.AddColumn("dtRouter","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouter","LMO","string")
	f.Data.DataTable.AddColumn("dtRouter","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouter","Operation","string")
	f.Data.DataTable.AddColumn("dtRouter","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouter","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouter","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouter","Rate","float")
	f.Data.DataTable.AddColumn("dtRouter","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouter","Cuts","string")

	f.Data.DataTable.Create("dtRouterTemp",True)
	f.Data.DataTable.AddColumn("dtRouterTemp","Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Line_Router","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","LMO","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Operation","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Set_Up","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Run_Time","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","UM_Inventory","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Rate","float")
	f.Data.DataTable.AddColumn("dtRouterTemp","Desc_Rt_Line","string")
	f.Data.DataTable.AddColumn("dtRouterTemp","Cuts","string")
	
	f.Data.DataTable.Create("TempCuts",True)
	f.Data.DataTable.AddColumn("TempCuts","Line_Router","string")
	f.Data.DataTable.AddColumn("TempCuts","Operation","string")
	f.Data.DataTable.AddColumn("TempCuts","Part_WC_Outside","string")
	f.Data.DataTable.AddColumn("TempCuts","Run_Time","float")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Skid_Data_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Skid_Data.End

Program.Sub.Get_Skid_Runtime.Start
F.Intrinsic.Control.SetErrorHandler("Get_Skid_Runtime_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.fTemp1.Declare(Float,0)
V.Local.fTemp2.Declare(Float,0)
V.Local.fTemp3.Declare(Float,0)
V.Local.fSqft.Declare(Float,0)
V.Local.fMLen.Declare(Float,0)
V.Local.fMWid.Declare(Float,0)
V.Local.fCL.Declare(Float,0)
V.Local.fCW.Declare(Float,0)
V.Local.fCP1.Declare(Float,0)
V.Local.fCP2.Declare(Float,0)
V.Local.sEval.Declare(String,"")
V.Local.fRunTime.Declare(Float,0)
V.Local.fRunTime1.Declare(Float,0)
V.Local.fRunTime2.Declare(Float,0)
V.Local.sCuts.Declare(String,"")
V.Local.sTemp.Declare(String,"")
V.Local.fRemLen.Declare(Float,0)
V.Local.fRemWid.Declare(Float,0)
V.Local.sTempCut1.Declare(String,"")
V.Local.sTempCut2.Declare(String,"")
V.Local.sTempCut3.Declare(String,"")
V.Local.sTempCut4.Declare(String,"")
V.Local.fTempRunTime1.Declare(Float,0)
V.Local.fHalfLen.Declare(Float,0)
V.Local.fHalfWid.Declare(Float,0)
V.Local.bSheet.Declare(Boolean,False)
V.Local.sSql.Declare(String,"")
V.Local.sUM.Declare(String,"")

V.Local.fCL.Set(V.Screen.FormSkid!txtSkidLen.Text)
V.Local.fCW.Set(V.Screen.FormSkid!txtSkidWidth.Text)

V.Local.fMWid.Set(V.Args.Wid)
F.Intrinsic.Math.Div(V.Local.fMWid,2,V.Local.fHalfWid)
V.Local.fMLen.Set(V.Args.Len)
F.Intrinsic.Math.Div(V.Local.fMLen,2,V.Local.fHalfLen)

F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.fMWid,V.Local.fSqft)

F.Intrinsic.Control.SelectCase(V.DataView.RLine!MLine(V.Args.Index).Operation!FieldValTrim)	
	F.Intrinsic.Control.Case("BASE T")
		V.Local.fCP1.Set(V.Screen.FormSkid!txtTQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormSkid!txtTLen.Text)	
		F.ODBC.Connection!ConG.OpenCompanyConnection
		F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.Screen.FormSkid!ddlTMat.Text,V.Local.sSql)
		F.ODBC.Connection!ConG.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
		F.ODBC.Connection!ConG.Close
		F.Intrinsic.Control.If(V.Local.sUM.Trim,=,"SH")
			V.Local.fCP2.Set(V.Screen.FormSkid!txtTQty.Text)
			V.Local.fRunTime2.Set(V.Screen.FormSkid!txtTWid.Text)
		F.Intrinsic.Control.Else
			V.Local.fCP2.Set(0)
			V.Local.fRunTime2.Set(0)
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("BASE B")
		V.Local.fCP1.Set(V.Screen.FormSkid!txtBQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormSkid!txtBLen.Text)		
		F.ODBC.Connection!ConG.OpenCompanyConnection
		F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.Screen.FormSkid!ddlBMat.Text,V.Local.sSql)
		F.ODBC.Connection!ConG.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
		F.ODBC.Connection!ConG.Close
		F.Intrinsic.Control.If(V.Local.sUM.Trim,=,"SH")
			V.Local.fCP2.Set(V.Screen.FormSkid!txtBQty.Text)
			V.Local.fRunTime2.Set(V.Screen.FormSkid!txtBWid.Text)
		F.Intrinsic.Control.Else
			V.Local.fCP2.Set(0)
			V.Local.fRunTime2.Set(0)
		F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Case("BASE R")
		V.Local.fCP1.Set(V.Screen.FormSkid!txtRQty.Text)
		V.Local.fRunTime1.Set(V.Screen.FormSkid!txtRLen.Text)	
		V.Local.fCP2.Set(0)
		V.Local.fRunTime2.Set(0)
		F.ODBC.Connection!ConG.OpenCompanyConnection
		F.Intrinsic.String.Build("Select Top 1 UM_Inventory From V_Inventory_Mstr Where Part = '{0}'",V.Screen.FormSkid!ddlRMat.Text,V.Local.sSql)
		F.ODBC.Connection!ConG.ExecuteAndReturn(V.Local.sSql,V.Local.sUM)
		F.ODBC.Connection!ConG.Close
		
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.If(V.Local.fCP1,>,0,"AND",V.Local.fCP2,>,0)
	V.Local.fTemp1.Set(V.Local.fRunTime1)
	V.Local.fTemp2.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
	F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)

	F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fRunTime)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fSqft,V.Local.fRunTime)
	
	F.Intrinsic.Control.If(V.Local.sUM.Trim,=,"SH")
		V.Local.fRunTime1.Set(V.Local.fTemp1)
		V.Local.fRunTime2.Set(V.Local.fTemp2)
		F.Intrinsic.Control.If(V.Local.fCL,>=,V.Local.fCW)
			V.Local.fTemp1.Set(V.Local.fMLen)
			V.Local.fTemp2.Set(V.Local.fHalfLen)
			V.Local.fMLen.Set(V.Local.fMWid)
			V.Local.fHalfLen.Set(V.Local.fHalfWid)
			V.Local.fMWid.Set(V.Local.fTemp1)
			V.Local.fHalfWid.Set(V.Local.fTemp2)
		F.Intrinsic.Control.EndIf
		
'		V.Local.fRunTime.Set(0)

		'figuring out partials
		F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
			F.Intrinsic.Control.If(V.Local.fMLen,=,0)
				V.Local.fTemp1.Set(0)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
			F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
				F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
				F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.Control.If(V.Local.fMWid,=,0)
				V.Local.fTemp2.Set(0)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
			F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
				F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
				F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.Control.If(V.Local.fTemp1.Long,=,V.Local.fTemp2.Long)
				F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
					F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
					F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
					F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut4)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,>,V.Local.fTemp2.Long)
				F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
					F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
					F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMWid,V.Local.fRunTime1)
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut4)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime2,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.ElseIf(V.Local.fTemp1.Long,<,V.Local.fTemp2.Long)
				F.Intrinsic.Math.Mult(V.Local.fTemp2.Long,V.Local.fCP2,V.Local.fTemp3)
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
				F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
					F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp1.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fMWid,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp1.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp1.Long,V.Local.fRemLen,V.Local.fMWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
					F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid)
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp2.Long,V.Local.fRunTime)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp2.Long,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fSqft,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fTemp2.Long,V.Local.fMLen,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Local.fRemLen,>,0,"AND",V.Local.fRemWid,>,0)
					F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRemWid,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
					F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,"1",V.Local.fRemLen,V.Local.fRemWid,V.Local.sCuts)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
					'figureing addtional stick cuts
					F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
					F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
					F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
					F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
						V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
						V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
						F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
						F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
							F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime1,V.Local.sTempCut3)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut4)
							F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
							F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut4,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
							F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime2,V.Local.sTempCut4)
						F.Intrinsic.Control.EndIf
						
						F.Intrinsic.Math.Add(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
						F.Intrinsic.Control.If(V.Local.fMLen,=,0)
							V.Local.fTempRunTime1.Set(0)
						F.Intrinsic.Control.Else
							F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
						F.Intrinsic.Control.EndIf
						F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
						F.Intrinsic.String.Build("{0} | {1} | {2}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4,V.Local.sTempCut4)
						F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
					F.Intrinsic.Control.EndIf
					F.Data.DataView.Close("RLine","MTemp")
					F.Data.DataView.Close("dtRouterTemp","Temp")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,>,V.Local.fMLen,"AND",V.Local.fRunTime2,<,V.Local.fMWid)
			F.Intrinsic.Control.If(V.Local.fMLen,=,0)
				V.Local.fTemp1.Set(0)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp1)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Split(V.Local.fTemp1.String,".",V.Local.sTemp)
			F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
				F.Intrinsic.Math.Mult(V.Local.fMLen,V.Local.sTemp.Long,V.Local.fRemLen)
				F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fRemLen,V.Local.fRemLen)
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP1,V.Local.fTemp1)
			F.Intrinsic.Control.EndIf

'				F.Intrinsic.Math.Mult(V.Local.fTemp1.Long,V.Local.fCP1,V.Local.fTemp3)
			V.Local.fTemp3.Set(V.Local.fTemp1.Long)
			F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fHalfWid)
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTempRunTime1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fMLen,V.Local.fRunTime2,V.Local.sCuts)
			F.Intrinsic.Control.If(V.Local.fRemLen,>,0)
				F.Intrinsic.Control.If(V.Local.fRemLen,>,V.Local.fHalfLen,"AND",V.Local.fRunTime2,>,V.Local.fHalfWid)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP1.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fRemLen,V.Local.fRunTime2,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1.Long,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP1.Long,V.Local.fRemLen,V.Local.fRunTime2,V.Local.sCuts)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
				'figureing addtional stick cuts
				F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
				F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
				F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
				F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
					V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
					V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
					F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMWid,V.Local.fRunTime2)
					F.Intrinsic.Control.If(V.Local.fRunTime2,>,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fMLen,V.Local.sTempCut3)
						F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTemp3)
						F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp1.Long,V.Local.fTemp3,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRunTime2,<,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp1.Long,V.Local.fRunTime2,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					
					F.Intrinsic.Control.If(V.Local.fMLen,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
					F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
					F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("RLine","MTemp")
				F.Data.DataView.Close("dtRouterTemp","Temp")
			F.Intrinsic.Control.EndIf
				
		F.Intrinsic.Control.ElseIf(V.Local.fRunTime1,<,V.Local.fMLen,"AND",V.Local.fRunTime2,>,V.Local.fMWid)
			F.Intrinsic.Control.If(V.Local.fMWid,=,0)
				V.Local.fTemp2.Set(0)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Div(V.Local.fRunTime2,V.Local.fMWid,V.Local.fTemp2)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Split(V.Local.fTemp2.String,".",V.Local.sTemp)
			V.Local.fTemp1.Set(V.Local.sTemp.Long)
			F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
				F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.sTemp.Long,V.Local.fRemWid)
				F.Intrinsic.Math.Sub(V.Local.fRunTime2,V.Local.fRemWid,V.Local.fRemWid)
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.sTemp.Long,V.Local.fCP2,V.Local.fTemp2)
			F.Intrinsic.Control.EndIf
			
			V.Local.fTemp3.Set(V.Local.fTemp2.Long)
			F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fHalfLen)
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTemp3.Long,V.Local.fRunTime)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Mult(V.Local.fMWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
				F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fTemp3,V.Local.fTempRunTime1)
				F.Intrinsic.Control.If(V.Local.fSqft,=,0)
					V.Local.fTempRunTime1.Set(0)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fTemp3.Long,V.Local.fRunTime1,V.Local.fMWid,V.Local.sCuts)
			F.Intrinsic.Control.If(V.Local.fRemWid,>,0)
				F.Intrinsic.Control.If(V.Local.fRemWid,>,V.Local.fHalfWid,"AND",V.Local.fRunTime1,>,V.Local.fHalfLen)
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fCP2.Long,V.Local.fRunTime)
				F.Intrinsic.Control.Else
					F.Intrinsic.Math.Mult(V.Local.fRemWid,V.Local.fRunTime1,V.Local.fTempRunTime1)
					F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP2.Long,V.Local.fTempRunTime1)
					F.Intrinsic.Control.If(V.Local.fSqft,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
				F.Intrinsic.Control.EndIf
				F.Intrinsic.String.Build("{0} | {1}: {2} x {3}",V.Local.sCuts,V.Local.fCP2.Long,V.Local.fRunTime1,V.Local.fRemWid,V.Local.sCuts)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.Control.If(V.Screen.FormRegCrate!chkTop.Value,=,1,"AND",V.Global.bSplice,=,TRUE)
				'figureing addtional stick cuts
				F.Intrinsic.String.Build("Operation = '{0}' and LMO = 'M' and UM_Inventory <> 'SH'",V.DataView.CrateCalc!Temp(V.DataView.CrateCalc!Temp.RowCount--).OPCODE!FieldValTrim,V.Local.sTemp)
				F.Data.DataView.Create("RLine","MTemp",22,V.Local.sTemp,"")
				F.Data.DataView.Create("dtRouterTemp","TEMP",22,V.Local.sTemp,"")
				F.Intrinsic.Control.If(V.DataView.RLine!MTemp.RowCount--,<>,-1)
					V.Local.fMWid.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Width!FieldValFloat)
					V.Local.fMLen.Set(V.DataView.RLine!MTemp(V.DataView.RLine!MTemp.RowCount--).Length!FieldValFloat)
					F.Intrinsic.Math.Mult(V.Local.fMWid,2,V.Local.fMWid)
					F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMWid,V.Local.fRunTime1)
					F.Intrinsic.Control.If(V.Local.fRunTime1,>,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fMLen,V.Local.sTempCut3)
						F.Intrinsic.Math.Sub(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTemp3)
						F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut3,V.Local.fTemp2.Long,V.Local.fTemp3,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.If(V.Local.fRunTime1,<,V.Local.fMLen)
						F.Intrinsic.String.Build("{0}: {1}",V.Local.fTemp2.Long,V.Local.fRunTime1,V.Local.sTempCut3)
					F.Intrinsic.Control.EndIf
					
					F.Intrinsic.Control.If(V.Local.fMLen,=,0)
						V.Local.fTempRunTime1.Set(0)
					F.Intrinsic.Control.Else
						F.Intrinsic.Math.Div(V.Local.fRunTime1,V.Local.fMLen,V.Local.fTempRunTime1)
					F.Intrinsic.Control.EndIf
					F.Intrinsic.Math.Add(V.Local.fTempRunTime1,V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Run_Time!FieldValFloat,V.Local.fTempRunTime1)
					F.Intrinsic.String.Build("{0} | {1}",V.DataView.dtRouterTemp!Temp(V.DataView.dtRouterTemp!Temp.RowCount--).Cuts!FieldValTrim,V.Local.sTempCut3,V.Local.sTempCut4)
					F.Data.DataView.SetValue("dtRouterTemp","Temp",-1,"Run_Time",V.Local.fTempRunTime1,"Cuts",V.Local.sTempCut4)
				F.Intrinsic.Control.EndIf
				F.Data.DataView.Close("RLine","MTemp")
				F.Data.DataView.Close("dtRouterTemp","Temp")
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.Else
			F.Intrinsic.Math.Mult(V.Local.fRunTime1,V.Local.fRunTime2,V.Local.fTempRunTime1)
			F.Intrinsic.Math.Mult(V.Local.fTempRunTime1,V.Local.fCP1,V.Local.fTempRunTime1)
			F.Intrinsic.Control.If(V.Local.fSqft,=,0)
				V.Local.fTempRunTime1.Set(0)
			F.Intrinsic.Control.Else
				F.Intrinsic.Math.Div(V.Local.fTempRunTime1,V.Local.fSqft,V.Local.fTempRunTime1)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Math.Add(V.Local.fRunTime,V.Local.fTempRunTime1,V.Local.fRunTime)
			F.Intrinsic.String.Build("{0}: {1} x {2}",V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime2,V.Local.sCuts)
		F.Intrinsic.Control.EndIf
			
	F.Intrinsic.Control.Else
		F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
			F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sTempCut1)
			F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
			F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut1,V.Local.fCP1,V.Local.fTemp3,V.Local.sTempCut1)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.fTemp1,<,V.Local.fMLen)
			F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sTempCut1)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.fTemp2,>,V.Local.fMLen)
			F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fMLen,V.Local.sTempCut2)
			F.Intrinsic.Math.Sub(V.Local.fTemp2,V.Local.fMLen,V.Local.fTemp3)
			F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sTempCut2,V.Local.fCP2,V.Local.fTemp3,V.Local.sTempCut2)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.Local.fTemp2,<,V.Local.fMLen)
			F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP2,V.Local.fTemp2,V.Local.sTempCut2)
		F.Intrinsic.Control.EndIf
		
		F.Intrinsic.String.Build("{0} | {1}",V.Local.sTempCut1,V.Local.sTempCut2,V.Local.sCuts)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.ElseIf(V.Local.fCP1,>,0,"AND",V.Local.fCP2,<=,0)
	V.Local.fTemp1.Set(V.Local.fRunTime1)
	F.Intrinsic.Math.Mult(V.Local.fCP1,V.Local.fRunTime1,V.Local.fRunTime1)
	V.Local.fRunTime.Set(V.Local.fRunTime1)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
	F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.ElseIf(V.Local.fCP1,<=,0,"AND",V.Local.fCP2,>,0)
	V.Local.fTemp1.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Mult(V.Local.fCP2,V.Local.fRunTime2,V.Local.fRunTime2)
	V.Local.fRunTime.Set(V.Local.fRunTime2)
	F.Intrinsic.Math.Div(V.Local.fRunTime,V.Local.fMLen,V.Local.fRunTime)
	F.Intrinsic.Control.If(V.Local.fTemp1,>,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fMLen,V.Local.sCuts)
		F.Intrinsic.Math.Sub(V.Local.fTemp1,V.Local.fMLen,V.Local.fTemp3)
		F.Intrinsic.String.Build("{0} | {1}: {2}",V.Local.sCuts,V.Local.fCP1,V.Local.fTemp3,V.Local.sCuts)
	F.Intrinsic.Control.ElseIf(V.Local.fTemp1,<,V.Local.fMLen)
		F.Intrinsic.String.Build("{0}: {1}",V.Local.fCP1,V.Local.fTemp1,V.Local.sCuts)
	F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.EndIf
			
F.Intrinsic.Variable.AddRV("RunTime",V.Local.fRunTime,"Cuts",V.Local.sCuts)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Get_Skid_Runtime_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Get_Skid_Runtime.End

Program.Sub.Set_Prop_Skid.Start
F.Intrinsic.Control.SetErrorHandler("Set_Prop_Skid_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormSkid.txtSkidLen.TabStop(True)
Gui.FormSkid.txtSkidWidth.TabStop(True)

Gui.FormSkid.txtSkidTemplate.TabIndex(0)
Gui.FormSkid.cmdSkidTemplate.TabIndex(1)
Gui.FormSkid.cmdSkidTemplate.TabStop(False)
Gui.FormSkid.txtSkidDesc.TabIndex(2)
gui.FormSkid.txtSkidExtraDesc.TabIndex(3)
Gui.FormSkid.txtSkidLen.TabIndex(4)
Gui.FormSkid.txtSkidWidth.TabIndex(5)
Gui.FormSkid.chkSkidBolt.TabIndex(6)
Gui.FormSkid.chkSkidBracing.TabIndex(7)
Gui.FormSkid.txtSkidBolt.TabIndex(8)
Gui.FormSkid.txtSkidBracing.TabIndex(9)

Gui.FormSkid.txtTLen.TabIndex(10)
Gui.FormSkid.txtTWid.TabIndex(11)
Gui.FormSkid.txtTQty.TabIndex(12)
Gui.FormSkid.ddlTMat.TabIndex(13)

Gui.FormSkid.txtBLen.TabIndex(14)
Gui.FormSkid.txtBWid.TabIndex(15)
Gui.FormSkid.txtBQty.TabIndex(16)
Gui.FormSkid.ddlBMat.TabIndex(17)

Gui.FormSkid.txtRLen.TabIndex(18)
Gui.FormSkid.txtRQty.TabIndex(19)
Gui.FormSkid.ddlRMat.TabIndex(20)

Gui.FormSkid.cmdSkidCalc.TabIndex(21)

gui.FormSkid.GsGridSkidRout.AddGridviewFromDatatable("gvRouter","dtRouter")

gui.FormSkid.GsGridSkidRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ShowGroupPanel,True)
gui.FormSkid.GsGridSkidRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowAddRows,False)
gui.FormSkid.GsGridSkidRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
gui.FormSkid.GsGridSkidRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
gui.FormSkid.GsGridSkidRout.SetGridviewProperty("gvRouter",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)
gui.FormSkid.GsGridSkidRout.SetGridviewProperty("gvRouter",V.Enum.GridViewPropertyNames!AllowSort,False)

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Router",v.Enum.ColumnPropertyNames!Caption,"Router")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Router",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Line_Router",v.Enum.ColumnPropertyNames!Caption,"Seq")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Line_Router",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","LMO",v.Enum.ColumnPropertyNames!Caption,"Type")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","LMO",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Part_WC_Outside",v.Enum.ColumnPropertyNames!Caption,"Part / Workcenter")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Part_WC_Outside",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Operation",v.Enum.ColumnPropertyNames!Caption,"Op Code")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Operation",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",v.Enum.ColumnPropertyNames!Caption,"Setup")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Width,"30")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Set_Up",V.Enum.ColumnPropertyNames!Visible,False)

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Run_Time",v.Enum.ColumnPropertyNames!Caption,"Material Requirements")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Run_Time",V.Enum.ColumnPropertyNames!Width,"30")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","UM_Inventory",v.Enum.ColumnPropertyNames!Caption,"Unit")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","UM_Inventory",V.Enum.ColumnPropertyNames!Width,"10")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",v.Enum.ColumnPropertyNames!Caption,"Rate")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!Width,"30")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Rate",V.Enum.ColumnPropertyNames!DisplayCustomNumeric,"c2")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Desc_Rt_Line",v.Enum.ColumnPropertyNames!Caption,"Description")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!ReadOnly,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!AllowEdit,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Desc_Rt_Line",V.Enum.ColumnPropertyNames!Width,"50")

Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Cuts",v.Enum.ColumnPropertyNames!Caption,"Cuts")
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!ReadOnly,False)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!AllowEdit,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!Visible,True)
Gui.FormSkid.GsGridSkidRout.SetColumnProperty("gvRouter","Cuts",V.Enum.ColumnPropertyNames!CellWordWrap,"Wrap")

gui.FormSkid.GsGridSkidRout.MainView("gvRouter")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Set_Prop_Skid_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.Set_Prop_Skid.End

Program.Sub.cmdBolt_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdBolt_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sPart.Declare(String,"")

Gui.FormMat..Caption("Bolt Material/Comments")

F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
	Gui.FormRegCrate..Enabled(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
	Gui.FormShell..Enabled(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
	Gui.FormSkid..Enabled(False)
F.Intrinsic.Control.EndIf
	
F.Intrinsic.Control.If(V.DataTable.Bolt.Exists,=,False)
	F.ODBC.Connection!Conx.OpenCompanyConnection
	F.ODBC.Connection!Conx.ExecuteAndReturn("Select Part from V_Inventory_Mstr Where Code_Sort In('HBLT','HNUT','HWSH','HSCR') Order by Part",V.Local.sPart)
	F.ODBC.Connection!Conx.Close
	F.Intrinsic.String.Replace(V.Local.sPart,"#$#","*!*",V.Local.sPart)
	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("##NO MATERIAL##*!*{0}",V.Local.sPart,V.Local.sPart)
	F.Intrinsic.Control.Else
		V.Local.sPart.Set("##NO MATERIAL##")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Create("Bolt",True)
	F.Data.DataTable.AddColumn("Bolt","ID",Long)
	F.Data.DataTable.AddColumn("Bolt","Material",String)
	F.Data.DataTable.AddColumn("Bolt","Description",String)
	F.Data.DataTable.AddColumn("Bolt","OpCode",String)
	F.Data.DataTable.AddColumn("Bolt","Qty",Float)
	F.Data.DataTable.AddColumn("Bolt","Comment",String)
	F.Data.DataTable.AddColumn("Bolt","Delete_Row",String)
	
	Gui.FormMat.GsGridMat.AddGridviewFromDatatable("Bolt","Bolt")
	gui.FormMat.GsGridMat.SetGridviewProperty("Bolt",v.Enum.GridViewPropertyNames!AllowAddRows,True)
	gui.FormMat.GsGridMat.SetGridviewProperty("Bolt",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
	gui.FormMat.GsGridMat.SetGridviewProperty("Bolt",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
	gui.FormMat.GsGridMat.SetGridviewProperty("Bolt",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","ID",v.Enum.ColumnPropertyNames!Caption,"ID")
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","ID",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","ID",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","ID",V.Enum.ColumnPropertyNames!ReadOnly,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","ID",V.Enum.ColumnPropertyNames!AllowEdit,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","ID",V.Enum.ColumnPropertyNames!Visible,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","ID",V.Enum.ColumnPropertyNames!AllowShowHide,False)

	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Material",v.Enum.ColumnPropertyNames!Caption,"Material")
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Material",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Material",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Material",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Material",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Material",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.ColumnEdit("Bolt","Material","DropDownList",V.Local.sPart)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Description",v.Enum.ColumnPropertyNames!Caption,"Description")
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Description",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Description",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Description",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Description",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Description",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Description",V.Enum.ColumnPropertyNames!MaxLength,"30")
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","OpCode",v.Enum.ColumnPropertyNames!Caption,"Op Code")
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","OpCode",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","OpCode",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","OpCode",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","OpCode",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","OpCode",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","OpCode",V.Enum.ColumnPropertyNames!MaxLength,"6")
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Qty",v.Enum.ColumnPropertyNames!Caption,"Qty")
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Qty",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Qty",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Qty",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Qty",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Qty",V.Enum.ColumnPropertyNames!Visible,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Comment",v.Enum.ColumnPropertyNames!Caption,"Comment")
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Comment",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Comment",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Comment",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Comment",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Comment",V.Enum.ColumnPropertyNames!Visible,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Delete_Row",v.Enum.ColumnPropertyNames!Caption," ")
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Delete_Row",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Delete_Row",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Delete_Row",V.Enum.ColumnPropertyNames!ReadOnly,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Delete_Row",V.Enum.ColumnPropertyNames!AllowEdit,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Bolt","Delete_Row",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.ColumnEdit("Bolt","Delete_Row","EditorButton","Delete")
	
F.Intrinsic.Control.EndIf

Gui.FormMat.GsGridMat.MainView("Bolt")

Gui.FormMat..Show

Gui.FormMat.GsGridMat.SetFocus

Gui.FormMat..WaitForDismiss

F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
	Gui.FormRegCrate..Enabled(True)
	Gui.FormRegCrate..AlwaysOnTop(True)
	Gui.FormRegCrate..AlwaysOnTop(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
	Gui.FormShell..Enabled(True)
	Gui.FormShell..AlwaysOnTop(True)
	Gui.FormShell..AlwaysOnTop(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
	Gui.FormSkid..Enabled(True)
	Gui.FormSkid..AlwaysOnTop(True)
	Gui.FormSkid..AlwaysOnTop(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdBolt_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdBolt_Click.End

Program.Sub.cmdBrace_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdBrace_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sPart.Declare(String,"")

F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
	Gui.FormRegCrate..Enabled(False)
	Gui.FormMat..Caption("Bracing Material/Comments")
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
	Gui.FormShell..Enabled(False)
	Gui.FormMat..Caption("Lag Material/Comments")
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
	Gui.FormSkid..Enabled(False)
	Gui.FormMat..Caption("Bracing Material/Comments")
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.Brace.Exists,=,False)
	F.ODBC.Connection!Conx.OpenCompanyConnection
	F.ODBC.Connection!Conx.ExecuteAndReturn("Select Part from V_Inventory_Mstr Where Code_Sort In('LPLY','LSTK','LOSB') Order by Part",V.Local.sPart)
	F.ODBC.Connection!Conx.Close
	F.Intrinsic.String.Replace(V.Local.sPart,"#$#","*!*",V.Local.sPart)
	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("##NO MATERIAL##*!*{0}",V.Local.sPart,V.Local.sPart)
	F.Intrinsic.Control.Else
		V.Local.sPart.Set("##NO MATERIAL##")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Create("Brace",True)
	F.Data.DataTable.AddColumn("Brace","ID",Long)
	F.Data.DataTable.AddColumn("Brace","Material",String)
	F.Data.DataTable.AddColumn("Brace","Description",String)
	F.Data.DataTable.AddColumn("Brace","OpCode",String)
	F.Data.DataTable.AddColumn("Brace","Qty",Float)
	F.Data.DataTable.AddColumn("Brace","Comment",String)
	F.Data.DataTable.AddColumn("Brace","Delete_Row",String)
	
	Gui.FormMat.GsGridMat.AddGridviewFromDatatable("Brace","Brace")
	gui.FormMat.GsGridMat.SetGridviewProperty("Brace",v.Enum.GridViewPropertyNames!AllowAddRows,True)
	gui.FormMat.GsGridMat.SetGridviewProperty("Brace",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
	gui.FormMat.GsGridMat.SetGridviewProperty("Brace",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
	gui.FormMat.GsGridMat.SetGridviewProperty("Brace",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","ID",v.Enum.ColumnPropertyNames!Caption,"ID")
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","ID",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","ID",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","ID",V.Enum.ColumnPropertyNames!ReadOnly,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","ID",V.Enum.ColumnPropertyNames!AllowEdit,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","ID",V.Enum.ColumnPropertyNames!Visible,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","ID",V.Enum.ColumnPropertyNames!AllowShowHide,False)

	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Material",v.Enum.ColumnPropertyNames!Caption,"Material")
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Material",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Material",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Material",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Material",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Material",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.ColumnEdit("Brace","Material","DropDownList",V.Local.sPart)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Description",v.Enum.ColumnPropertyNames!Caption,"Description")
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Description",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Description",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Description",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Description",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Description",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Description",V.Enum.ColumnPropertyNames!MaxLength,"30")
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","OpCode",v.Enum.ColumnPropertyNames!Caption,"Op Code")
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","OpCode",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","OpCode",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","OpCode",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","OpCode",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","OpCode",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","OpCode",V.Enum.ColumnPropertyNames!MaxLength,"6")
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Qty",v.Enum.ColumnPropertyNames!Caption,"Qty")
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Qty",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Qty",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Qty",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Qty",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Qty",V.Enum.ColumnPropertyNames!Visible,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Comment",v.Enum.ColumnPropertyNames!Caption,"Comment")
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Comment",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Comment",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Comment",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Comment",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Comment",V.Enum.ColumnPropertyNames!Visible,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Delete_Row",v.Enum.ColumnPropertyNames!Caption," ")
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Delete_Row",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Delete_Row",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Delete_Row",V.Enum.ColumnPropertyNames!ReadOnly,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Delete_Row",V.Enum.ColumnPropertyNames!AllowEdit,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("Brace","Delete_Row",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.ColumnEdit("Brace","Delete_Row","EditorButton","Delete")
F.Intrinsic.Control.EndIf

Gui.FormMat.GsGridMat.MainView("Brace")

Gui.FormMat..Show

Gui.FormMat.GsGridMat.SetFocus

Gui.FormMat..WaitForDismiss

F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
	Gui.FormRegCrate..Enabled(True)
	Gui.FormRegCrate..AlwaysOnTop(True)
	Gui.FormRegCrate..AlwaysOnTop(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
	Gui.FormShell..Enabled(True)
	Gui.FormShell..AlwaysOnTop(True)
	Gui.FormShell..AlwaysOnTop(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
	Gui.FormSkid..Enabled(True)
	Gui.FormSkid..AlwaysOnTop(True)
	Gui.FormSkid..AlwaysOnTop(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdBrace_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdBrace_Click.End

Program.Sub.cmdAddMat_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdAddMat_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sPart.Declare(String,"")

Gui.FormMat..Caption("Additional Material/Comments")

F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
	Gui.FormRegCrate..Enabled(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
	Gui.FormShell..Enabled(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
	Gui.FormSkid..Enabled(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.DataTable.AddMat.Exists,=,False)
	F.ODBC.Connection!Conx.OpenCompanyConnection
	F.ODBC.Connection!Conx.ExecuteAndReturn("Select Part from V_Inventory_Mstr Where Code_Sort In('BAND','FOAM','HBLT','HNLS','HNUT','HSCR','HSPC','HSTP','HSWSH','LOSB','LPLY','PKG') Order by Part",V.Local.sPart)
	F.ODBC.Connection!Conx.Close
	F.Intrinsic.String.Replace(V.Local.sPart,"#$#","*!*",V.Local.sPart)
	F.Intrinsic.Control.If(V.Local.sPart.Trim,<>,"")
		F.Intrinsic.String.Build("##NO MATERIAL##*!*{0}",V.Local.sPart,V.Local.sPart)
	F.Intrinsic.Control.Else
		V.Local.sPart.Set("##NO MATERIAL##")
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Create("AddMat",True)
	F.Data.DataTable.AddColumn("AddMat","ID",Long)
	F.Data.DataTable.AddColumn("AddMat","Material",String)
	F.Data.DataTable.AddColumn("AddMat","Description",String)
	F.Data.DataTable.AddColumn("AddMat","OpCode",String)
	F.Data.DataTable.AddColumn("AddMat","Qty",Float)
	F.Data.DataTable.AddColumn("AddMat","Comment",String)
	F.Data.DataTable.AddColumn("AddMat","Delete_Row",String)
	
	Gui.FormMat.GsGridMat.AddGridviewFromDatatable("AddMat","AddMat")
	gui.FormMat.GsGridMat.SetGridviewProperty("AddMat",v.Enum.GridViewPropertyNames!AllowAddRows,True)
	gui.FormMat.GsGridMat.SetGridviewProperty("AddMat",v.Enum.GridViewPropertyNames!AllowDeleteRows,False)
	gui.FormMat.GsGridMat.SetGridviewProperty("AddMat",v.Enum.GridViewPropertyNames!AllowColumnMoving,False)
	gui.FormMat.GsGridMat.SetGridviewProperty("AddMat",v.Enum.GridViewPropertyNames!ColumnAutoWidth,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","ID",v.Enum.ColumnPropertyNames!Caption,"ID")
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","ID",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","ID",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","ID",V.Enum.ColumnPropertyNames!ReadOnly,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","ID",V.Enum.ColumnPropertyNames!AllowEdit,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","ID",V.Enum.ColumnPropertyNames!Visible,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","ID",V.Enum.ColumnPropertyNames!AllowShowHide,False)

	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Material",v.Enum.ColumnPropertyNames!Caption,"Material")
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Material",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Material",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Material",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Material",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Material",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.ColumnEdit("AddMat","Material","DropDownList",V.Local.sPart)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Description",v.Enum.ColumnPropertyNames!Caption,"Description")
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Description",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Description",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Description",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Description",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Description",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Description",V.Enum.ColumnPropertyNames!MaxLength,"30")
	
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","OpCode",v.Enum.ColumnPropertyNames!Caption,"Op Code")
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","OpCode",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","OpCode",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","OpCode",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","OpCode",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","OpCode",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","OpCode",V.Enum.ColumnPropertyNames!MaxLength,"6")
	
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Qty",v.Enum.ColumnPropertyNames!Caption,"Qty")
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Qty",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Qty",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Qty",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Qty",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Qty",V.Enum.ColumnPropertyNames!Visible,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Comment",v.Enum.ColumnPropertyNames!Caption,"Comment")
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Comment",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Comment",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Comment",V.Enum.ColumnPropertyNames!ReadOnly,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Comment",V.Enum.ColumnPropertyNames!AllowEdit,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Comment",V.Enum.ColumnPropertyNames!Visible,True)
	
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Delete_Row",v.Enum.ColumnPropertyNames!Caption," ")
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Delete_Row",V.Enum.ColumnPropertyNames!HeaderForeColor,v.Color.PRI-GSS-00)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Delete_Row",V.Enum.ColumnPropertyNames!HeaderFontBold,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Delete_Row",V.Enum.ColumnPropertyNames!ReadOnly,True)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Delete_Row",V.Enum.ColumnPropertyNames!AllowEdit,False)
	Gui.FormMat.GsGridMat.SetColumnProperty("AddMat","Delete_Row",V.Enum.ColumnPropertyNames!Visible,True)
	Gui.FormMat.GsGridMat.ColumnEdit("AddMat","Delete_Row","EditorButton","Delete")
F.Intrinsic.Control.EndIf

Gui.FormMat.GsGridMat.MainView("AddMat")

Gui.FormMat..Show

Gui.FormMat.GsGridMat.SetFocus

Gui.FormMat..WaitForDismiss

F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
	Gui.FormRegCrate..Enabled(True)
	Gui.FormRegCrate..AlwaysOnTop(True)
	Gui.FormRegCrate..AlwaysOnTop(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
	Gui.FormShell..Enabled(True)
	Gui.FormShell..AlwaysOnTop(True)
	Gui.FormShell..AlwaysOnTop(False)
F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
	Gui.FormSkid..Enabled(True)
	Gui.FormSkid..AlwaysOnTop(True)
	Gui.FormSkid..AlwaysOnTop(False)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdAddMat_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
Function.Intrinsic.Control.EndIf
Program.Sub.cmdAddMat_Click.End

Program.Sub.GsGridMat_RowCellClick.Start
F.Intrinsic.Control.SetErrorHandler("GsGridMat_RowCellClick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sDT.Declare(String,"")

F.Intrinsic.Control.If(V.Args.Column.UCase,=,"DELETE_ROW")
	Gui.FormMat.GsGridMat.GetFocusedGridview(V.Local.sDT)
	F.Data.DataTable.DeleteRow(V.Local.sDT,V.Args.RowIndex)
	F.Data.DataTable.AcceptChanges(V.Local.sDT)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("GsGridMat_RowCellClick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
		F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
	F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
		F.Intrinsic.Control.CallSub(FormShell_UnLoad)
	F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
		F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndIf
Program.Sub.GsGridMat_RowCellClick.End

Program.Sub.cmdExit_Click.Start
F.Intrinsic.Control.SetErrorHandler("cmdExit_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

F.Intrinsic.Control.CallSub(FormMat_UnLoad)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdExit_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
		F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
	F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
		F.Intrinsic.Control.CallSub(FormShell_UnLoad)
	F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
		F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndIf
Program.Sub.cmdExit_Click.End

Program.Sub.FormMat_UnLoad.Start
F.Intrinsic.Control.SetErrorHandler("FormMat_UnLoad_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")
V.Local.sDT.Declare(String,"")
V.Local.i.Declare(Long,0)
V.Local.iD.Declare(Long,0)

Gui.FormMat.GsGridMat.GetFocusedGridview(V.Local.sDT)

F.Data.DataView.Create(V.Local.sDT,"Temp",22,"(Material  = '' Or Material is Null) AND (Comment = '' or Comment is Null)","")

F.Intrinsic.Control.For(V.Local.i,V.DataView.[V.Local.sDT]!Temp.RowCount--,0,-1)
	F.Data.DataTable.DeleteRow(V.Local.sDT,V.DataView.[V.Local.sDT]!Temp(V.Local.i).DataTableIndex)
F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close(V.Local.sDT,"Temp")

F.Data.DataTable.AcceptChanges(V.Local.sDT)

F.Data.DataView.Create(V.Local.sDT,"Temp",22,"ID >= 0","ID")
F.Intrinsic.Control.If(V.DataView.[V.Local.sDT]!Temp.RowCount--,<>,-1)
	V.Local.iD.Set(V.DataView.[V.Local.sDT]!Temp(V.DataView.[V.Local.sDT]!Temp.RowCount--).ID!FieldValLong)
F.Intrinsic.Control.Else
	V.Local.iD.Set(0)
F.Intrinsic.Control.EndIf
F.Data.DataView.Close(V.Local.sDT,"Temp")

F.Data.DataView.Create(V.Local.sDT,"Temp",22,"ID is Null","")

'F.Intrinsic.Control.For(V.Local.i,0,V.DataView.[V.Local.sDT]!Temp.RowCount--,1)
F.Intrinsic.Control.DoUntil(V.DataView.[V.Local.sDT]!Temp.RowCount--,=,-1)
	F.Intrinsic.Control.If(V.DataTable.[V.Local.sDT](V.DataView.[V.Local.sDT]!Temp(0).DataTableIndex).Material!FieldValTrim,<>,"##NO MATERIAL##","AND",V.DataTable.[V.Local.sDT](V.DataView.[V.Local.sDT]!Temp(0).DataTableIndex).Qty!FieldValTrim,=,"")
		F.Data.DataTable.SetValue(V.Local.sDT,V.DataView.[V.Local.sDT]!Temp(0).DataTableIndex,"Qty",0)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Math.Add(V.Local.iD,1,V.Local.iD)
	F.Data.DataTable.SetValue(V.Local.sDT,V.DataView.[V.Local.sDT]!Temp(0).DataTableIndex,"ID",V.Local.iD)
F.Intrinsic.Control.Loop
'F.Intrinsic.Control.Next(V.Local.i)

F.Data.DataView.Close(V.Local.sDT,"Temp")

Gui.FormMat..Visible(False)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("FormMat_UnLoad_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.If(V.Global.sSelection,=,"CRATE")
		F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
	F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SHELL")
		F.Intrinsic.Control.CallSub(FormShell_UnLoad)
	F.Intrinsic.Control.ElseIf(V.Global.sSelection,=,"SKID")
		F.Intrinsic.Control.CallSub(FormSkid_UnLoad)
	F.Intrinsic.Control.EndIf
Function.Intrinsic.Control.EndIf
Program.Sub.FormMat_UnLoad.End

Program.Sub.txtDesc_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtDesc_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtDesc.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtDesc_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
F.Intrinsic.Control.EndIf
Program.Sub.txtDesc_GotFocus.End

Program.Sub.txtExtraDesc_GotFocus.Start
F.Intrinsic.Control.SetErrorHandler("txtExtraDesc_GotFocus_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String,"")

Gui.FormRegCrate.txtExtraDesc.SelectAll

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("txtExtraDesc_GotFocus_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	F.Intrinsic.String.Build("Project: GCG_6761_Crate_Calc.g2u {0}{0}Subroutine: {1}{0}Error Occurred {2} with description {3}",V.Ambient.NewLine,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(FormRegCrate_UnLoad)
F.Intrinsic.Control.EndIf
Program.Sub.txtExtraDesc_GotFocus.End

Program.Sub.Comments.Start
${$5$}$20.1.8413.19752$}$1
${$6$}$rking$}$20230405131603180$}$QNdZLVy4bWuiWa9jh1ZTiKHvMPldSPXeIXpK9ptObMt3qV1fUCEz5IkOaho2hmi8JgVkCwNsvBI=
Program.Sub.Comments.End